import{C as X,L as Y}from"./ListGroup-3147dc64.js";import{d as B,o as n,e as y,g as t,c as _,w as o,h as f,q as I,b as a,F as V,f as M,m as k,u as L,j as x,i as D,k as r,C as Z,t as h,a as S,r as G,p as ee,n as te,_ as le,s as ae,v as oe,y as de,x as ne,z as ue}from"./index-b1074072.js";const se={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},re=t("p",null,"衔接业务单审核",-1),ie={class:"d-flex flex-row-1"},_e={class:"flex-1"},pe={colspan:"2"},me={colspan:"2"},fe={colspan:"2"},ce={colspan:"2"},be={class:"m-0 p-0 w-100 d-flex flex-row justify-content-end"},ye=B({__name:"ApproveAEBP",props:{data:Object,refuse:{type:Function,default:(c,e)=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=L(),v=async()=>{if(e.data.refuse_reason.trim()==""){x.error("【衔接业务单审核】请输入驳回原因");return}e.data.refuse_reason=e.data.refuse_reason.trim();let i=new FormData;i.set("status","3"),i.set("refuse_reason",e.data.refuse_reason),D.put(`/aebp/approve/${e.data.code}`,i).then(l=>{l.data.status===200?e.refuse("衔接业务单审核",e.data.refuse_reason):x.error(l.data.message)}).catch(l=>{x.error(l)})},q=()=>{let i=new FormData;i.set("status","2"),D.put(`/aebp/approve/${e.data.code}`,i).then(l=>{l.data.status===200&&(e.data.status=2,x.success("【衔接业务单审核】审核通过"))})};return(i,l)=>{const g=r("el-text"),m=r("el-input"),u=r("el-form-item"),w=r("el-date-picker"),j=r("el-option"),F=r("el-select"),z=r("el-option-group"),d=r("el-radio"),J=r("el-radio-group"),s=r("el-button"),A=r("el-form");return n(),y(V,null,[t("h3",se,[re,t("span",null,[e.data.status==0?(n(),_(g,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):e.data.status==1?(n(),_(g,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):e.data.status==2?(n(),_(g,{key:2,type:"success"},{default:o(()=>[f("审核已通过")]),_:1})):e.data.status==3?(n(),_(g,{key:3,type:"danger"},{default:o(()=>[f("审核已驳回")]),_:1})):I("",!0)])]),a(A,{"label-position":"top"},{default:o(()=>[t("div",ie,[t("table",_e,[t("tr",null,[t("td",null,[a(u,{label:"经济业务计划单编号"},{default:o(()=>[a(m,{modelValue:e.data.code,"onUpdate:modelValue":l[0]||(l[0]=p=>e.data.code=p),readonly:""},null,8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"开展月份"},{default:o(()=>[a(w,{modelValue:e.data.start_date,"onUpdate:modelValue":l[1]||(l[1]=p=>e.data.start_date=p),readonly:"",type:"month"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"衔接计划编码"},{default:o(()=>[a(F,{modelValue:e.data.annual_work_plan_id,"onUpdate:modelValue":l[2]||(l[2]=p=>e.data.annual_work_plan_id=p),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.awp_list,p=>(n(),_(j,{label:p.code+" - "+p.name,value:p.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"经济类型"},{default:o(()=>[a(F,{modelValue:e.data.eco_class_id,"onUpdate:modelValue":l[3]||(l[3]=p=>e.data.eco_class_id=p),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.eco_class_list,p=>(n(),_(z,{label:p.classify+" - "+p.name},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.eco_kind_list[p.classify],P=>(n(),_(j,{label:P.classify+P.kind+" - "+P.name,value:P.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",pe,[a(u,{label:"业务经济内容"},{default:o(()=>[a(m,{modelValue:e.data.detail,"onUpdate:modelValue":l[4]||(l[4]=p=>e.data.detail=p),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",me,[a(u,{label:"产生支出内容"},{default:o(()=>[a(m,{modelValue:e.data.content,"onUpdate:modelValue":l[5]||(l[5]=p=>e.data.content=p),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",fe,[a(u,{label:"上年度是否开展"},{default:o(()=>[a(J,{modelValue:e.data.carry_out,"onUpdate:modelValue":l[6]||(l[6]=p=>e.data.carry_out=p),disabled:""},{default:o(()=>[a(d,{label:!0},{default:o(()=>[f("已开展")]),_:1}),a(d,{label:!1},{default:o(()=>[f("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",ce,[a(u,{label:"备注"},{default:o(()=>[a(m,{modelValue:e.data.comm,"onUpdate:modelValue":l[7]||(l[7]=p=>e.data.comm=p),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t("div",null,[t("table",null,[t("tr",null,[t("td",null,[a(u,{label:"部门"},{default:o(()=>[a(F,{modelValue:e.data.dept_id,"onUpdate:modelValue":l[8]||(l[8]=p=>e.data.dept_id=p),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.dept_list,p=>(n(),_(j,{label:p.name,value:p.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"申请人"},{default:o(()=>[a(F,{modelValue:e.data.requester,"onUpdate:modelValue":l[9]||(l[9]=p=>e.data.requester=p),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.user_list,p=>(n(),_(j,{label:p.id+" - "+p.name,value:p.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核小组"},{default:o(()=>[a(F,{modelValue:e.data.applicant_id,"onUpdate:modelValue":l[10]||(l[10]=p=>e.data.applicant_id=p),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.expert_group,p=>(n(),_(j,{label:p.tag,value:p.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核驳回原因"},{default:o(()=>[a(m,{modelValue:e.data.refuse_reason,"onUpdate:modelValue":l[11]||(l[11]=p=>e.data.refuse_reason=p),rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})])])])])]),a(u,null,{default:o(()=>[t("div",be,[a(s,{size:"small",title:"当前阶段驳回将终止审核",type:"danger",onClick:v},{default:o(()=>[f("驳回")]),_:1}),a(s,{size:"small",title:"通过审核将清空驳回原因",type:"primary",onClick:q},{default:o(()=>[f("通过")]),_:1})])]),_:1})]),_:1})],64)}}}),ge={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Ve=t("p",null,"预算审核",-1),ve={class:"d-flex flex-row-1"},xe={class:"flex-1"},we={colspan:"2"},$e={colspan:"2"},Ue={colspan:"2"},ke={class:"m-0 p-0 w-100 d-flex flex-row justify-content-end"},je=B({__name:"ApproveBudget",props:{data:Object,refuse:{type:Function,default:()=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=L(),v=()=>{if(e.data.refuse_reason.trim()==""){x.error("【预算审核】请输入驳回原因");return}e.data.refuse_reason=e.data.refuse_reason.trim();let i=new FormData;i.set("status","3"),i.set("refuse_reason",e.data.refuse_reason),D.put(`/budget/approve/${e.data.id}`,i).then(l=>{l.data.status===200?e.refuse():x.error(l.data.message)}).catch(l=>{x.error(l)})},q=()=>{let i=new FormData;i.set("status",JSON.stringify(2)),D.put(`/budget/approve/${e.data.id}`,i).then(l=>{l.data.status===200&&e.pass()})};return(i,l)=>{const g=r("el-text"),m=r("el-input-number"),u=r("el-form-item"),w=r("el-option"),j=r("el-option-group"),F=r("el-select"),z=r("el-input"),d=r("el-button"),J=r("el-form");return n(),y(V,null,[t("h3",ge,[Ve,t("span",null,[e.data.status==0?(n(),_(g,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):e.data.status==1?(n(),_(g,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):e.data.status==2?(n(),_(g,{key:2,type:"success"},{default:o(()=>[f("审核已通过")]),_:1})):e.data.status==3?(n(),_(g,{key:3,type:"danger"},{default:o(()=>[f("审核已驳回")]),_:1})):I("",!0)])]),a(J,{modelValue:e.data,"onUpdate:modelValue":l[10]||(l[10]=s=>e.data=s),"label-position":"top"},{default:o(()=>[t("div",ve,[t("table",xe,[t("tr",null,[t("td",null,[a(u,{label:"预算金额(元)"},{default:o(()=>[a(m,{modelValue:c.data.budget_price,"onUpdate:modelValue":l[0]||(l[0]=s=>c.data.budget_price=s),precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue","step"])]),_:1})]),t("td",null,[a(u,{label:"上年度本业务实际支出(元)"},{default:o(()=>[a(m,{modelValue:c.data.actual_cost,"onUpdate:modelValue":l[1]||(l[1]=s=>c.data.actual_cost=s),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue","step"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"经济分类"},{default:o(()=>[a(F,{modelValue:c.data.economy_id,"onUpdate:modelValue":l[2]||(l[2]=s=>c.data.economy_id=s),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.eco_class_list,s=>(n(),_(j,{label:s.classify+" - "+s.name},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.eco_kind_list[s.classify],A=>(n(),_(w,{label:A.classify+A.kind+" - "+A.name,value:A.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"衔接业务单编码"},{default:o(()=>[a(F,{modelValue:c.data.aebp_id,"onUpdate:modelValue":l[3]||(l[3]=s=>c.data.aebp_id=s),disabled:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.aebp_list,s=>(n(),_(w,{label:s.code,value:s.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",we,[a(u,{label:"详细测算过程"},{default:o(()=>[a(z,{modelValue:c.data.detail,"onUpdate:modelValue":l[4]||(l[4]=s=>c.data.detail=s),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",$e,[a(u,{label:"差异说明"},{default:o(()=>[a(z,{modelValue:c.data.diff_reason,"onUpdate:modelValue":l[5]||(l[5]=s=>c.data.diff_reason=s),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",Ue,[a(u,{label:"备注"},{default:o(()=>[a(z,{modelValue:c.data.comm,"onUpdate:modelValue":l[6]||(l[6]=s=>c.data.comm=s),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t("div",null,[t("table",null,[t("tr",null,[t("td",null,[a(u,{label:"申请人"},{default:o(()=>[a(F,{modelValue:c.data.requester,"onUpdate:modelValue":l[7]||(l[7]=s=>c.data.requester=s),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.user_list,s=>(n(),_(w,{label:s.id+" - "+s.name,value:s.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核小组"},{default:o(()=>[a(F,{modelValue:e.data.applicant_id,"onUpdate:modelValue":l[8]||(l[8]=s=>e.data.applicant_id=s),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.expert_group,s=>(n(),_(w,{label:s.tag,value:s.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])])]),a(u,{class:"flex-grow-1",label:"审核驳回原因"},{default:o(()=>[a(z,{modelValue:c.data.refuse_reason,"onUpdate:modelValue":l[9]||(l[9]=s=>c.data.refuse_reason=s),rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})])]),a(u,null,{default:o(()=>[t("div",ke,[a(d,{size:"small",title:"当前阶段驳回将终止审核",type:"danger",onClick:v},{default:o(()=>[f("驳回")]),_:1}),a(d,{size:"small",title:"通过审核将清空驳回原因",type:"primary",onClick:q},{default:o(()=>[f("通过")]),_:1})])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Fe={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Ce=t("p",null,"衔接年度工作计划审核",-1),Me={class:"d-flex w-100 flex-row"},qe={class:"flex-1"},ze={colspan:"2"},De={colspan:"2"},Oe={colspan:"2"},he={class:"m-0 p-0 w-100 d-flex flex-row justify-content-end"},Se=B({__name:"ApproveAWP",props:{data:Object,refuse:{type:Function,default:()=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=L(),v=()=>{if(e.data.refuse_reason.trim()==""){x.error("【衔接年度工作计划审核】请输入驳回原因");return}e.data.refuse_reason=e.data.refuse_reason.trim();let i=new FormData;i.set("refuse_reason",e.data.refuse_reason),i.set("status","3"),D.put(`/awp/approve/${e.data.code}`,i).then(l=>{l.data.status===200?e.refuse():x.error(l.data.message)}).catch(l=>{x.error(l)})},q=()=>{let i=new FormData;i.set("status","2"),D.put(`/awp/approve/${e.data.code}`,i).then(l=>{l.data.status===200&&(e.data.status=2,x.success("【衔接年度工作计划审核】审核通过"))})};return(i,l)=>{const g=r("el-text"),m=r("el-input"),u=r("el-form-item"),w=r("el-radio"),j=r("el-radio-group"),F=r("el-option"),z=r("el-select"),d=r("el-button"),J=r("el-form");return n(),y(V,null,[t("h3",Fe,[Ce,t("span",null,[e.data.status==0?(n(),_(g,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):e.data.status==1?(n(),_(g,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):e.data.status==2?(n(),_(g,{key:2,type:"success"},{default:o(()=>[f("审核已通过")]),_:1})):e.data.status==3?(n(),_(g,{key:3,type:"danger"},{default:o(()=>[f("审核已驳回")]),_:1})):I("",!0)])]),a(J,{"label-position":"top"},{default:o(()=>[t("div",Me,[t("table",qe,[t("tr",null,[t("td",null,[a(u,{label:"计划编码"},{default:o(()=>[a(m,{modelValue:e.data.code,"onUpdate:modelValue":l[0]||(l[0]=s=>e.data.code=s),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"计划名称"},{default:o(()=>[a(m,{modelValue:e.data.name,"onUpdate:modelValue":l[1]||(l[1]=s=>e.data.name=s),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",ze,[a(u,{label:"计划详情"},{default:o(()=>[a(m,{modelValue:e.data.detail,"onUpdate:modelValue":l[2]||(l[2]=s=>e.data.detail=s),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"隶属工作职责编码"},{default:o(()=>[a(m,{modelValue:e.data.job_resp_id,"onUpdate:modelValue":l[3]||(l[3]=s=>e.data.job_resp_id=s),readonly:""},null,8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"绩效编码"},{default:o(()=>[a(m,{modelValue:e.data.per_goal_id,"onUpdate:modelValue":l[4]||(l[4]=s=>e.data.per_goal_id=s),readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",De,[a(u,{label:"上年度是否开展"},{default:o(()=>[a(j,{modelValue:e.data.carry_out,"onUpdate:modelValue":l[5]||(l[5]=s=>e.data.carry_out=s),disabled:""},{default:o(()=>[a(w,{label:!0},{default:o(()=>[f("已开展")]),_:1}),a(w,{label:!1},{default:o(()=>[f("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",Oe,[a(u,{label:"备注"},{default:o(()=>[a(m,{modelValue:e.data.comm,"onUpdate:modelValue":l[6]||(l[6]=s=>e.data.comm=s),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t("div",null,[t("table",null,[t("tr",null,[t("td",null,[a(u,{label:"部门"},{default:o(()=>[a(m,{modelValue:e.data.dept_name,"onUpdate:modelValue":l[7]||(l[7]=s=>e.data.dept_name=s),readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"申请人"},{default:o(()=>[a(m,{modelValue:e.data.requester_name,"onUpdate:modelValue":l[8]||(l[8]=s=>e.data.requester_name=s),readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核小组"},{default:o(()=>[a(z,{modelValue:e.data.applicant_id,"onUpdate:modelValue":l[9]||(l[9]=s=>e.data.applicant_id=s),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.expert_group,s=>(n(),_(F,{label:s.tag,value:s.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核驳回原因",prop:"refuse_reason"},{default:o(()=>[a(m,{modelValue:e.data.refuse_reason,"onUpdate:modelValue":l[10]||(l[10]=s=>e.data.refuse_reason=s),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])])])]),a(u,null,{default:o(()=>[t("div",he,[a(d,{size:"small",title:"当前阶段驳回将终止审核",type:"danger",onClick:v},{default:o(()=>[f("驳回")]),_:1}),a(d,{size:"small",title:"通过审核将清空驳回原因",type:"primary",onClick:q},{default:o(()=>[f("通过")]),_:1})])]),_:1})]),_:1})],64)}}}),Ne={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Ae=t("p",null,"工作职责审核",-1),Be={style:{display:"flex","flex-direction":"column"}},Je={style:{display:"flex","flex-direction":"row"}},Ie={style:{width:"100%"}},Le={colspan:"2"},Pe={colspan:"2"},Ee={colspan:"2"},Ge={class:"m-0 p-0 w-100 d-flex flex-row justify-content-end"},Re=B({__name:"ApproveJobResp",props:{data:Object,refuse:{type:Function,default:(c,e)=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=L(),v=async()=>{if(e.data.refuse_reason.trim()==""){x.error("【工作职责审核】请输入驳回原因");return}e.data.refuse_reason=e.data.refuse_reason.trim();let i=new FormData;i.set("status","3"),i.set("refuse_reason",e.data.refuse_reason),D.put(`/job/approve/${e.data.id}`,i).then(l=>{l.data.status===200?e.refuse("工作职责审核",e.data.refuse_reason):x.error(l.data.message)}).catch(l=>{x.error(l)})},q=()=>{let i=new FormData;i.set("status","2"),D.put(`/job/approve/${e.data.id}`,i).then(l=>{l.data.status===200&&(e.data.status=2,x.success("【工作职责审核】审核通过"))})};return(i,l)=>{const g=r("el-text"),m=r("el-input"),u=r("el-form-item"),w=r("el-option"),j=r("el-select"),F=r("el-button"),z=r("el-form");return n(),y(V,null,[t("h3",Ne,[Ae,t("span",null,[e.data.status==0?(n(),_(g,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):e.data.status==1?(n(),_(g,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):e.data.status==2?(n(),_(g,{key:2,type:"success"},{default:o(()=>[f("审核已通过")]),_:1})):e.data.status==3?(n(),_(g,{key:3,type:"danger"},{default:o(()=>[f("审核已驳回")]),_:1})):I("",!0)])]),a(z,{"label-position":"top"},{default:o(()=>[t("div",Be,[t("div",Je,[t("div",null,[t("table",Ie,[t("tr",null,[t("td",null,[a(u,{label:"职责编号"},{default:o(()=>[a(m,{modelValue:e.data.code,"onUpdate:modelValue":l[0]||(l[0]=d=>e.data.code=d),readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",Le,[a(u,{label:"职责概述"},{default:o(()=>[a(m,{modelValue:e.data.abstract,"onUpdate:modelValue":l[1]||(l[1]=d=>e.data.abstract=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",Pe,[a(u,{label:"职责内容描述"},{default:o(()=>[a(m,{modelValue:e.data.detail,"onUpdate:modelValue":l[2]||(l[2]=d=>e.data.detail=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"经办人"},{default:o(()=>[a(j,{modelValue:e.data.operator_id,"onUpdate:modelValue":l[3]||(l[3]=d=>e.data.operator_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.user_list,d=>(n(),_(w,{label:d.id+" - "+d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),t("td",null,[a(u,{label:"责任领导",prop:"leader_id"},{default:o(()=>[a(j,{modelValue:e.data.leader_id,"onUpdate:modelValue":l[4]||(l[4]=d=>e.data.leader_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.user_list,d=>(n(),_(w,{label:d.id+" - "+d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",Ee,[a(u,{label:"备注"},{default:o(()=>[a(m,{modelValue:e.data.comm,"onUpdate:modelValue":l[5]||(l[5]=d=>e.data.comm=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),t("div",null,[t("table",null,[t("tr",null,[t("td",null,[a(u,{label:"部门"},{default:o(()=>[a(j,{modelValue:e.data.dept_id,"onUpdate:modelValue":l[6]||(l[6]=d=>e.data.dept_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.dept_list,d=>(n(),_(w,{label:d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"填报人"},{default:o(()=>[a(m,{modelValue:e.data.requester,"onUpdate:modelValue":l[7]||(l[7]=d=>e.data.requester=d),readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核小组"},{default:o(()=>[a(j,{modelValue:e.data.applicant_id,"onUpdate:modelValue":l[8]||(l[8]=d=>e.data.applicant_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.expert_group,d=>(n(),_(w,{label:d.id+" - "+d.tag,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核驳回原因"},{default:o(()=>[a(m,{modelValue:e.data.refuse_reason,"onUpdate:modelValue":l[9]||(l[9]=d=>e.data.refuse_reason=d),type:"textarea"},null,8,["modelValue"])]),_:1})])])])])])]),a(u,null,{default:o(()=>[t("div",Ge,[a(F,{size:"small",title:"当前阶段驳回将终止审核",type:"danger",onClick:v},{default:o(()=>[f("驳回")]),_:1}),a(F,{size:"small",title:"通过审核将清空驳回原因",type:"primary",onClick:q},{default:o(()=>[f("通过")]),_:1})])]),_:1})]),_:1})],64)}}}),Te={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},We=t("p",null,"绩效指标审核",-1),He={class:"d-flex flex-row"},Ke={class:"flex-1"},Qe={style:{margin:"0",padding:"0 1rem"}},Xe=["href"],Ye={class:"m-0 p-0 w-100 d-flex flex-row justify-content-end"},Ze=B({__name:"ApprovePerGoal",props:{data:Object,refuse:{type:Function,default:()=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=L(),v=()=>{if(e.data.refuse_reason.trim()==""){x.error("【绩效指标审核】请输入驳回原因");return}e.data.refuse_reason=e.data.refuse_reason.trim();let i=new FormData;i.set("refuse_reason",e.data.refuse_reason),i.set("status","3"),D.put(`/goal/approve/${e.data.id}`,i).then(l=>{l.data.status===200?e.refuse():x.error(l.data.message)}).catch(l=>{x.error(l)})},q=()=>{let i=new FormData;i.set("status","2"),D.put(`/goal/approve/${e.data.id}`,i).then(l=>{l.data.status===200&&(e.data.status=2,x.success("【绩效目标】审核通过"))})};return(i,l)=>{const g=r("el-text"),m=r("el-input"),u=r("el-form-item"),w=r("el-option"),j=r("el-select"),F=r("el-button"),z=r("el-form");return n(),y(V,null,[t("h3",Te,[We,t("span",null,[e.data.status==0?(n(),_(g,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):e.data.status==1?(n(),_(g,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):e.data.status==2?(n(),_(g,{key:2,type:"success"},{default:o(()=>[f("审核已通过")]),_:1})):e.data.status==3?(n(),_(g,{key:3,type:"danger"},{default:o(()=>[f("审核已驳回")]),_:1})):I("",!0)])]),a(z,{"label-position":"top"},{default:o(()=>[t("div",He,[t("table",Ke,[t("tr",null,[t("td",null,[a(u,{label:"绩效指标编码"},{default:o(()=>[a(m,{modelValue:e.data.code,"onUpdate:modelValue":l[0]||(l[0]=d=>e.data.code=d),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"一级指标"},{default:o(()=>[a(m,{modelValue:e.data.quota_1,"onUpdate:modelValue":l[1]||(l[1]=d=>e.data.quota_1=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"二级指标"},{default:o(()=>[a(m,{modelValue:e.data.quota_2,"onUpdate:modelValue":l[2]||(l[2]=d=>e.data.quota_2=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"三级指标"},{default:o(()=>[a(m,{modelValue:e.data.quota_3,"onUpdate:modelValue":l[3]||(l[3]=d=>e.data.quota_3=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"指标值"},{default:o(()=>[a(m,{modelValue:e.data.quota_value,"onUpdate:modelValue":l[4]||(l[4]=d=>e.data.quota_value=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"指标来源"},{default:o(()=>[a(m,{modelValue:e.data.source,"onUpdate:modelValue":l[5]||(l[5]=d=>e.data.source=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"备注"},{default:o(()=>[a(m,{modelValue:e.data.comm,"onUpdate:modelValue":l[6]||(l[6]=d=>e.data.comm=d),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"附件"},{default:o(()=>[t("ol",Qe,[(n(!0),y(V,null,M(e.data.file_list,d=>(n(),y("li",null,[t("a",{href:k(Z).base_url+"/"+d.file_path,class:"file_href",style:{color:"#000"},target:"_blank"},h(d.file_name),9,Xe)]))),256))])]),_:1})])])]),t("div",null,[t("table",null,[t("tr",null,[t("td",null,[a(u,{label:"部门"},{default:o(()=>[a(j,{modelValue:e.data.dept_id,"onUpdate:modelValue":l[7]||(l[7]=d=>e.data.dept_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.dept_list,d=>(n(),_(w,{label:d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"填报人"},{default:o(()=>[a(j,{modelValue:e.data.requester,"onUpdate:modelValue":l[8]||(l[8]=d=>e.data.requester=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.user_list,d=>(n(),_(w,{label:d.id+" - "+d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核小组"},{default:o(()=>[a(j,{modelValue:e.data.applicant_id,"onUpdate:modelValue":l[9]||(l[9]=d=>e.data.applicant_id=d),disabled:"",filterable:""},{default:o(()=>[(n(!0),y(V,null,M(k(b).getters.expert_group,d=>(n(),_(w,{label:d.tag,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[t("td",null,[a(u,{label:"审核驳回原因"},{default:o(()=>[a(m,{modelValue:e.data.refuse_reason,"onUpdate:modelValue":l[10]||(l[10]=d=>e.data.refuse_reason=d),type:"textarea"},null,8,["modelValue"])]),_:1})])])])])]),a(u,null,{default:o(()=>[t("div",Ye,[a(F,{size:"small",title:"当前阶段驳回将终止审核",type:"danger",onClick:v},{default:o(()=>[f("驳回")]),_:1}),a(F,{size:"small",title:"通过审核将清空驳回原因",type:"primary",onClick:q},{default:o(()=>[f("通过")]),_:1})])]),_:1})]),_:1})],64)}}}),et=B({__name:"ApproveForm",props:{budget:Object,aebp:Object,awp:Object,per_goal:Object,job_resp:Object,refuse:{type:Function,default:()=>{}},pass:{type:Function,default:()=>{}}},setup(c){const e=c,b=async(v,q)=>{let i=new FormData;i.set("status","3"),i.set("refuse_reason",`【${v}】${q}`),D.put(`/budget/approve/${e.budget.id}`,i).then(l=>{l.data.status===200?e.refuse():x.error(l.data.message)}).catch(l=>{x.error(l)})};return(v,q)=>(n(),y(V,null,[a(Re,{data:e.job_resp,refuse:b},null,8,["data"]),a(Ze,{data:c.per_goal,refuse:b},null,8,["data"]),a(Se,{data:e.awp,refuse:b},null,8,["data"]),a(ye,{data:e.aebp,pass:e.pass,refuse:b},null,8,["data","pass"]),a(je,{data:e.budget,pass:e.pass,refuse:e.refuse},null,8,["data","pass","refuse"])],64))}}),N=c=>(ee("data-v-88826a56"),c=c(),te(),c),tt=N(()=>t("div",{style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},[t("p",null,"公用经费预算")],-1)),lt={class:"detail"},at=N(()=>t("th",null,"差异说明",-1)),ot=N(()=>t("th",null,"备注",-1)),dt=N(()=>t("th",null,"详细测算过程",-1)),nt=N(()=>t("th",null,"申请人",-1)),ut=N(()=>t("th",null,"审核小组",-1)),st=N(()=>t("th",null,"申请时间",-1)),rt=N(()=>t("th",null,"审核时间",-1)),it={key:0},_t=N(()=>t("th",null,"驳回原因",-1)),pt=B({__name:"index",setup(c){const e=L(),b=S([]),v=G({curr_page:1,total:10,page_size:14}),q=S({}),i=S({}),l=S({}),g=S({}),m=S({}),u=S(!1),w=S([]),j=O=>{z(O)};b.value.length===0&&z(1);async function F(){let $=(await D.get("/expert_group/-1",{params:{select_by:JSON.stringify(["expert_id"]),select:JSON.stringify({expert_id:[e.getters.userinfo.id]})}})).data.data,C=[];for(let E of $)C.push(E.group_id);return C}async function z(O){w.value.length===0&&(w.value=await F());const $=`/budget/-1?reverse=1&current_page=${O}&page_size=${v.page_size}`;D.get($,{params:{select_by:JSON.stringify(["status","applicant_id"]),select:JSON.stringify({status:[1,3],applicant_id:w.value})}}).then(C=>{C.data.status===200?(b.value=C.data.data,v.page_size=C.data.page_info.page_size,v.total=C.data.page_info.total):x({type:"error",message:C.data.message})}).catch(C=>{x({type:"error",message:C})})}async function d(O){let $=await D.get(`/job/${O}`);$.data.status===200&&(g.value=$.data.data[0])}async function J(O){let $=await D.get(`/goal/${O}`);$.data.status===200&&(m.value=$.data.data[0])}async function s(O){let $=await D.get(`/awp/${O}`);$.data.status===200&&(l.value=$.data.data[0],await J(l.value.per_goal_id),await d(l.value.job_resp_id))}async function A(O){let $=await D.get(`/aebp/${O}`);$.data.status===200&&(i.value=$.data.data[0],await s(i.value.annual_work_plan_id))}const p=async O=>{e.commit("loading",!0),q.value=O;const $=q.value.aebp_id;await A($),e.commit("loading",!1),u.value=!0},P=()=>{u.value=!1,z(v.curr_page)},R=()=>{u.value=!1,z(v.curr_page)};return(O,$)=>{const C=r("el-table-column"),E=r("el-text"),T=r("el-button"),W=r("el-button-group"),H=r("el-table"),K=r("el-pagination"),Q=r("el-drawer");return n(),y(V,null,[a(X,null,{header:o(()=>[tt]),content:o(()=>[a(H,{data:b.value,height:"100%"},{default:o(()=>[a(C,{fixed:"",type:"expand"},{default:o(U=>[t("table",lt,[t("tr",null,[at,t("td",null,h(U.row.diff_reason),1)]),t("tr",null,[ot,t("td",null,h(U.row.comm),1)]),t("tr",null,[dt,t("td",null,h(U.row.detail),1)]),t("tr",null,[nt,t("td",null,h(U.row.requester_name),1)]),t("tr",null,[ut,t("td",null,h(U.row.applicant_tag),1)]),t("tr",null,[st,t("td",null,h(U.row.request_time),1)]),t("tr",null,[rt,t("td",null,h(U.row.approve_time),1)]),U.row.status==3?(n(),y("tr",it,[_t,t("td",null,h(U.row.refuse_reason),1)])):I("",!0)])]),_:1}),a(C,{label:"编号",prop:"id"}),a(C,{label:"经济类型",prop:"eco_name"}),a(C,{label:"预算金额(元)",prop:"budget_price"}),a(C,{label:"衔接业务单编码",prop:"aebp_id"}),a(C,{label:"上年度本业务实际支出(元)",prop:"actual_cost"}),a(C,{label:"填报人",prop:"requester_name"}),a(C,{align:"center",label:"审核状态"},{default:o(U=>[U.row.status==0?(n(),_(E,{key:0,type:"primary"},{default:o(()=>[f("待申请审核")]),_:1})):U.row.status==1?(n(),_(E,{key:1,type:"warning"},{default:o(()=>[f("待审核")]),_:1})):U.row.status==2?(n(),_(E,{key:2,type:"success"},{default:o(()=>[f("审核通过")]),_:1})):U.row.status==3?(n(),_(E,{key:3,type:"danger"},{default:o(()=>[f("审核驳回")]),_:1})):I("",!0)]),_:1}),a(C,{align:"center",label:"操作"},{default:o(U=>[a(W,{size:"small"},{default:o(()=>[a(T,{disabled:U.row.status==3,type:"primary",onClick:yt=>p(U.row)},{default:o(()=>[f("审核 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:o(()=>[a(K,{"current-page":v.curr_page,"onUpdate:currentPage":$[0]||($[0]=U=>v.curr_page=U),"page-size":v.page_size,total:v.total,layout:"total, prev, pager, next",onCurrentChange:j},null,8,["current-page","page-size","total"])]),_:1}),a(Q,{modelValue:u.value,"onUpdate:modelValue":$[1]||($[1]=U=>u.value=U),"destroy-on-close":"",direction:"rtl",size:"60%",title:"公用预算经费审核"},{default:o(()=>[a(et,{aebp:i.value,awp:l.value,budget:q.value,job_resp:g.value,pass:R,per_goal:m.value,refuse:P},null,8,["aebp","awp","budget","job_resp","per_goal"])]),_:1},8,["modelValue"])],64)}}});const mt=le(pt,[["__scopeId","data-v-88826a56"]]),ft={class:"d-flex flex-row w-100 h-100 m-0 p-0"},ct={class:"d-flex flex-col justify-content-between p-right-10"},bt={class:"flex-grow-1"},vt=B({__name:"index",setup(c){const e=L(),b=G([{label:"公用经费预算",comp:ae(mt)}]),v=S(b[0].comp),q=l=>{v.value=b[l].comp};oe(()=>{i()});function i(){e.dispatch("expert_group"),e.dispatch("dept_list"),e.dispatch("user_list"),e.dispatch("eco_list"),e.dispatch("job_list"),e.dispatch("goal_list"),e.dispatch("aebp_list"),e.dispatch("awp_list")}return(l,g)=>{const m=ue("loading");return de((n(),y("div",ft,[t("div",ct,[a(Y,{content:u=>u.label,curr_change:q,data:b,"min-width":"9rem",width:"9rem"},null,8,["content","data"])]),t("div",bt,[(n(),_(ne(v.value)))])])),[[m,k(e).getters.loading]])}}});export{vt as default};
