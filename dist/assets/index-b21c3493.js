import{C as te,L as ie}from"./ListGroup-88f610dc.js";import{M as ye}from"./index-16e56944.js";import{d as T,u as A,b as p,o as s,f as z,h as e,c as w,w as l,i as x,s as E,e as t,F as J,g as D,n as P,C as _e,t as F,a as O,r as L,j as B,k as C,m as le,p as ae,q as oe,_ as re,v as ee,x as me,l as pe,y as Ve,z as ve}from"./index-88c55bfa.js";import{n as ue,F as fe}from"./formatter-a19a4390.js";const qe={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},we=e("p",null,"预算审核",-1),$e={class:"d-flex flex-row-1"},xe={class:"flex-1"},ke={colspan:"2"},Ue={colspan:"2"},he={colspan:"2"},Ce=T({__name:"DetailBudget",props:{data:Object},setup(i){const a=i,b=A();return(d,o)=>{const V=p("el-text"),$=p("el-input-number"),f=p("el-form-item"),r=p("el-option"),m=p("el-option-group"),n=p("el-select"),k=p("el-input"),v=p("el-form");return s(),z(J,null,[e("h3",qe,[we,e("span",null,[a.data.status==0?(s(),w(V,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):a.data.status==1?(s(),w(V,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):a.data.status==2?(s(),w(V,{key:2,type:"success"},{default:l(()=>[x("审核已通过")]),_:1})):a.data.status==3?(s(),w(V,{key:3,type:"danger"},{default:l(()=>[x("审核已驳回")]),_:1})):E("",!0)])]),t(v,{modelValue:a.data,"onUpdate:modelValue":o[10]||(o[10]=y=>a.data=y),"label-position":"top"},{default:l(()=>[e("div",$e,[e("table",xe,[e("tr",null,[e("td",null,[t(f,{label:"预算金额(元)"},{default:l(()=>[t($,{modelValue:i.data.budget_price,"onUpdate:modelValue":o[0]||(o[0]=y=>i.data.budget_price=y),precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"上年度本业务实际支出(元)"},{default:l(()=>[t($,{modelValue:i.data.actual_cost,"onUpdate:modelValue":o[1]||(o[1]=y=>i.data.actual_cost=y),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"经济分类"},{default:l(()=>[t(n,{modelValue:i.data.economy_id,"onUpdate:modelValue":o[2]||(o[2]=y=>i.data.economy_id=y),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,y=>(s(),w(m,{label:y.classify+" - "+y.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[y.classify],h=>(s(),w(r,{label:h.classify+h.kind+" - "+h.name,value:h.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"衔接业务单编码"},{default:l(()=>[t(n,{modelValue:i.data.aebp_id,"onUpdate:modelValue":o[3]||(o[3]=y=>i.data.aebp_id=y),disabled:""},{default:l(()=>[t(r,{label:a.data.aebp_code,value:a.data.aebp_code},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ke,[t(f,{label:"详细测算过程"},{default:l(()=>[t(k,{modelValue:i.data.detail,"onUpdate:modelValue":o[4]||(o[4]=y=>i.data.detail=y),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ue,[t(f,{label:"差异说明"},{default:l(()=>[t(k,{modelValue:i.data.diff_reason,"onUpdate:modelValue":o[5]||(o[5]=y=>i.data.diff_reason=y),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",he,[t(f,{label:"备注"},{default:l(()=>[t(k,{modelValue:i.data.comm,"onUpdate:modelValue":o[6]||(o[6]=y=>i.data.comm=y),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(f,{label:"申请人"},{default:l(()=>[t(n,{modelValue:i.data.requester,"onUpdate:modelValue":o[7]||(o[7]=y=>i.data.requester=y),disabled:"",filterable:""},{default:l(()=>[t(r,{label:a.data.requester+" - "+a.data.requester_name,value:a.data.requester},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"审核小组"},{default:l(()=>[t(n,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[8]||(o[8]=y=>a.data.applicant_id=y),disabled:"",filterable:""},{default:l(()=>[t(r,{label:a.data.applicant_id+" - "+a.data.applicant_tag,value:a.data.applicant_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])])]),a.data.status==3?(s(),w(f,{key:0,class:"flex-grow-1",label:"审核驳回原因"},{default:l(()=>[t(k,{modelValue:i.data.refuse_reason,"onUpdate:modelValue":o[9]||(o[9]=y=>i.data.refuse_reason=y),readonly:"",rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})):E("",!0)])])]),_:1},8,["modelValue"])],64)}}}),je={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},ze=e("p",null,"衔接业务单审核",-1),Me={class:"d-flex flex-row-1"},Fe={class:"flex-1"},Oe={colspan:"2"},Se={colspan:"2"},Je={colspan:"2"},Ne={colspan:"2"},De={key:0},Be=T({__name:"DetailAEBP",props:{data:Object},setup(i){const a=i,b=A();return(d,o)=>{const V=p("el-text"),$=p("el-input"),f=p("el-form-item"),r=p("el-date-picker"),m=p("el-option"),n=p("el-select"),k=p("el-option-group"),v=p("el-radio"),y=p("el-radio-group"),h=p("el-form");return s(),z(J,null,[e("h3",je,[ze,e("span",null,[a.data.status==0?(s(),w(V,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):a.data.status==1?(s(),w(V,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):a.data.status==2?(s(),w(V,{key:2,type:"success"},{default:l(()=>[x("审核已通过")]),_:1})):a.data.status==3?(s(),w(V,{key:3,type:"danger"},{default:l(()=>[x("审核已驳回")]),_:1})):E("",!0)])]),t(h,{"label-position":"top"},{default:l(()=>[e("div",Me,[e("table",Fe,[e("tr",null,[e("td",null,[t(f,{label:"经济业务计划单编号"},{default:l(()=>[t($,{modelValue:a.data.code,"onUpdate:modelValue":o[0]||(o[0]=c=>a.data.code=c),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"开展月份"},{default:l(()=>[t(r,{modelValue:a.data.start_date,"onUpdate:modelValue":o[1]||(o[1]=c=>a.data.start_date=c),readonly:"",type:"month"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"衔接计划编码"},{default:l(()=>[t(n,{modelValue:a.data.annual_work_plan_id,"onUpdate:modelValue":o[2]||(o[2]=c=>a.data.annual_work_plan_id=c),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.awp_list,c=>(s(),w(m,{label:c.code+" - "+c.name,value:c.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"经济类型"},{default:l(()=>[t(n,{modelValue:a.data.eco_class_id,"onUpdate:modelValue":o[3]||(o[3]=c=>a.data.eco_class_id=c),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,c=>(s(),w(k,{label:c.classify+" - "+c.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[c.classify],g=>(s(),w(m,{label:g.classify+g.kind+" - "+g.name,value:g.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Oe,[t(f,{label:"业务经济内容"},{default:l(()=>[t($,{modelValue:a.data.detail,"onUpdate:modelValue":o[4]||(o[4]=c=>a.data.detail=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Se,[t(f,{label:"产生支出内容"},{default:l(()=>[t($,{modelValue:a.data.content,"onUpdate:modelValue":o[5]||(o[5]=c=>a.data.content=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Je,[t(f,{label:"上年度是否开展"},{default:l(()=>[t(y,{modelValue:a.data.carry_out,"onUpdate:modelValue":o[6]||(o[6]=c=>a.data.carry_out=c),disabled:""},{default:l(()=>[t(v,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(v,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ne,[t(f,{label:"备注"},{default:l(()=>[t($,{modelValue:a.data.comm,"onUpdate:modelValue":o[7]||(o[7]=c=>a.data.comm=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(f,{label:"部门"},{default:l(()=>[t(n,{modelValue:a.data.dept_id,"onUpdate:modelValue":o[8]||(o[8]=c=>a.data.dept_id=c),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.dept_name,value:a.data.dept_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"申请人"},{default:l(()=>[t(n,{modelValue:a.data.requester,"onUpdate:modelValue":o[9]||(o[9]=c=>a.data.requester=c),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.requester+" - "+a.data.requester_name,value:a.data.requester},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"审核小组"},{default:l(()=>[t(n,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[10]||(o[10]=c=>a.data.applicant_id=c),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.applicant_id+" - "+a.data.applicant_tag,value:a.data.applicant_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(s(),z("tr",De,[e("td",null,[t(f,{label:"审核驳回原因"},{default:l(()=>[t($,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":o[11]||(o[11]=c=>a.data.refuse_reason=c),readonly:"",rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})])])):E("",!0)])])])]),_:1})],64)}}}),Pe={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Ee=e("p",null,"衔接年度工作计划审核",-1),Ie={class:"d-flex w-100 flex-row"},Te={class:"flex-1"},Le={colspan:"2"},Ae={colspan:"2"},Ge={colspan:"2"},Re={key:0},We=T({__name:"DetailAWP",props:{data:Object},setup(i){const a=i;return A(),(b,d)=>{const o=p("el-text"),V=p("el-input"),$=p("el-form-item"),f=p("el-radio"),r=p("el-radio-group"),m=p("el-option"),n=p("el-select"),k=p("el-form");return s(),z(J,null,[e("h3",Pe,[Ee,e("span",null,[a.data.status==0?(s(),w(o,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):a.data.status==1?(s(),w(o,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):a.data.status==2?(s(),w(o,{key:2,type:"success"},{default:l(()=>[x("审核已通过")]),_:1})):a.data.status==3?(s(),w(o,{key:3,type:"danger"},{default:l(()=>[x("审核已驳回")]),_:1})):E("",!0)])]),t(k,{"label-position":"top"},{default:l(()=>[e("div",Ie,[e("table",Te,[e("tr",null,[e("td",null,[t($,{label:"计划编码"},{default:l(()=>[t(V,{modelValue:a.data.code,"onUpdate:modelValue":d[0]||(d[0]=v=>a.data.code=v),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t($,{label:"计划名称"},{default:l(()=>[t(V,{modelValue:a.data.name,"onUpdate:modelValue":d[1]||(d[1]=v=>a.data.name=v),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Le,[t($,{label:"计划详情"},{default:l(()=>[t(V,{modelValue:a.data.detail,"onUpdate:modelValue":d[2]||(d[2]=v=>a.data.detail=v),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"隶属工作职责编码"},{default:l(()=>[t(V,{modelValue:a.data.job_resp_code,"onUpdate:modelValue":d[3]||(d[3]=v=>a.data.job_resp_code=v),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t($,{label:"绩效编码"},{default:l(()=>[t(V,{modelValue:a.data.per_goal_code,"onUpdate:modelValue":d[4]||(d[4]=v=>a.data.per_goal_code=v),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ae,[t($,{label:"上年度是否开展"},{default:l(()=>[t(r,{modelValue:a.data.carry_out,"onUpdate:modelValue":d[5]||(d[5]=v=>a.data.carry_out=v),disabled:""},{default:l(()=>[t(f,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(f,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ge,[t($,{label:"备注"},{default:l(()=>[t(V,{modelValue:a.data.comm,"onUpdate:modelValue":d[6]||(d[6]=v=>a.data.comm=v),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t($,{label:"部门"},{default:l(()=>[t(n,{modelValue:a.data.dept_id,"onUpdate:modelValue":d[7]||(d[7]=v=>a.data.dept_id=v),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.dept_name,value:a.data.dept_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"申请人"},{default:l(()=>[t(n,{modelValue:a.data.requester,"onUpdate:modelValue":d[8]||(d[8]=v=>a.data.requester=v),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.requester+" - "+a.data.requester_name,value:a.data.requester},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"审核小组"},{default:l(()=>[t(n,{modelValue:a.data.applicant_id,"onUpdate:modelValue":d[9]||(d[9]=v=>a.data.applicant_id=v),disabled:"",filterable:""},{default:l(()=>[t(m,{label:a.data.applicant_id+" - "+a.data.applicant_tag,value:a.data.applicant_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(s(),z("tr",Re,[e("td",null,[t($,{label:"审核驳回原因",prop:"refuse_reason"},{default:l(()=>[t(V,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":d[10]||(d[10]=v=>a.data.refuse_reason=v),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):E("",!0)])])])]),_:1})],64)}}}),He={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Ke=e("p",null,"绩效指标审核",-1),Qe={class:"d-flex flex-row"},Xe={class:"flex-1"},Ye={style:{margin:"0",padding:"0 1rem"}},Ze=["href"],et={key:0},tt=T({__name:"DetailPerGoal",props:{data:Object},setup(i){const a=i;return A(),(b,d)=>{const o=p("el-text"),V=p("el-input"),$=p("el-form-item"),f=p("el-option"),r=p("el-select"),m=p("el-form");return s(),z(J,null,[e("h3",He,[Ke,e("span",null,[a.data.status==0?(s(),w(o,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):a.data.status==1?(s(),w(o,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):a.data.status==2?(s(),w(o,{key:2,type:"success"},{default:l(()=>[x("审核已通过")]),_:1})):a.data.status==3?(s(),w(o,{key:3,type:"danger"},{default:l(()=>[x("审核已驳回")]),_:1})):E("",!0)])]),t(m,{"label-position":"top"},{default:l(()=>[e("div",Qe,[e("table",Xe,[e("tr",null,[e("td",null,[t($,{label:"绩效指标编码"},{default:l(()=>[t(V,{modelValue:a.data.code,"onUpdate:modelValue":d[0]||(d[0]=n=>a.data.code=n),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"一级指标"},{default:l(()=>[t(V,{modelValue:a.data.quota_1,"onUpdate:modelValue":d[1]||(d[1]=n=>a.data.quota_1=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"二级指标"},{default:l(()=>[t(V,{modelValue:a.data.quota_2,"onUpdate:modelValue":d[2]||(d[2]=n=>a.data.quota_2=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"三级指标"},{default:l(()=>[t(V,{modelValue:a.data.quota_3,"onUpdate:modelValue":d[3]||(d[3]=n=>a.data.quota_3=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"指标值"},{default:l(()=>[t(V,{modelValue:a.data.quota_value,"onUpdate:modelValue":d[4]||(d[4]=n=>a.data.quota_value=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"指标来源"},{default:l(()=>[t(V,{modelValue:a.data.source,"onUpdate:modelValue":d[5]||(d[5]=n=>a.data.source=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"备注"},{default:l(()=>[t(V,{modelValue:a.data.comm,"onUpdate:modelValue":d[6]||(d[6]=n=>a.data.comm=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"附件"},{default:l(()=>[e("ol",Ye,[(s(!0),z(J,null,D(a.data.file_list,n=>(s(),z("li",null,[e("a",{href:P(_e).base_url+"/"+n.path,class:"file_href",style:{color:"#000"},target:"_blank"},F(n.name),9,Ze)]))),256))])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t($,{label:"部门"},{default:l(()=>[t(r,{modelValue:a.data.dept_id,"onUpdate:modelValue":d[7]||(d[7]=n=>a.data.dept_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.dept_name,value:a.data.dept_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"填报人"},{default:l(()=>[t(r,{modelValue:a.data.requester,"onUpdate:modelValue":d[8]||(d[8]=n=>a.data.requester=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.requester+" - "+a.data.requester_name,value:a.data.requester},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"审核小组"},{default:l(()=>[t(r,{modelValue:a.data.applicant_id,"onUpdate:modelValue":d[9]||(d[9]=n=>a.data.applicant_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.applicant_id+" - "+a.data.applicant_tag,value:a.data.applicant_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(s(),z("tr",et,[e("td",null,[t($,{label:"审核驳回原因"},{default:l(()=>[t(V,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":d[10]||(d[10]=n=>a.data.refuse_reason=n),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):E("",!0)])])])]),_:1})],64)}}}),lt={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},at=e("p",null,"工作职责审核",-1),ot={style:{display:"flex","flex-direction":"column"}},rt={style:{display:"flex","flex-direction":"row"}},dt={class:"flex-1"},ut={style:{width:"100%"}},nt={colspan:"2"},st={colspan:"2"},it={colspan:"2"},_t={key:0},mt=T({__name:"DetailJobResp",props:{data:Object},setup(i){const a=i;return A(),(b,d)=>{const o=p("el-text"),V=p("el-input"),$=p("el-form-item"),f=p("el-option"),r=p("el-select"),m=p("el-form");return s(),z(J,null,[e("h3",lt,[at,e("span",null,[a.data.status==0?(s(),w(o,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):a.data.status==1?(s(),w(o,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):a.data.status==2?(s(),w(o,{key:2,type:"success"},{default:l(()=>[x("审核已通过")]),_:1})):a.data.status==3?(s(),w(o,{key:3,type:"danger"},{default:l(()=>[x("审核已驳回")]),_:1})):E("",!0)])]),t(m,{"label-position":"top"},{default:l(()=>[e("div",ot,[e("div",rt,[e("div",dt,[e("table",ut,[e("tr",null,[e("td",null,[t($,{label:"职责编号"},{default:l(()=>[t(V,{modelValue:a.data.code,"onUpdate:modelValue":d[0]||(d[0]=n=>a.data.code=n),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",nt,[t($,{label:"职责概述"},{default:l(()=>[t(V,{modelValue:a.data.abstract,"onUpdate:modelValue":d[1]||(d[1]=n=>a.data.abstract=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",st,[t($,{label:"职责内容描述"},{default:l(()=>[t(V,{modelValue:a.data.detail,"onUpdate:modelValue":d[2]||(d[2]=n=>a.data.detail=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"经办人"},{default:l(()=>[t(r,{modelValue:a.data.operator_id,"onUpdate:modelValue":d[3]||(d[3]=n=>a.data.operator_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.operator_id+" - "+a.data.operator_name,value:a.data.operator_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t($,{label:"责任领导",prop:"leader_id"},{default:l(()=>[t(r,{modelValue:a.data.leader_id,"onUpdate:modelValue":d[4]||(d[4]=n=>a.data.leader_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.leader_id+" - "+a.data.leader_name,value:a.data.leader_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",it,[t($,{label:"备注"},{default:l(()=>[t(V,{modelValue:a.data.comm,"onUpdate:modelValue":d[5]||(d[5]=n=>a.data.comm=n),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t($,{label:"部门"},{default:l(()=>[t(r,{modelValue:a.data.dept_id,"onUpdate:modelValue":d[6]||(d[6]=n=>a.data.dept_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.dept_name,value:a.data.dept_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"填报人"},{default:l(()=>[t(r,{modelValue:a.data.requester,"onUpdate:modelValue":d[7]||(d[7]=n=>a.data.requester=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.requester+" - "+a.data.requester_name,value:a.data.requester},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t($,{label:"审核小组"},{default:l(()=>[t(r,{modelValue:a.data.applicant_id,"onUpdate:modelValue":d[8]||(d[8]=n=>a.data.applicant_id=n),disabled:"",filterable:""},{default:l(()=>[t(f,{label:a.data.applicant_id+" - "+a.data.applicant_tag,value:a.data.applicant_id},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(s(),z("tr",_t,[e("td",null,[t($,{label:"审核驳回原因"},{default:l(()=>[t(V,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":d[9]||(d[9]=n=>a.data.refuse_reason=n),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):E("",!0)])])])])]),_:1})],64)}}}),pt=T({__name:"detail",props:{budget:Object,aebp:Object,awp:Object,job_resp:Object,per_goal:Object},setup(i){const a=i;return(b,d)=>(s(),z("div",null,[t(mt,{data:a.job_resp},null,8,["data"]),t(tt,{data:a.per_goal},null,8,["data"]),t(We,{data:a.awp},null,8,["data"]),t(Be,{data:a.aebp},null,8,["data"]),t(Ce,{data:a.budget},null,8,["data"])]))}}),ft={class:"w-100"},ct={colspan:"2"},gt={colspan:"2"},bt={colspan:"2"},yt={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Vt=T({__name:"JobResponseCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O(),o=L({dept_id:b.getters.userinfo.dept_id,requester:b.getters.userinfo.id,abstract:"",detail:"",operator_id:"",leader_id:"",comm:"",status:0,refuse_reason:""}),V=L({department_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],abstract:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],operator_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],leader_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],status:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}]});o.status;const $=f=>{f&&f.validate(r=>{if(r){b.commit("loading",!0);let m=new FormData;m.set("dept_id",o.dept_id),m.set("detail",o.detail),m.set("operator_id",o.operator_id),m.set("leader_id",o.leader_id),m.set("comm",o.comm),m.set("abstract",o.abstract),m.set("requester",o.requester),m.set("status",JSON.stringify(o.status)),B.post("/job",m).then(n=>{b.commit("loading",!1),n.data.status===200?a.success():C({type:"error",message:n.data.message})}).catch(n=>{b.commit("loading",!1),C({type:"error",message:n})})}})};return(f,r)=>{const m=p("el-option"),n=p("el-select"),k=p("el-form-item"),v=p("el-input"),y=p("el-button"),h=p("el-form");return s(),w(h,{ref_key:"form_ref",ref:d,model:o,rules:V,"label-position":"top","status-icon":""},{default:l(()=>[e("table",ft,[e("tr",null,[e("td",null,[t(k,{label:"申请人",prop:"requester",required:""},{default:l(()=>[t(n,{modelValue:o.requester,"onUpdate:modelValue":r[0]||(r[0]=c=>o.requester=c),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.user_list,c=>(s(),w(m,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(k,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(n,{modelValue:o.dept_id,"onUpdate:modelValue":r[1]||(r[1]=c=>o.dept_id=c),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.dept_list,c=>(s(),w(m,{label:c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ct,[t(k,{label:"职责概述",prop:"abstract",required:""},{default:l(()=>[t(v,{modelValue:o.abstract,"onUpdate:modelValue":r[2]||(r[2]=c=>o.abstract=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",gt,[t(k,{label:"职责内容描述",prop:"detail",required:""},{default:l(()=>[t(v,{modelValue:o.detail,"onUpdate:modelValue":r[3]||(r[3]=c=>o.detail=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(k,{label:"经办人",prop:"operator_id",required:""},{default:l(()=>[t(n,{modelValue:o.operator_id,"onUpdate:modelValue":r[4]||(r[4]=c=>o.operator_id=c),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.user_list,c=>(s(),w(m,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(k,{label:"责任领导",prop:"leader_id",required:""},{default:l(()=>[t(n,{modelValue:o.leader_id,"onUpdate:modelValue":r[5]||(r[5]=c=>o.leader_id=c),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.user_list,c=>(s(),w(m,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",bt,[t(k,{label:"备注"},{default:l(()=>[t(v,{modelValue:o.comm,"onUpdate:modelValue":r[6]||(r[6]=c=>o.comm=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(k,null,{default:l(()=>[e("div",yt,[t(y,{type:"primary",onClick:r[7]||(r[7]=c=>$(d.value))},{default:l(()=>[x("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),vt={class:"d-flex flex-col"},qt={class:"d-flex flex-row"},wt={class:"w-100"},$t={colspan:"2"},xt={key:0},kt={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Ut=T({__name:"JobResponseEditForm",props:{form:{type:Object,required:!0,default:{id:"",code:"",department_id:"",abstract:"",detail:"",operator_id:"",leader_id:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=a.form.status;let o=!1,V=!1;const $=n=>{d==0&&n==1?o=!0:d==1&&n!=0&&n!=1&&(V=!0)},f=O(),r=L({department_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],abstract:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],operator_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],leader_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],comm:[{required:!0,message:"该选项不得为空",trigger:"blur"}],status:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}],refuse_reason:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),m=n=>{n&&n.validate(k=>{if(k){b.commit("loading",!0);let v=new FormData;v.set("detail",a.form.detail),v.set("department_id",a.form.department_id),v.set("operator_id",a.form.operator_id),v.set("leader_id",a.form.leader_id),v.set("comm",a.form.comm),v.set("abstract",a.form.abstract),v.set("status",JSON.stringify(a.form.status)),v.set("requester",a.form.requester),v.set("applicant_id",a.form.applicant_id),v.set("refuse_reason",a.form.refuse_reason),o&&v.set("request_time",ue()),V&&v.set("approve_time",ue()),B.put(`/job/${a.form.id}`,v).then(y=>{b.commit("loading",!1),y.data.status===200?a.success():C({type:"error",message:y.data.message})}).catch(y=>{b.commit("loading",!1),C({type:"error",message:y})})}})};return(n,k)=>{const v=p("el-input"),y=p("el-form-item"),h=p("el-option"),c=p("el-select"),g=p("el-button"),u=p("el-form");return s(),w(u,{ref_key:"form_ref",ref:f,model:i.form,rules:r,"label-position":"top","label-width":"160px","status-icon":""},{default:l(()=>[e("div",vt,[e("div",qt,[e("div",null,[e("table",wt,[e("tr",null,[e("td",null,[t(y,{label:"职责编号",prop:"code"},{default:l(()=>[t(v,{modelValue:i.form.code,"onUpdate:modelValue":k[0]||(k[0]=_=>i.form.code=_),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(c,{modelValue:i.form.dept_id,"onUpdate:modelValue":k[1]||(k[1]=_=>i.form.dept_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.dept_list,_=>(s(),w(h,{label:_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{label:"职责概述",prop:"abstract",required:""},{default:l(()=>[t(v,{modelValue:i.form.abstract,"onUpdate:modelValue":k[2]||(k[2]=_=>i.form.abstract=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"职责内容描述",prop:"detail",required:""},{default:l(()=>[t(v,{modelValue:i.form.detail,"onUpdate:modelValue":k[3]||(k[3]=_=>i.form.detail=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{label:"经办人",prop:"operator_id",required:""},{default:l(()=>[t(c,{modelValue:i.form.operator_id,"onUpdate:modelValue":k[4]||(k[4]=_=>i.form.operator_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.user_list,_=>(s(),w(h,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"责任领导",prop:"leader_id",required:""},{default:l(()=>[t(c,{modelValue:i.form.leader_id,"onUpdate:modelValue":k[5]||(k[5]=_=>i.form.leader_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.user_list,_=>(s(),w(h,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",$t,[t(y,{label:"备注"},{default:l(()=>[t(v,{modelValue:i.form.comm,"onUpdate:modelValue":k[6]||(k[6]=_=>i.form.comm=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(y,{label:"填报人"},{default:l(()=>[t(v,{modelValue:i.form.requester,"onUpdate:modelValue":k[7]||(k[7]=_=>i.form.requester=_),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{disabled:"disabled",label:"审批小组",prop:"applicant_id",required:""},{default:l(()=>[t(c,{modelValue:i.form.applicant_id,"onUpdate:modelValue":k[8]||(k[8]=_=>i.form.applicant_id=_),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.expert_group,_=>(s(),w(h,{label:_.id+" - "+_.tag,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[t(y,{label:"审批状态",prop:"status",required:""},{default:l(()=>[t(c,{modelValue:i.form.status,"onUpdate:modelValue":k[9]||(k[9]=_=>i.form.status=_),disabled:"",filterable:"",onChange:$},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.approve_status_list,(_,j)=>(s(),w(h,{label:_,value:j},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),i.form.status==3?(s(),z("tr",xt,[e("td",null,[t(y,{required:i.form.status==3,label:"审批驳回原因",prop:"refuse_reason"},{default:l(()=>[t(v,{modelValue:i.form.refuse_reason,"onUpdate:modelValue":k[10]||(k[10]=_=>i.form.refuse_reason=_),type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])])):E("",!0)])])])]),t(y,null,{default:l(()=>[e("div",kt,[t(g,{type:"primary",onClick:k[11]||(k[11]=_=>m(f.value))},{default:l(()=>[x("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Z=i=>(ae("data-v-0bdfaee7"),i=i(),oe(),i),ht={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},Ct=Z(()=>e("p",null,"工作职责",-1)),jt={class:"detail"},zt=Z(()=>e("th",{style:{"vertical-align":"top"}},"职责内容",-1)),Mt=Z(()=>e("th",null,"备注",-1)),Ft=Z(()=>e("th",null,"申请人",-1)),Ot=Z(()=>e("th",null,"审批小组",-1)),St=Z(()=>e("th",null,"申请时间",-1)),Jt=Z(()=>e("th",null,"审批时间",-1)),Nt={key:0},Dt=Z(()=>e("th",null,"驳回原因",-1)),Bt={style:{position:"relative"}},Pt=T({__name:"index",setup(i){const a=A(),b=O([]),d=L({curr_page:1,total:10,page_size:14}),o=O(0),V=O(!1),$=O(!1),f=O([]);f.value.length==0&&B.get("/dept/-1").then(g=>{f.value=g.data.data});const r=g=>{m(g)};b.value.length===0&&m(1);function m(g){a.commit("loading",!0);const u=`/job/-1?reverse=1&current_page=${g}&page_size=${d.page_size}`;B.get(u,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(_=>{a.commit("loading",!1),_.data.status===200?(b.value=_.data.data,d.page_size=_.data.page_info.page_size,d.total=_.data.page_info.total):C({type:"error",message:_.data.message})}).catch(_=>{a.commit("loading",!1),C({type:"error",message:_})})}const n=()=>{$.value=!1,m(d.curr_page)},k=g=>{o.value=g,V.value=!0},v=g=>{le.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(u=>{y(g)}).catch(u=>{C({type:"info",message:"操作已取消"})})};function y(g){const u="/job/"+b.value[g].id;B.delete(u).then(_=>{_.data.status===200?(C({type:"success",message:"删除成功"}),m(d.curr_page)):C({type:"error",message:`删除失败 ${_.data.message}`})}).catch(_=>{C({type:"error",message:_})})}const h=()=>{V.value=!1,m(d.curr_page)};function c(g){a.commit("loading",!0);let u=new FormData;u.set("status","1"),B.put(`/job/approve/${g}`,u).then(_=>{a.commit("loading",!1),_.data.status==200?(C.success("申请审核成功，请等待审核结果"),m(d.curr_page)):C.error(_.data.message)}).catch(_=>{a.commit("loading",!1),C.error(_)})}return(g,u)=>{const _=p("el-button"),j=p("el-button-group"),S=p("el-table-column"),M=p("el-text"),W=p("el-table"),R=p("el-pagination"),q=p("el-dialog");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",ht,[Ct,t(j,{size:"small"},{default:l(()=>[t(_,{type:"primary",onClick:u[0]||(u[0]=U=>$.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(W,{data:b.value,fit:"",height:"100%"},{default:l(()=>[t(S,{fixed:"",type:"expand"},{default:l(U=>[e("table",jt,[e("tr",null,[zt,e("td",null,F(U.row.detail),1)]),e("tr",null,[Mt,e("td",null,F(U.row.comm),1)]),e("tr",null,[Ft,e("td",null,F(U.row.requester_name),1)]),e("tr",null,[Ot,e("td",null,F(U.row.applicant_tag),1)]),e("tr",null,[St,e("td",null,F(U.row.request_time),1)]),e("tr",null,[Jt,e("td",null,F(U.row.approve_time),1)]),U.row.status==3?(s(),z("tr",Nt,[Dt,e("td",null,F(U.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(S,{label:"职责编号",prop:"code"}),t(S,{label:"部门",prop:"dept_name"}),t(S,{label:"职责概述",prop:"abstract",width:"300"}),t(S,{label:"申请者",width:"130rem"},{default:l(U=>[x(F(U.row.requester)+" - "+F(U.row.requester_name),1)]),_:1}),t(S,{label:"经办人",prop:"operator_name"}),t(S,{label:"责任领导",prop:"leader_name"}),t(S,{align:"center",label:"审批状态"},{default:l(U=>[U.row.status==0?(s(),w(M,{key:0,type:"primary"},{default:l(()=>[x("待申请审批")]),_:1})):U.row.status==1?(s(),w(M,{key:1,type:"warning"},{default:l(()=>[x("待审批")]),_:1})):U.row.status==2?(s(),w(M,{key:2,type:"success"},{default:l(()=>[x("审批通过")]),_:1})):U.row.status==3?(s(),w(M,{key:3,type:"danger"},{default:l(()=>[x("审批驳回")]),_:1})):E("",!0)]),_:1}),t(S,{align:"center",label:"操作",width:"200px"},{default:l(U=>[t(j,{size:"small"},{default:l(()=>[U.row.status==0?(s(),w(_,{key:0,type:"warning",onClick:N=>c(U.row.id)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0),t(_,{disabled:U.row.status!=0&&U.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:N=>k(U.$index)},{default:l(()=>[x("编辑 ")]),_:2},1032,["disabled","onClick"]),t(_,{disabled:U.row.status!=0,type:"danger",onClick:N=>v(U.$index)},{default:l(()=>[x(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(R,{"current-page":d.curr_page,"onUpdate:currentPage":u[1]||(u[1]=U=>d.curr_page=U),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:r},null,8,["current-page","page-size","total"])]),_:1}),e("div",Bt,[t(q,{modelValue:$.value,"onUpdate:modelValue":u[2]||(u[2]=U=>$.value=U),"destroy-on-close":"",title:"新增",width:"50%"},{default:l(()=>[t(Vt,{success:n})]),_:1},8,["modelValue"]),t(q,{modelValue:V.value,"onUpdate:modelValue":u[3]||(u[3]=U=>V.value=U),closed:m(d.curr_page),"destroy-on-close":"",title:"编辑"},{default:l(()=>[t(Ut,{form:b.value[o.value],success:h},null,8,["form"])]),_:1},8,["modelValue","closed"])])],64)}}});const Et=re(Pt,[["__scopeId","data-v-0bdfaee7"]]),It={style:{width:"100%"}},Tt={style:{width:"50%"}},Lt={style:{width:"50%"}},At={style:{width:"50%"}},Gt={style:{width:"50%"}},Rt={style:{width:"50%"}},Wt={style:{width:"50%"}},Ht={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Kt=T({__name:"PerGoalCreateForm",props:{dept_list:Object,user_list:Array,success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O([]);d.value.length===0&&B.get("/user/-1").then(m=>{d.value=m.data.data});const o=O(),V=L({dept_id:b.getters.userinfo.dept_id,quota_1:"",quota_2:"",quota_3:"",quota_value:"",source:"",comm:"",file_list:[],status:0,requester:b.getters.userinfo.id}),$=(m,n)=>{m.name in V.file_list?C({type:"error",message:"文件名已存在"}):V.file_list.push(m.raw)},f=L({dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_1:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_2:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_3:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_value:[{required:!0,message:"该选项不得为空",trigger:"blur"}],source:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),r=m=>{m&&m.validate(n=>{if(n){b.commit("loading",!0);let k=new FormData;{k.set("dept_id",V.dept_id),k.set("quota_1",V.quota_1),k.set("quota_2",V.quota_2),k.set("quota_3",V.quota_3),k.set("quota_value",V.quota_value),k.set("source",V.source),k.set("comm",V.comm),k.set("requester",V.requester),k.set("status",JSON.stringify(V.status));for(let v of V.file_list)k.append("file_list",v)}B.post("/goal",k).then(v=>{b.commit("loading",!1),v.data.status===200?a.success():C({type:"error",message:v.data.message})}).catch(v=>{b.commit("loading",!1),C({type:"error",message:v})})}})};return(m,n)=>{const k=p("el-option"),v=p("el-select"),y=p("el-form-item"),h=p("el-input"),c=p("el-button"),g=p("el-upload"),u=p("el-form");return s(),w(u,{ref_key:"form_ref",ref:o,model:V,rules:f,"label-position":"top","label-width":"80px","status-icon":""},{default:l(()=>[e("table",It,[e("tr",null,[e("td",Tt,[t(y,{label:"填报人",prop:"requester",required:""},{default:l(()=>[t(v,{modelValue:V.requester,"onUpdate:modelValue":n[0]||(n[0]=_=>V.requester=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(d.value,_=>(s(),w(k,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",Lt,[t(y,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(v,{modelValue:V.dept_id,"onUpdate:modelValue":n[1]||(n[1]=_=>V.dept_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.dept_list,_=>(s(),w(k,{label:_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",At,[t(y,{label:"一级指标",prop:"quota_1",required:""},{default:l(()=>[t(h,{modelValue:V.quota_1,"onUpdate:modelValue":n[2]||(n[2]=_=>V.quota_1=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",Gt,[t(y,{label:"二级指标",prop:"quota_2",required:""},{default:l(()=>[t(h,{modelValue:V.quota_2,"onUpdate:modelValue":n[3]||(n[3]=_=>V.quota_2=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Rt,[t(y,{label:"三级指标",prop:"quota_3",required:""},{default:l(()=>[t(h,{modelValue:V.quota_3,"onUpdate:modelValue":n[4]||(n[4]=_=>V.quota_3=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",Wt,[t(y,{label:"指标值",prop:"quota_value",required:""},{default:l(()=>[t(h,{modelValue:V.quota_value,"onUpdate:modelValue":n[5]||(n[5]=_=>V.quota_value=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(y,{label:"指标来源",prop:"source",required:""},{default:l(()=>[t(h,{modelValue:V.source,"onUpdate:modelValue":n[6]||(n[6]=_=>V.source=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(y,{label:"备注"},{default:l(()=>[t(h,{modelValue:V.comm,"onUpdate:modelValue":n[7]||(n[7]=_=>V.comm=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(y,{label:"附件"},{default:l(()=>[t(g,{"file-list":V.file_list,"onUpdate:fileList":n[8]||(n[8]=_=>V.file_list=_),multiple:"",onChange:$},{default:l(()=>[t(c,{type:"primary"},{default:l(()=>[x("上传附件")]),_:1})]),_:1},8,["file-list"])]),_:1}),t(y,null,{default:l(()=>[e("div",Ht,[t(c,{type:"primary",onClick:n[9]||(n[9]=_=>r(o.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Qt={style:{display:"flex","flex-direction":"column"}},Xt={style:{display:"flex","flex-direction":"row"}},Yt={style:{width:"100%"}},Zt={style:{width:"50%"}},el={style:{width:"50%"}},tl={style:{width:"50%"}},ll={style:{width:"50%"}},al={style:{width:"50%"}},ol={style:{width:"50%"}},rl={key:0},dl={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},ul=T({__name:"PerGoalEditForm",props:{form:{type:Object,required:!0,default:{dept_id:"",quota_1:"",quota_2:"",quota_3:"",quota_value:"",source:"",comm:"",file_list:[],status:null,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O([]);d.value.length===0&&B.get("/user/-1").then(v=>{d.value=v.data.data});const o=O(),V=L({dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_1:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_2:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_3:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_value:[{required:!0,message:"该选项不得为空",trigger:"blur"}],source:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),$=(v,y)=>{v.name in a.form.file_list?C({type:"error",message:"文件名已存在"}):a.form.file_list.push(v.raw)},f=a.form.status;let r=!1,m=null;const n=v=>{f===0&&v===1?r=!0:f===1&&v!==0&&v!==1&&(m=!0)},k=v=>{v.validate(y=>{if(y){b.commit("loading",!0);let h=new FormData;{h.set("dept_id",a.form.dept_id),h.set("quota_1",a.form.quota_1),h.set("quota_2",a.form.quota_2),h.set("quota_3",a.form.quota_3),h.set("quota_value",a.form.quota_value),h.set("source",a.form.source),h.set("comm",a.form.comm),h.set("status",a.form.status),h.set("requester",a.form.requester),h.set("applicant_id",a.form.applicant_id),h.set("refuse_reason",a.form.refuse_reason),r&&h.set("request_time",ue()),m&&h.set("approve_time",ue());for(let c of a.form.file_list)h.append("file_list",c)}B.put(`/goal/${a.form.id}`,h).then(c=>{b.commit("loading",!1),c.data.status===200?a.success():C({type:"error",message:c.data.message})}).catch(c=>{b.commit("loading",!1),C({type:"error",message:c})})}})};return(v,y)=>{const h=p("el-option"),c=p("el-select"),g=p("el-form-item"),u=p("el-input"),_=p("el-button"),j=p("el-upload"),S=p("el-form");return s(),w(S,{ref_key:"form_ref",ref:o,model:i.form,rules:V,"label-position":"top","label-width":"80px","status-icon":""},{default:l(()=>[e("div",Qt,[e("div",Xt,[e("div",null,[e("table",Yt,[e("tr",null,[e("td",Zt,[t(g,{label:"填报人",prop:"requester",required:""},{default:l(()=>[t(c,{modelValue:i.form.requester,"onUpdate:modelValue":y[0]||(y[0]=M=>i.form.requester=M),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(d.value,M=>(s(),w(h,{label:M.id+" - "+M.name,value:M.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",el,[t(g,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(c,{modelValue:i.form.dept_id,"onUpdate:modelValue":y[1]||(y[1]=M=>i.form.dept_id=M),filterable:"",required:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.dept_list,M=>(s(),w(h,{label:M.name,value:M.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",tl,[t(g,{label:"一级指标",required:""},{default:l(()=>[t(u,{modelValue:i.form.quota_1,"onUpdate:modelValue":y[2]||(y[2]=M=>i.form.quota_1=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",ll,[t(g,{label:"二级指标",required:""},{default:l(()=>[t(u,{modelValue:i.form.quota_2,"onUpdate:modelValue":y[3]||(y[3]=M=>i.form.quota_2=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",al,[t(g,{label:"三级指标",required:""},{default:l(()=>[t(u,{modelValue:i.form.quota_3,"onUpdate:modelValue":y[4]||(y[4]=M=>i.form.quota_3=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",ol,[t(g,{label:"指标值",required:""},{default:l(()=>[t(u,{modelValue:i.form.quota_value,"onUpdate:modelValue":y[5]||(y[5]=M=>i.form.quota_value=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(g,{label:"指标来源",required:""},{default:l(()=>[t(u,{modelValue:i.form.source,"onUpdate:modelValue":y[6]||(y[6]=M=>i.form.source=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(g,{label:"备注"},{default:l(()=>[t(u,{modelValue:i.form.comm,"onUpdate:modelValue":y[7]||(y[7]=M=>i.form.comm=M),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(g,{label:"附件"},{default:l(()=>[t(j,{"file-list":i.form.file_list,"onUpdate:fileList":y[8]||(y[8]=M=>i.form.file_list=M),multiple:"",onChange:$},{default:l(()=>[t(_,{type:"primary"},{default:l(()=>[x("上传附件")]),_:1})]),_:1},8,["file-list"])]),_:1})]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(g,{label:"审批小组",required:""},{default:l(()=>[t(c,{modelValue:i.form.applicant_id,"onUpdate:modelValue":y[9]||(y[9]=M=>i.form.applicant_id=M),disabled:"",filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.expert_group,M=>(s(),w(h,{label:M.tag,value:M.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[t(g,{label:"审批状态",required:""},{default:l(()=>[t(c,{modelValue:i.form.status,"onUpdate:modelValue":y[10]||(y[10]=M=>i.form.status=M),disabled:"",filterable:"",onChange:n},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.approve_status_list,(M,W)=>(s(),w(h,{label:M,value:W},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),i.form.status==3?(s(),z("tr",rl,[e("td",null,[t(g,{label:"审批驳回原因",required:""},{default:l(()=>[t(u,{modelValue:i.form.refuse_reason,"onUpdate:modelValue":y[11]||(y[11]=M=>i.form.refuse_reason=M),type:"textarea"},null,8,["modelValue"])]),_:1})])])):E("",!0)])])]),e("div",null,[t(g,null,{default:l(()=>[e("div",dl,[t(_,{type:"primary",onClick:y[12]||(y[12]=M=>k(o.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})])])]),_:1},8,["model","rules"])}}}),K=i=>(ae("data-v-915b1a2d"),i=i(),oe(),i),nl={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},sl=K(()=>e("p",null,"绩效指标",-1)),il={class:"detail"},_l=K(()=>e("th",null,"附件",-1)),ml={style:{margin:"0",padding:"0 1rem"}},pl=["href"],fl=K(()=>e("th",null,"指标来源",-1)),cl=K(()=>e("th",null,"备注",-1)),gl=K(()=>e("th",null,"申请人",-1)),bl=K(()=>e("th",null,"审批小组",-1)),yl=K(()=>e("th",null,"申请时间",-1)),Vl=K(()=>e("th",null,"审批时间",-1)),vl={key:0},ql=K(()=>e("th",null,"驳回原因",-1)),wl=T({__name:"index",setup(i){O({0:"待申请",1:"待审批",2:"审批通过",3:"审批驳回"});const a=A(),b=O([]),d=L({curr_page:1,total:10,page_size:10}),o=O(0),V=O(!1),$=O([]);$.value.length===0&&B.get("/user/-1").then(g=>{$.value=g.data.data});const f=O(!1),r=g=>{m(g)};b.value.length===0&&m(1);function m(g){a.commit("loading",!0);const u=`/goal/-1?reverse=1&current_page=${g}&page_size=${d.page_size}`;B.get(u,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(_=>{a.commit("loading",!1),_.data.status===200?(b.value=_.data.data,d.page_size=_.data.page_info.page_size,d.total=_.data.page_info.total):C({type:"error",message:_.data.message})}).catch(_=>{a.commit("loading",!1),C({type:"error",message:_})})}const n=()=>{f.value=!1,m(d.curr_page)},k=g=>{o.value=g,V.value=!0},v=g=>{le.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(u=>{y(g)}).catch(u=>{C({type:"info",message:"操作已取消"})})};function y(g){const u="/goal/"+b.value[g].id;B.delete(u).then(_=>{_.data.status===200?(C({type:"success",message:"删除成功"}),m(d.curr_page)):C({type:"error",message:`删除失败 ${_.data.message}`})}).catch(_=>{C({type:"error",message:_})})}const h=()=>{V.value=!1,m(d.curr_page)};function c(g){a.commit("loading",!0);let u=new FormData;u.set("status","1"),B.put(`/goal/approve/${g}`,u).then(_=>{a.commit("loading",!1),_.data.status==200?(C.success("申请审核成功，请等待审核结果"),m(d.curr_page)):C.error(_.data.message)}).catch(_=>{a.commit("loading",!1),C.error(_)})}return(g,u)=>{const _=p("el-button"),j=p("el-button-group"),S=p("el-table-column"),M=p("el-text"),W=p("el-table"),R=p("el-pagination"),q=p("el-dialog");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",nl,[sl,t(j,{size:"small"},{default:l(()=>[t(_,{type:"primary",onClick:u[0]||(u[0]=U=>f.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(W,{data:b.value,height:"100%"},{default:l(()=>[t(S,{fixed:"",type:"expand"},{default:l(U=>[e("table",il,[e("tr",null,[_l,e("td",null,[e("ol",ml,[(s(!0),z(J,null,D(U.row.file_list,N=>(s(),z("li",null,[e("a",{href:P(_e).base_url+"/"+N.path,class:"file_href",style:{color:"#000"},target:"_blank"},F(N.name),9,pl)]))),256))])])]),e("tr",null,[fl,e("td",null,F(U.row.source),1)]),e("tr",null,[cl,e("td",null,F(U.row.comm),1)]),e("tr",null,[gl,e("td",null,F(U.row.requester_name),1)]),e("tr",null,[bl,e("td",null,F(U.row.applicant_tag),1)]),e("tr",null,[yl,e("td",null,F(U.row.request_time),1)]),e("tr",null,[Vl,e("td",null,F(U.row.approve_time),1)]),U.row.status==3?(s(),z("tr",vl,[ql,e("td",null,F(U.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(S,{label:"绩效编码",prop:"code",width:"130rem"}),t(S,{label:"一级指标",prop:"quota_1"}),t(S,{label:"二级指标",prop:"quota_2"}),t(S,{label:"三级指标",prop:"quota_3"}),t(S,{label:"指标值",prop:"quota_value"}),t(S,{label:"申请者",width:"130rem"},{default:l(U=>[x(F(U.row.requester)+" - "+F(U.row.requester_name),1)]),_:1}),t(S,{align:"center",label:"审批状态"},{default:l(U=>[U.row.status==0?(s(),w(M,{key:0,type:"primary"},{default:l(()=>[x("待申请审批")]),_:1})):U.row.status==1?(s(),w(M,{key:1,type:"warning"},{default:l(()=>[x("待审批")]),_:1})):U.row.status==2?(s(),w(M,{key:2,type:"success"},{default:l(()=>[x("审批通过")]),_:1})):U.row.status==3?(s(),w(M,{key:3,type:"danger"},{default:l(()=>[x("审批驳回")]),_:1})):E("",!0)]),_:1}),t(S,{align:"center",label:"操作"},{default:l(U=>[t(j,{size:"small"},{default:l(()=>[U.row.status==0?(s(),w(_,{key:0,type:"warning",onClick:N=>c(U.row.id)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0),t(_,{disabled:U.row.status!=0&&U.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:N=>k(U.$index)},{default:l(()=>[x("编辑 ")]),_:2},1032,["disabled","onClick"]),t(_,{disabled:U.row.status!=0,type:"danger",onClick:N=>v(U.$index)},{default:l(()=>[x(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(R,{"current-page":d.curr_page,"onUpdate:currentPage":u[1]||(u[1]=U=>d.curr_page=U),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:r},null,8,["current-page","page-size","total"])]),_:1}),t(q,{modelValue:f.value,"onUpdate:modelValue":u[2]||(u[2]=U=>f.value=U),"destroy-on-close":"",title:"新增"},{default:l(()=>[t(Kt,{success:n,width:"90%"})]),_:1},8,["modelValue"]),t(q,{modelValue:V.value,"onUpdate:modelValue":u[3]||(u[3]=U=>V.value=U),closed:m(d.curr_page),"destroy-on-close":"",title:"编辑"},{default:l(()=>[t(ul,{form:b.value[o.value],success:h},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const $l=re(wl,[["__scopeId","data-v-915b1a2d"]]),xl={class:"w-100"},kl={colspan:"2"},Ul={colspan:"2"},hl={colspan:"2"},Cl={colspan:"2"},jl={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},zl=T({__name:"AnnualWorkPlanCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O(),o=L({name:"",detail:"",job_resp_id:"",per_goal_id:"",carry_out:"",comm:"",dept_id:b.getters.userinfo.dept_id,status:0,requester:b.getters.userinfo.id});o.status;const V=L({name:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],job_resp_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],per_goal_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],carry_out:[{required:!0,message:"该选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),$=f=>{f&&f.validate(r=>{if(r){b.commit("loading",!0);let m=new FormData;m.set("detail",o.detail),m.set("name",o.name),m.set("job_resp_id",o.job_resp_id),m.set("per_goal_id",o.per_goal_id),m.set("carry_out",o.carry_out),m.set("comm",o.comm),m.set("dept_id",o.dept_id),m.set("status",JSON.stringify(o.status)),m.set("requester",o.requester),B.post("/awp",m).then(n=>{b.commit("loading",!1),n.data.status===200?(C({type:"success",message:"新增成功"}),a.success()):C({type:"error",message:n.data.message})}).catch(n=>{b.commit("loading",!1),C({type:"error",message:n})})}})};return(f,r)=>{const m=p("el-input"),n=p("el-form-item"),k=p("el-option"),v=p("el-select"),y=p("el-radio"),h=p("el-radio-group"),c=p("el-button"),g=p("el-form");return s(),w(g,{ref_key:"form_ref",ref:d,model:o,rules:V,"label-position":"top","status-icon":""},{default:l(()=>[e("table",xl,[e("tr",null,[e("td",kl,[t(n,{label:"计划名称",prop:"name",required:""},{default:l(()=>[t(m,{modelValue:o.name,"onUpdate:modelValue":r[0]||(r[0]=u=>o.name=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ul,[t(n,{label:"计划详情",prop:"detail",required:""},{default:l(()=>[t(m,{modelValue:o.detail,"onUpdate:modelValue":r[1]||(r[1]=u=>o.detail=u),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"隶属工作职责编码",prop:"job_resp_id",required:""},{default:l(()=>[t(v,{modelValue:o.job_resp_id,"onUpdate:modelValue":r[2]||(r[2]=u=>o.job_resp_id=u),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.job_list,u=>(s(),w(k,{label:u.code,value:u.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"绩效编码",prop:"per_goal_id",required:""},{default:l(()=>[t(v,{modelValue:o.per_goal_id,"onUpdate:modelValue":r[3]||(r[3]=u=>o.per_goal_id=u),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.goal_list,u=>(s(),w(k,{label:u.code,value:u.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",hl,[t(n,{label:"上年度是否开展",prop:"carry_out",required:""},{default:l(()=>[t(h,{modelValue:o.carry_out,"onUpdate:modelValue":r[4]||(r[4]=u=>o.carry_out=u)},{default:l(()=>[t(y,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(y,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Cl,[t(n,{label:"备注"},{default:l(()=>[t(m,{modelValue:o.comm,"onUpdate:modelValue":r[5]||(r[5]=u=>o.comm=u),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(n,null,{default:l(()=>[e("div",jl,[t(c,{type:"primary",onClick:r[6]||(r[6]=u=>$(d.value))},{default:l(()=>[x("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Ml={class:"w-100"},Fl={colspan:"2"},Ol={colspan:"2"},Sl={colspan:"2"},Jl={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Nl=T({__name:"AnnualWorkPlanEditForm",props:{form:{type:Object,required:!0,default:{name:"",code:"",detail:"",job_resp_id:"",per_goal_id:"",carry_out:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A();a.form.status;const d=O(),o=L({name:[{required:!0,message:"请输入计划名称",trigger:"blur"}]}),V=$=>{$.validate(f=>{if(f){b.commit("loading",!0);let r=new FormData;r.set("name",a.form.name),r.set("detail",a.form.detail),r.set("job_resp_id",a.form.job_resp_id),r.set("per_goal_id",a.form.per_goal_id),r.set("carry_out",a.form.carry_out),r.set("comm",a.form.comm),r.set("status",JSON.stringify(a.form.status)),r.set("requester",a.form.requester),r.set("refuse_reason",a.form.refuse_reason),B.put(`/awp/${a.form.code}`,r).then(m=>{b.commit("loading",!1),m.data.status===200?(C({type:"success",message:"修改成功"}),a.success()):C({type:"error",message:m.data.message})}).catch(m=>{b.commit("loading",!1),C({type:"error",message:m})})}})};return($,f)=>{const r=p("el-input"),m=p("el-form-item"),n=p("el-radio"),k=p("el-radio-group"),v=p("el-button"),y=p("el-form");return s(),w(y,{ref_key:"form_ref",ref:d,model:i.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("table",Ml,[e("tr",null,[e("td",null,[t(m,{label:" 计划编码",prop:"code",required:""},{default:l(()=>[t(r,{modelValue:i.form.code,"onUpdate:modelValue":f[0]||(f[0]=h=>i.form.code=h),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"计划名称"},{default:l(()=>[t(r,{modelValue:i.form.name,"onUpdate:modelValue":f[1]||(f[1]=h=>i.form.name=h),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Fl,[t(m,{label:"计划详情"},{default:l(()=>[t(r,{modelValue:i.form.detail,"onUpdate:modelValue":f[2]||(f[2]=h=>i.form.detail=h),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(m,{label:"隶属工作职责编码"},{default:l(()=>[t(r,{modelValue:i.form.job_resp_id,"onUpdate:modelValue":f[3]||(f[3]=h=>i.form.job_resp_id=h)},null,8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"绩效编码"},{default:l(()=>[t(r,{modelValue:i.form.per_goal_id,"onUpdate:modelValue":f[4]||(f[4]=h=>i.form.per_goal_id=h)},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ol,[t(m,{label:"上年度是否开展"},{default:l(()=>[t(k,{modelValue:i.form.carry_out,"onUpdate:modelValue":f[5]||(f[5]=h=>i.form.carry_out=h)},{default:l(()=>[t(n,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(n,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Sl,[t(m,{label:"备注"},{default:l(()=>[t(r,{modelValue:i.form.comm,"onUpdate:modelValue":f[6]||(f[6]=h=>i.form.comm=h),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(m,null,{default:l(()=>[e("div",Jl,[t(v,{type:"primary",onClick:f[7]||(f[7]=h=>V(d.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Q=i=>(ae("data-v-308bf035"),i=i(),oe(),i),Dl={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},Bl=Q(()=>e("p",null,"年度工作计划",-1)),Pl={class:"detail"},El=Q(()=>e("th",null,"计划详情",-1)),Il=Q(()=>e("th",null,"备注",-1)),Tl=Q(()=>e("th",null,"工作职责概述",-1)),Ll=Q(()=>e("th",null,"申请人",-1)),Al=Q(()=>e("th",null,"审批小组",-1)),Gl=Q(()=>e("th",null,"申请时间",-1)),Rl=Q(()=>e("th",null,"审批时间",-1)),Wl={key:0},Hl=Q(()=>e("th",null,"驳回原因",-1)),Kl=T({__name:"index",setup(i){const a=A(),b=O([]),d=L({curr_page:1,total:10,page_size:14}),o=O(0),V=O(!1),$=O(!1),f=c=>{r(c)};b.value.length===0&&r(1);function r(c){a.commit("loading",!0);const g=`/awp/-1?reverse=1&current_page=${c}&page_size=${d.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(u=>{a.commit("loading",!1),u.data.status===200?(b.value=u.data.data,d.page_size=u.data.page_info.page_size,d.total=u.data.page_info.total):C({type:"error",message:u.data.message})}).catch(u=>{a.commit("loading",!1),C({type:"error",message:u})})}const m=()=>{$.value=!1,r(d.curr_page)},n=c=>{o.value=c,V.value=!0},k=c=>{le.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{v(c)}).catch(g=>{C({type:"info",message:"操作已取消"})})};function v(c){const g="/awp/"+b.value[c].id;B.delete(g).then(u=>{u.data.status===200?(C({type:"success",message:"删除成功"}),r(d.curr_page)):C({type:"error",message:`删除失败 ${u.data.message}`})}).catch(u=>{C({type:"error",message:u})})}const y=()=>{V.value=!1,r(d.curr_page)};function h(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/awp/approve/${c}`,g).then(u=>{a.commit("loading",!1),u.data.status==200?(C.success("申请审核成功，请等待审核结果"),r(d.curr_page)):C.error(u.data.message)}).catch(u=>{a.commit("loading",!1),C.error(u)})}return(c,g)=>{const u=p("el-button"),_=p("el-button-group"),j=p("el-table-column"),S=p("el-text"),M=p("el-table"),W=p("el-pagination"),R=p("el-dialog");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",Dl,[Bl,t(_,{size:"small"},{default:l(()=>[t(u,{type:"primary",onClick:g[0]||(g[0]=q=>$.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(M,{data:b.value,height:"100%"},{default:l(()=>[t(j,{fixed:"",type:"expand"},{default:l(q=>[e("table",Pl,[e("tr",null,[El,e("td",null,F(q.row.detail),1)]),e("tr",null,[Il,e("td",null,F(q.row.comm),1)]),e("tr",null,[Tl,e("td",null,F(q.row.job_resp_abst),1)]),e("tr",null,[Ll,e("td",null,F(q.row.requester_name),1)]),e("tr",null,[Al,e("td",null,F(q.row.applicant_tag),1)]),e("tr",null,[Gl,e("td",null,F(q.row.request_time),1)]),e("tr",null,[Rl,e("td",null,F(q.row.approve_time),1)]),q.row.status==3?(s(),z("tr",Wl,[Hl,e("td",null,F(q.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(j,{label:"计划编码",prop:"code"}),t(j,{label:"计划名称",prop:"name"}),t(j,{label:"上年度是否开展"},{default:l(q=>[q.row.carry_out?(s(),w(S,{key:0,type:"success"},{default:l(()=>[x("已开展")]),_:1})):(s(),w(S,{key:1,type:"danger"},{default:l(()=>[x("未开展")]),_:1}))]),_:1}),t(j,{align:"center",label:"审批状态"},{default:l(q=>[q.row.status==0?(s(),w(S,{key:0,type:"primary"},{default:l(()=>[x("待申请审批")]),_:1})):q.row.status==1?(s(),w(S,{key:1,type:"warning"},{default:l(()=>[x("待审批")]),_:1})):q.row.status==2?(s(),w(S,{key:2,type:"success"},{default:l(()=>[x("审批通过")]),_:1})):q.row.status==3?(s(),w(S,{key:3,type:"danger"},{default:l(()=>[x("审批驳回")]),_:1})):E("",!0)]),_:1}),t(j,{align:"center",label:"操作"},{default:l(q=>[t(_,{size:"small"},{default:l(()=>[q.row.status==0?(s(),w(u,{key:0,type:"warning",onClick:U=>h(q.row.code)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0),t(u,{disabled:q.row.status!=0&&q.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:U=>n(q.$index)},{default:l(()=>[x("编辑 ")]),_:2},1032,["disabled","onClick"]),t(u,{disabled:q.row.status!=0,type:"danger",onClick:U=>k(q.$index)},{default:l(()=>[x(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(W,{"current-page":d.curr_page,"onUpdate:currentPage":g[1]||(g[1]=q=>d.curr_page=q),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1}),t(R,{modelValue:$.value,"onUpdate:modelValue":g[2]||(g[2]=q=>$.value=q),closed:r(d.curr_page),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(zl,{success:m})]),_:1},8,["modelValue","closed"]),t(R,{modelValue:V.value,"onUpdate:modelValue":g[3]||(g[3]=q=>V.value=q),closed:r(d.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(Nl,{form:b.value[o.value],success:y},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const Ql=re(Kl,[["__scopeId","data-v-308bf035"]]),Xl={class:"w-100"},Yl={colspan:"2"},Zl={colspan:"2"},ea={colspan:"2"},ta={colspan:"2"},la={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},aa=T({__name:"AnnualEconomicBusinessPlanCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O(),o=L({detail:"",start_date:"",content:"",eco_class_id:"",annual_work_plan_id:"",carry_out:"",comm:"",dept_id:b.getters.userinfo.dept_id,status:0,requester:b.getters.userinfo.id}),V=L({detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],start_date:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],content:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],annual_work_plan_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],eco_class_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]});o.status;const $=f=>{f&&f.validate(r=>{if(r){let m=new FormData;m.set("detail",o.detail),m.set("start_date",fe.format_date(o.start_date)),m.set("content",o.content),m.set("eco_class_id",o.eco_class_id),m.set("annual_work_plan_id",o.annual_work_plan_id),m.set("carry_out",o.carry_out),m.set("comm",o.comm),m.set("dept_id",o.dept_id),m.set("status",JSON.stringify(o.status)),m.set("requester",o.requester),B.post("/aebp",m).then(n=>{n.data.status===200?a.success():C({type:"error",message:n.data.message})}).catch(n=>{C({type:"error",message:n})})}})};return(f,r)=>{const m=p("el-date-picker"),n=p("el-form-item"),k=p("el-option"),v=p("el-select"),y=p("el-option-group"),h=p("el-input"),c=p("el-radio"),g=p("el-radio-group"),u=p("el-button"),_=p("el-form");return s(),w(_,{ref_key:"form_ref",ref:d,model:o,rules:V,"label-position":"top","status-icon":""},{default:l(()=>[e("table",Xl,[e("tr",null,[e("td",null,[t(n,{label:"开展月份",required:""},{default:l(()=>[t(m,{modelValue:o.start_date,"onUpdate:modelValue":r[0]||(r[0]=j=>o.start_date=j),type:"month"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"衔接计划编码",required:""},{default:l(()=>[t(v,{modelValue:o.annual_work_plan_id,"onUpdate:modelValue":r[1]||(r[1]=j=>o.annual_work_plan_id=j),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.awp_list,j=>(s(),w(k,{label:j.code+" - "+j.name,value:j.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"经济分类",required:""},{default:l(()=>[t(v,{modelValue:o.eco_class_id,"onUpdate:modelValue":r[2]||(r[2]=j=>o.eco_class_id=j),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,j=>(s(),w(y,{label:j.classify+" - "+j.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[j.classify],S=>(s(),w(k,{label:S.classify+S.kind+" - "+S.name,value:S.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Yl,[t(n,{label:"业务经济内容",required:""},{default:l(()=>[t(h,{modelValue:o.detail,"onUpdate:modelValue":r[3]||(r[3]=j=>o.detail=j),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Zl,[t(n,{label:"产生支出内容",required:""},{default:l(()=>[t(h,{modelValue:o.content,"onUpdate:modelValue":r[4]||(r[4]=j=>o.content=j),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ea,[t(n,{label:"上年度是否开展",required:""},{default:l(()=>[t(g,{modelValue:o.carry_out,"onUpdate:modelValue":r[5]||(r[5]=j=>o.carry_out=j)},{default:l(()=>[t(c,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(c,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ta,[t(n,{label:"备注"},{default:l(()=>[t(h,{modelValue:o.comm,"onUpdate:modelValue":r[6]||(r[6]=j=>o.comm=j),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(n,null,{default:l(()=>[e("div",la,[t(u,{type:"primary",onClick:r[7]||(r[7]=j=>$(d.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),oa={class:"w-100"},ra={style:{width:"50%"}},da={colspan:"2"},ua={colspan:"2"},na={colspan:"2"},sa={colspan:"2"},ia={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},_a=T({__name:"AnnualEconomicBusinessPlanEditForm",props:{form:{type:Object,required:!0,default:{code:"",detail:"",start_date:"",content:"",eco_class_id:"",annual_work_plan_id:"",carry_out:"",comm:"",dept_id:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O(),o=L({detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],start_date:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],content:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],annual_work_plan_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],eco_class_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]});a.form.status;const V=$=>{$&&$.validate(f=>{if(f){let r=new FormData;r.set("detail",a.form.detail),r.set("start_date",fe.format_date(a.form.start_date)),r.set("content",a.form.content),r.set("eco_class_id",a.form.eco_class_id),r.set("annual_work_plan_id",a.form.annual_work_plan_id),r.set("carry_out",a.form.carry_out),r.set("comm",a.form.comm),r.set("dept_id",a.form.dept_id),r.set("status",JSON.stringify(a.form.status)),r.set("requester",a.form.requester),r.set("applicant_id",a.form.applicant_id),r.set("refuse_reason",a.form.refuse_reason),B.put(`/aebp/${a.form.code}`,r).then(m=>{m.data.status===200?a.success():C({type:"error",message:m.data.message})}).catch(m=>{C({type:"error",message:m})})}})};return($,f)=>{const r=p("el-input"),m=p("el-form-item"),n=p("el-date-picker"),k=p("el-option"),v=p("el-select"),y=p("el-option-group"),h=p("el-radio"),c=p("el-radio-group"),g=p("el-button"),u=p("el-form");return s(),w(u,{ref_key:"form_ref",ref:d,model:i.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("table",oa,[e("tr",null,[e("td",ra,[t(m,{label:"经济业务计划单编号"},{default:l(()=>[t(r,{modelValue:a.form.code,"onUpdate:modelValue":f[0]||(f[0]=_=>a.form.code=_),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"开展月份",required:""},{default:l(()=>[t(n,{modelValue:a.form.start_date,"onUpdate:modelValue":f[1]||(f[1]=_=>a.form.start_date=_),type:"month"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(m,{label:"衔接计划编码",required:""},{default:l(()=>[t(v,{modelValue:a.form.annual_work_plan_id,"onUpdate:modelValue":f[2]||(f[2]=_=>a.form.annual_work_plan_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.awp_list,_=>(s(),w(k,{label:_.code+" - "+_.name,value:_.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"经济类型",required:""},{default:l(()=>[t(v,{modelValue:a.form.eco_class_id,"onUpdate:modelValue":f[3]||(f[3]=_=>a.form.eco_class_id=_),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,_=>(s(),w(y,{label:_.classify+" - "+_.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[_.classify],j=>(s(),w(k,{label:j.classify+j.kind+" - "+j.name,value:j.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",da,[t(m,{label:"业务经济内容",required:""},{default:l(()=>[t(r,{modelValue:a.form.detail,"onUpdate:modelValue":f[4]||(f[4]=_=>a.form.detail=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ua,[t(m,{label:"产生支出内容",required:""},{default:l(()=>[t(r,{modelValue:a.form.content,"onUpdate:modelValue":f[5]||(f[5]=_=>a.form.content=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",na,[t(m,{label:"上年度是否开展",required:""},{default:l(()=>[t(c,{modelValue:a.form.carry_out,"onUpdate:modelValue":f[6]||(f[6]=_=>a.form.carry_out=_)},{default:l(()=>[t(h,{label:!0},{default:l(()=>[x("已开展")]),_:1}),t(h,{label:!1},{default:l(()=>[x("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",sa,[t(m,{label:"备注"},{default:l(()=>[t(r,{modelValue:a.form.comm,"onUpdate:modelValue":f[7]||(f[7]=_=>a.form.comm=_),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(m,null,{default:l(()=>[e("div",ia,[t(g,{type:"primary",onClick:f[8]||(f[8]=_=>V(d.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),X=i=>(ae("data-v-1c4fa1c9"),i=i(),oe(),i),ma={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},pa=X(()=>e("p",null,"年度经济业务计划单",-1)),fa={class:"detail"},ca=X(()=>e("th",null,"业务经济内容",-1)),ga=X(()=>e("th",null,"支出内容",-1)),ba=X(()=>e("th",null,"备注",-1)),ya=X(()=>e("th",null,"申请人",-1)),Va=X(()=>e("th",null,"审批小组",-1)),va=X(()=>e("th",null,"申请时间",-1)),qa=X(()=>e("th",null,"审批时间",-1)),wa={key:0},$a=X(()=>e("th",null,"驳回原因",-1)),xa=T({__name:"index",setup(i){const a=A(),b=O([]),d=L({curr_page:1,total:10,page_size:14}),o=O(0),V=O(!1),$=O(!1),f=c=>{r(c)};b.value.length===0&&r(1);function r(c){a.commit("loading",!0);const g=`/aebp/-1?reverse=1&current_page=${c}&page_size=${d.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(u=>{a.commit("loading",!1),u.data.status===200?(b.value=u.data.data,d.page_size=u.data.page_info.page_size,d.total=u.data.page_info.total):C({type:"error",message:u.data.message})}).catch(u=>{a.commit("loading",!1),C({type:"error",message:u})})}const m=()=>{$.value=!1,r(d.curr_page)},n=c=>{o.value=c,V.value=!0},k=c=>{le.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{v(c)}).catch(g=>{C({type:"info",message:"操作已取消"})})};function v(c){a.commit("loading",!0);const g="/aebp/"+b.value[c].id;B.delete(g).then(u=>{a.commit("loading",!1),u.data.status===200?(C({type:"success",message:"删除成功"}),r(d.curr_page)):C({type:"error",message:`删除失败 ${u.data.message}`})}).catch(u=>{a.commit("loading",!1),C({type:"error",message:u})})}const y=()=>{V.value=!1,r(d.curr_page)};function h(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/aebp/approve/${c}`,g).then(u=>{a.commit("loading",!1),u.data.status==200?(C.success("申请审核成功，请等待审核结果"),r(d.curr_page)):C.error(u.data.message)}).catch(u=>{a.commit("loading",!1),C.error(u)})}return(c,g)=>{const u=p("el-button"),_=p("el-button-group"),j=p("el-table-column"),S=p("el-text"),M=p("el-table"),W=p("el-pagination"),R=p("el-dialog");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",ma,[pa,t(_,{size:"small"},{default:l(()=>[t(u,{type:"primary",onClick:g[0]||(g[0]=q=>$.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(M,{data:b.value},{default:l(()=>[t(j,{fixed:"",type:"expand"},{default:l(q=>[e("table",fa,[e("tr",null,[ca,e("td",null,F(q.row.detail),1)]),e("tr",null,[ga,e("td",null,F(q.row.content),1)]),e("tr",null,[ba,e("td",null,F(q.row.comm),1)]),e("tr",null,[ya,e("td",null,F(q.row.requester_name),1)]),e("tr",null,[Va,e("td",null,F(q.row.applicant_tag),1)]),e("tr",null,[va,e("td",null,F(q.row.request_time),1)]),e("tr",null,[qa,e("td",null,F(q.row.approve_time),1)]),q.row.status==3?(s(),z("tr",wa,[$a,e("td",null,F(q.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(j,{label:"业务单编码",prop:"code"}),t(j,{label:"开展月份",prop:"start_date"}),t(j,{label:"计划编码",prop:"annual_work_plan_id"}),t(j,{label:"经济类型",prop:"eco_class_name"}),t(j,{label:"上年度是否开展"},{default:l(q=>[q.row.carry_out?(s(),w(S,{key:0,type:"success"},{default:l(()=>[x("已开展")]),_:1})):(s(),w(S,{key:1,type:"danger"},{default:l(()=>[x("未开展")]),_:1}))]),_:1}),t(j,{align:"center",label:"审批状态"},{default:l(q=>[q.row.status==0?(s(),w(S,{key:0,type:"primary"},{default:l(()=>[x("待申请审批")]),_:1})):q.row.status==1?(s(),w(S,{key:1,type:"warning"},{default:l(()=>[x("待审批")]),_:1})):q.row.status==2?(s(),w(S,{key:2,type:"success"},{default:l(()=>[x("审批通过")]),_:1})):q.row.status==3?(s(),w(S,{key:3,type:"danger"},{default:l(()=>[x("审批驳回")]),_:1})):E("",!0)]),_:1}),t(j,{align:"center",fit:"",label:"操作",width:"200px"},{default:l(q=>[t(_,{size:"small"},{default:l(()=>[q.row.status==0?(s(),w(u,{key:0,type:"warning",onClick:U=>h(q.row.code)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0),t(u,{disabled:q.row.status!=0&&q.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:U=>n(q.$index)},{default:l(()=>[x("编辑 ")]),_:2},1032,["disabled","onClick"]),t(u,{disabled:q.row.status!=0,type:"danger",onClick:U=>k(q.$index)},{default:l(()=>[x(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(W,{"current-page":d.curr_page,"onUpdate:currentPage":g[1]||(g[1]=q=>d.curr_page=q),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1}),t(R,{modelValue:$.value,"onUpdate:modelValue":g[2]||(g[2]=q=>$.value=q),closed:r(d.curr_page),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(aa,{success:m})]),_:1},8,["modelValue","closed"]),t(R,{modelValue:V.value,"onUpdate:modelValue":g[3]||(g[3]=q=>V.value=q),closed:r(d.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(_a,{form:b.value[o.value],success:y},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const ka=re(xa,[["__scopeId","data-v-1c4fa1c9"]]),Ua={class:"d-flex flex-row-1"},ha={class:"flex-1"},Ca={colspan:"2"},ja={colspan:"2"},za={colspan:"2"},Ma={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Fa=T({__name:"BudgetCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A(),d=O(),o=L({economy_id:"",detail:"",budget_price:0,actual_cost:0,diff_reason:"",aebp_id:"",comm:"",status:0,requester:b.getters.userinfo.id});o.status;const V=L({economy_id:[{required:!0,message:"请输入经济分类名称",trigger:"blur"}],detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],actual_cost:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],diff_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],aebp_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]}),$=f=>{f&&f.validate(r=>{if(r){b.commit("loading",!0);let m=new FormData;m.set("economy_id",o.economy_id),m.set("detail",o.detail),m.set("budget_price",JSON.stringify(o.budget_price)),m.set("aebp_id",o.aebp_id),m.set("actual_cost",JSON.stringify(o.actual_cost)),m.set("diff_reason",o.diff_reason),m.set("comm",o.comm),m.set("status",JSON.stringify(o.status)),m.set("requester",o.requester),B.post("/budget",m).then(n=>{b.commit("loading",!1),n.data.status===200?(C({type:"success",message:"新增成功"}),a.success()):C({type:"error",message:n.data.message})}).catch(n=>{b.commit("loading",!1),C({type:"error",message:n})})}})};return(f,r)=>{const m=p("el-input-number"),n=p("el-form-item"),k=p("el-option"),v=p("el-option-group"),y=p("el-select"),h=p("el-input"),c=p("el-button"),g=p("el-form");return s(),w(g,{ref_key:"form_ref",ref:d,model:o,rules:V,"label-position":"top","status-icon":""},{default:l(()=>[e("div",Ua,[e("table",ha,[e("tr",null,[e("td",null,[t(n,{label:"预算金额(元)",required:""},{default:l(()=>[t(m,{modelValue:o.budget_price,"onUpdate:modelValue":r[0]||(r[0]=u=>o.budget_price=u),precision:2,step:.01,"controls-position":"right"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"上年度本业务实际支出(元)",required:""},{default:l(()=>[t(m,{modelValue:o.actual_cost,"onUpdate:modelValue":r[1]||(r[1]=u=>o.actual_cost=u),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"经济分类",required:""},{default:l(()=>[t(y,{modelValue:o.economy_id,"onUpdate:modelValue":r[2]||(r[2]=u=>o.economy_id=u),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,u=>(s(),w(v,{label:u.classify+" - "+u.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[u.classify],_=>(s(),w(k,{label:_.classify+_.kind+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"衔接业务单编码",required:""},{default:l(()=>[t(y,{modelValue:o.aebp_id,"onUpdate:modelValue":r[3]||(r[3]=u=>o.aebp_id=u)},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.aebp_list,u=>(s(),w(k,{label:u.code,value:u.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ca,[t(n,{label:"详细测算过程",required:""},{default:l(()=>[t(h,{modelValue:o.detail,"onUpdate:modelValue":r[4]||(r[4]=u=>o.detail=u),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ja,[t(n,{required:o.actual_cost!=o.budget_price&&o.actual_cost!=0,label:"差异说明"},{default:l(()=>[t(h,{modelValue:o.diff_reason,"onUpdate:modelValue":r[5]||(r[5]=u=>o.diff_reason=u),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])]),e("tr",null,[e("td",za,[t(n,{label:"备注"},{default:l(()=>[t(h,{modelValue:o.comm,"onUpdate:modelValue":r[6]||(r[6]=u=>o.comm=u),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),t(n,null,{default:l(()=>[e("div",Ma,[t(c,{type:"primary",onClick:r[7]||(r[7]=u=>$(d.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Oa={class:"d-flex flex-row-1"},Sa={class:"flex-1"},Ja={colspan:"2"},Na={colspan:"2"},Da={colspan:"2"},Ba={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Pa=T({__name:"BudgetEditForm",props:{form:{type:Object,required:!0,default:{economy_id:"",detail:"",budget_price:0,aebp_id:"",actual_cost:0,diff_reason:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(i){const a=i,b=A();a.form.status;const d=O(),o=L({economy_id:[{required:!0,message:"请输入经济分类名称",trigger:"blur"}],detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],actual_cost:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],diff_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],aebp_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],refuse_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]}),V=$=>{$.validate(f=>{if(f){b.commit("loading",!0);let r=new FormData;r.set("economy_id",a.form.economy_id),r.set("detail",a.form.detail),r.set("budget_price",JSON.stringify(a.form.budget_price)),r.set("aebp_id",a.form.aebp_id),r.set("actual_cost",JSON.stringify(a.form.actual_cost)),r.set("diff_reason",a.form.diff_reason),r.set("comm",a.form.comm),r.set("status",JSON.stringify(a.form.status)),r.set("requester",a.form.requester),r.set("refuse_reason",a.form.refuse_reason),B.put(`/budget/${a.form.id}`,r).then(m=>{b.commit("loading",!1),m.data.status===200?a.success():C({type:"error",message:m.data.message})}).catch(m=>{b.commit("loading",!1),C({type:"error",message:m})})}})};return($,f)=>{const r=p("el-input-number"),m=p("el-form-item"),n=p("el-option"),k=p("el-option-group"),v=p("el-select"),y=p("el-input"),h=p("el-button"),c=p("el-form");return s(),w(c,{ref_key:"form_ref",ref:d,model:i.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("div",Oa,[e("table",Sa,[e("tr",null,[e("td",null,[t(m,{label:"预算金额(元)",required:""},{default:l(()=>[t(r,{modelValue:i.form.budget_price,"onUpdate:modelValue":f[0]||(f[0]=g=>i.form.budget_price=g),precision:2,step:.01,"controls-position":"right"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"上年度本业务实际支出(元)",required:""},{default:l(()=>[t(r,{modelValue:i.form.actual_cost,"onUpdate:modelValue":f[1]||(f[1]=g=>i.form.actual_cost=g),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(m,{label:"经济分类",required:""},{default:l(()=>[t(v,{modelValue:i.form.economy_id,"onUpdate:modelValue":f[2]||(f[2]=g=>i.form.economy_id=g),filterable:""},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_class_list,g=>(s(),w(k,{label:g.classify+" - "+g.name},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.eco_kind_list[g.classify],u=>(s(),w(n,{label:u.classify+u.kind+" - "+u.name,value:u.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(m,{label:"衔接业务单编码",required:""},{default:l(()=>[t(v,{modelValue:i.form.aebp_id,"onUpdate:modelValue":f[3]||(f[3]=g=>i.form.aebp_id=g)},{default:l(()=>[(s(!0),z(J,null,D(P(b).getters.aebp_list,g=>(s(),w(n,{label:g.code,value:g.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ja,[t(m,{label:"详细测算过程",required:""},{default:l(()=>[t(y,{modelValue:i.form.detail,"onUpdate:modelValue":f[4]||(f[4]=g=>i.form.detail=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Na,[t(m,{required:i.form.actual_cost!=i.form.budget_price&&i.form.actual_cost!=0,label:"差异说明"},{default:l(()=>[t(y,{modelValue:i.form.diff_reason,"onUpdate:modelValue":f[5]||(f[5]=g=>i.form.diff_reason=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])]),e("tr",null,[e("td",Da,[t(m,{label:"备注"},{default:l(()=>[t(y,{modelValue:i.form.comm,"onUpdate:modelValue":f[6]||(f[6]=g=>i.form.comm=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),t(m,null,{default:l(()=>[e("div",Ba,[t(h,{type:"primary",onClick:f[7]||(f[7]=g=>V(d.value))},{default:l(()=>[x("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Y=i=>(ae("data-v-0461d24f"),i=i(),oe(),i),Ea={class:"d-flex justify-content-between align-content-center align-items-center"},Ia=Y(()=>e("p",null,"公用经费预算",-1)),Ta={class:"detail"},La=Y(()=>e("th",null,"差异说明",-1)),Aa=Y(()=>e("th",null,"备注",-1)),Ga=Y(()=>e("th",null,"详细测算过程",-1)),Ra=Y(()=>e("th",null,"申请人",-1)),Wa=Y(()=>e("th",null,"审批小组",-1)),Ha=Y(()=>e("th",null,"申请时间",-1)),Ka=Y(()=>e("th",null,"审批时间",-1)),Qa={key:0},Xa=Y(()=>e("th",null,"驳回原因",-1)),Ya=T({__name:"index",setup(i){const a=A(),b=O([]),d=L({curr_page:1,total:10,page_size:14}),o=O(0),V=O(!1),$=O(!1),f=c=>{r(c)};b.value.length===0&&r(1);function r(c){const g=`/budget/-1?reverse=1&current_page=${c}&page_size=${d.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(u=>{u.data.status===200?(b.value=u.data.data,d.page_size=u.data.page_info.page_size,d.total=u.data.page_info.total):C({type:"error",message:u.data.message})}).catch(u=>{C({type:"error",message:u})})}const m=()=>{$.value=!1,r(d.curr_page)},n=c=>{o.value=c,V.value=!0},k=c=>{le.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{v(c)}).catch(g=>{C({type:"info",message:"操作已取消"})})};function v(c){a.commit("loading",!0);const g="/budget/"+b.value[c].id;B.delete(g).then(u=>{a.commit("loading",!1),u.data.status===200?(C({type:"success",message:"删除成功"}),r(d.curr_page)):C({type:"error",message:`删除失败 ${u.data.message}`})}).catch(u=>{a.commit("loading",!1),C({type:"error",message:u})})}const y=()=>{V.value=!1,r(d.curr_page)};function h(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/budget/approve/${c}`,g).then(u=>{a.commit("loading",!1),u.data.status==200?(C.success("申请审核成功，请等待审核结果"),r(d.curr_page)):C.error(u.data.message)}).catch(u=>{a.commit("loading",!1),C.error(u)})}return(c,g)=>{const u=p("el-button"),_=p("el-button-group"),j=p("el-table-column"),S=p("el-text"),M=p("el-table"),W=p("el-pagination"),R=p("el-dialog");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",Ea,[Ia,t(_,{size:"small"},{default:l(()=>[t(u,{type:"primary",onClick:g[0]||(g[0]=q=>$.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(M,{data:b.value,fit:"",height:"100%"},{default:l(()=>[t(j,{fixed:"",type:"expand"},{default:l(q=>[e("table",Ta,[e("tr",null,[La,e("td",null,F(q.row.diff_reason),1)]),e("tr",null,[Aa,e("td",null,F(q.row.comm),1)]),e("tr",null,[Ga,e("td",null,F(q.row.detail),1)]),e("tr",null,[Ra,e("td",null,F(q.row.requester_name),1)]),e("tr",null,[Wa,e("td",null,F(q.row.applicant_tag),1)]),e("tr",null,[Ha,e("td",null,F(q.row.request_time),1)]),e("tr",null,[Ka,e("td",null,F(q.row.approve_time),1)]),q.row.status==3?(s(),z("tr",Qa,[Xa,e("td",null,F(q.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(j,{label:"编号",prop:"id"}),t(j,{label:"经济类型",prop:"eco_class_name"}),t(j,{label:"预算金额(元)",prop:"budget_price"}),t(j,{label:"衔接业务单编码",prop:"aebp_id"}),t(j,{label:"上年度本业务实际支出(元)",prop:"actual_cost"}),t(j,{label:"填报人",prop:"requester_name"}),t(j,{align:"center",label:"审批状态"},{default:l(q=>[q.row.status==0?(s(),w(S,{key:0,type:"primary"},{default:l(()=>[x("待申请审批")]),_:1})):q.row.status==1?(s(),w(S,{key:1,type:"warning"},{default:l(()=>[x("待审批")]),_:1})):q.row.status==2?(s(),w(S,{key:2,type:"success"},{default:l(()=>[x("审批通过")]),_:1})):q.row.status==3?(s(),w(S,{key:3,type:"danger"},{default:l(()=>[x("审批驳回")]),_:1})):E("",!0)]),_:1}),t(j,{align:"center",label:"操作",width:"200px"},{default:l(q=>[t(_,{size:"small"},{default:l(()=>[q.row.status==0?(s(),w(u,{key:0,type:"warning",onClick:U=>h(q.row.id)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0),t(u,{disabled:q.row.status!=0&&q.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:U=>n(q.$index)},{default:l(()=>[x("编辑 ")]),_:2},1032,["disabled","onClick"]),t(u,{disabled:q.row.status!=0,type:"danger",onClick:U=>k(q.$index)},{default:l(()=>[x(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(W,{"current-page":d.curr_page,"onUpdate:currentPage":g[1]||(g[1]=q=>d.curr_page=q),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1}),t(R,{modelValue:$.value,"onUpdate:modelValue":g[2]||(g[2]=q=>$.value=q),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(Fa,{success:m})]),_:1},8,["modelValue"]),t(R,{modelValue:V.value,"onUpdate:modelValue":g[3]||(g[3]=q=>V.value=q),closed:r(d.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(Pa,{form:b.value[o.value],success:y},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const Za=re(Ya,[["__scopeId","data-v-0461d24f"]]),eo={class:"d-flex flex-row h-100 m-0 p-0"},to={class:"d-flex flex-col justify-content-between p-right-10"},lo={class:"flex-grow-1"},ao=T({__name:"index",setup(i){A();const a=L([{label:"工作职责",comp:ee(Et)},{label:"年度绩效目标",comp:ee($l)},{label:"年度工作计划",comp:ee(Ql)},{label:"年度经济业务计划单",comp:ee(ka)},{label:"公用经费预算",comp:ee(Za)}]),b=O(a[0].comp),d=o=>{b.value=a[o].comp};return O(!1),(o,V)=>(s(),z("div",eo,[e("div",to,[t(ie,{content:$=>$.label,curr_change:d,data:a,"min-width":"9rem",width:"9rem"},null,8,["content","data"])]),e("div",lo,[(s(),w(me(b.value)))])]))}}),oo={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},ro=e("p",null,"公用经费预算",-1),uo={class:"detail"},no=e("th",null,"差异说明",-1),so=e("th",null,"备注",-1),io=e("th",null,"详细测算过程",-1),_o=e("th",null,"申请人",-1),mo=e("th",null,"审核小组",-1),po=e("th",null,"申请时间",-1),fo=e("th",null,"审核时间",-1),co={key:0},go=e("th",null,"驳回原因",-1),bo=T({__name:"index",setup(i){const a=A(),b=O([]),d=L({curr_page:1,page_size:10,total:1});pe(()=>{a.dispatch("eco_list",{keyword:""})});const o=O({}),V=O({}),$=O({}),f=O({}),r=O({}),m=O(!1),n=O(!1),k=O(!1),v=O(!1),y=O(!1),h=O(!1),c=O(!1);async function g(U,N){let G=await B.get(`/job/id/${U}`);G.data.status===200&&(V.value=G.data.data[0],h.value=!0,N())}async function u(U,N){let G=await B.get(`/goal/id/${U}`);G.data.status===200&&(r.value=G.data.data[0],c.value=!0,N())}async function _(U,N){let G=await B.get(`/awp/code/${U}`);G.data.status===200&&(f.value=G.data.data[0],y.value=!0,await u(f.value.per_goal_id,N),await g(f.value.job_resp_id,N),N())}async function j(U,N){let G=await B.get(`/aebp/code/${U}`);G.data.status===200&&($.value=G.data.data[0],v.value=!0,await _($.value.annual_work_plan_id,N),N())}const S=async U=>{a.commit("loading",!0),o.value=U,k.value=!0,await j(U.aebp_id,()=>{k.value&&v.value&&y.value&&h.value&&c.value&&(a.dispatch("loading",{status:!1}),n.value=!0)})},M=()=>{k.value=!1,v.value=!1,y.value=!1,h.value=!1,c.value=!1};b.value.length===0&&R(1);const W=U=>{R(U)};function R(U){a.commit("loading",!0),B.get(`/budget/requester/${a.getters.userinfo.id}?reverse=1&page_size=${d.page_size}&current_page=${U}`).then(N=>{a.commit("loading",!1),N.data.status===200?(b.value=N.data.data,d.page_size=N.data.page_info.page_size,d.total=N.data.page_info.total):C({type:"error",message:N.data.message})}).catch(N=>{a.commit("loading",!1),C({type:"error",message:N})})}function q(U){a.commit("loading",!0);let N=new FormData;N.set("status","1"),B.put(`/budget/approve/${U}`,N).then(G=>{a.commit("loading",!1),G.data.status==200?(C.success("申请审核成功，请等待审核结果"),R(d.curr_page)):C.error(G.data.message)}).catch(G=>{a.commit("loading",!1),C.error(G)})}return(U,N)=>{const G=p("el-button"),ne=p("el-button-group"),H=p("el-table-column"),de=p("el-text"),ce=p("el-table"),ge=p("el-pagination"),se=p("el-drawer");return s(),z(J,null,[t(te,null,{header:l(()=>[e("div",oo,[ro,t(ne,{size:"small"},{default:l(()=>[t(G,{type:"primary",onClick:N[0]||(N[0]=I=>m.value=!0)},{default:l(()=>[x("新增")]),_:1})]),_:1})])]),content:l(()=>[t(ce,{data:b.value,height:"100%"},{default:l(()=>[t(H,{fixed:"",type:"expand"},{default:l(I=>[e("table",uo,[e("tr",null,[no,e("td",null,F(I.row.diff_reason),1)]),e("tr",null,[so,e("td",null,F(I.row.comm),1)]),e("tr",null,[io,e("td",null,F(I.row.detail),1)]),e("tr",null,[_o,e("td",null,F(I.row.requester_name),1)]),e("tr",null,[mo,e("td",null,F(I.row.applicant_tag),1)]),e("tr",null,[po,e("td",null,F(I.row.request_time),1)]),e("tr",null,[fo,e("td",null,F(I.row.approve_time),1)]),I.row.status==3?(s(),z("tr",co,[go,e("td",null,F(I.row.refuse_reason),1)])):E("",!0)])]),_:1}),t(H,{label:"编号",prop:"id"}),t(H,{label:"经济类型",prop:"eco_class_name"}),t(H,{label:"预算金额(元)",prop:"budget_price"}),t(H,{label:"衔接业务单编码",prop:"aebp_id"}),t(H,{label:"上年度本业务实际支出(元)",prop:"actual_cost"}),t(H,{label:"填报人",prop:"requester_name"}),t(H,{align:"center",label:"审核状态"},{default:l(I=>[I.row.status==0?(s(),w(de,{key:0,type:"primary"},{default:l(()=>[x("待申请审核")]),_:1})):I.row.status==1?(s(),w(de,{key:1,type:"warning"},{default:l(()=>[x("待审核")]),_:1})):I.row.status==2?(s(),w(de,{key:2,type:"success"},{default:l(()=>[x("审核通过")]),_:1})):I.row.status==3?(s(),w(de,{key:3,type:"danger"},{default:l(()=>[x("审核驳回")]),_:1})):E("",!0)]),_:1}),t(H,{align:"center",label:"操作"},{default:l(I=>[t(ne,{size:"small"},{default:l(()=>[t(G,{size:"small",type:"primary",onClick:be=>S(I.row)},{default:l(()=>[x("详情")]),_:2},1032,["onClick"]),I.row.status==0?(s(),w(G,{key:0,size:"small",type:"warning",onClick:be=>q(I.row.id)},{default:l(()=>[x(" 提请审核 ")]),_:2},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(ge,{"current-page":d.curr_page,"onUpdate:currentPage":N[1]||(N[1]=I=>d.curr_page=I),"page-size":d.page_size,total:d.total,layout:"total, prev, pager, next",onCurrentChange:W},null,8,["current-page","page-size","total"])]),_:1}),t(se,{modelValue:m.value,"onUpdate:modelValue":N[2]||(N[2]=I=>m.value=I),size:"90%",title:"新增预算报表"},{default:l(()=>[t(ao)]),_:1},8,["modelValue"]),t(se,{modelValue:n.value,"onUpdate:modelValue":N[3]||(N[3]=I=>n.value=I),"destroy-on-close":"",direction:"rtl",size:"60%",title:"预算详情（只读）",onClosed:M},{default:l(()=>[t(pt,{aebp:$.value,awp:f.value,budget:o.value,job_resp:V.value,per_goal:r.value},null,8,["aebp","awp","budget","job_resp","per_goal"])]),_:1},8,["modelValue"])],64)}}}),yo={class:"d-flex flex-row w-100 h-100 m-0 p-0"},Vo={class:"d-flex flex-col justify-content-between p-right-10"},vo={class:"flex-grow-1"},ko=T({__name:"index",setup(i){const a=A(),b=L([{title:"预算审核情况",comp:ee(bo)},{title:"我的信息",comp:ee(ye)}]),d=O(0),o=V=>{d.value=V};return pe(()=>{for(let V of["expert_group","dept_list","user_list","eco_list","job_list","goal_list","aebp_list","awp_list"])new Promise(()=>{a.dispatch(V,{keyword:""})})}),(V,$)=>{const f=Ve("loading");return ve((s(),z("div",yo,[e("div",Vo,[t(ie,{content:r=>r.title,curr_change:o,data:b,"min-width":"10rem",width:"14rem"},null,8,["content","data"])]),e("div",vo,[(s(),w(me(b[d.value].comp)))])])),[[f,P(a).getters.loading]])}}});export{ko as default};
