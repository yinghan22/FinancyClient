import{C as Z,L as ue}from"./ListGroup-3147dc64.js";import{M as _e}from"./index-a72af481.js";import{d as I,o as r,e as C,g as e,c as v,w as l,h as $,q as P,b as t,F,f as J,m as N,u as L,k as p,C as de,t as S,a as D,r as T,i as B,j as M,l as ee,p as te,n as le,_ as ae,s as Y,v as me,x as ne,y as pe,z as fe}from"./index-b1074072.js";import{n as oe,F as se}from"./formatter-a19a4390.js";const ce={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},ge=e("p",null,"预算审核",-1),be={class:"d-flex flex-row-1"},ye={class:"flex-1"},Ve={colspan:"2"},ve={colspan:"2"},qe={colspan:"2"},we=I({__name:"DetailBudget",props:{data:Object},setup(s){const a=s,b=L();return(V,o)=>{const q=p("el-text"),x=p("el-input-number"),n=p("el-form-item"),u=p("el-option"),i=p("el-option-group"),y=p("el-select"),_=p("el-input"),U=p("el-form");return r(),C(F,null,[e("h3",ce,[ge,e("span",null,[a.data.status==0?(r(),v(q,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):a.data.status==1?(r(),v(q,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):a.data.status==2?(r(),v(q,{key:2,type:"success"},{default:l(()=>[$("审核已通过")]),_:1})):a.data.status==3?(r(),v(q,{key:3,type:"danger"},{default:l(()=>[$("审核已驳回")]),_:1})):P("",!0)])]),t(U,{modelValue:a.data,"onUpdate:modelValue":o[10]||(o[10]=f=>a.data=f),"label-position":"top"},{default:l(()=>[e("div",be,[e("table",ye,[e("tr",null,[e("td",null,[t(n,{label:"预算金额(元)"},{default:l(()=>[t(x,{modelValue:s.data.budget_price,"onUpdate:modelValue":o[0]||(o[0]=f=>s.data.budget_price=f),precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue","step"])]),_:1})]),e("td",null,[t(n,{label:"上年度本业务实际支出(元)"},{default:l(()=>[t(x,{modelValue:s.data.actual_cost,"onUpdate:modelValue":o[1]||(o[1]=f=>s.data.actual_cost=f),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right",readonly:""},null,8,["modelValue","step"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"经济分类"},{default:l(()=>[t(y,{modelValue:s.data.economy_id,"onUpdate:modelValue":o[2]||(o[2]=f=>s.data.economy_id=f),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,f=>(r(),v(i,{label:f.classify+" - "+f.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[f.classify],k=>(r(),v(u,{label:k.classify+k.kind+" - "+k.name,value:k.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"衔接业务单编码"},{default:l(()=>[t(y,{modelValue:s.data.aebp_id,"onUpdate:modelValue":o[3]||(o[3]=f=>s.data.aebp_id=f),disabled:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.aebp_list,f=>(r(),v(u,{label:f.code,value:f.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ve,[t(n,{label:"详细测算过程"},{default:l(()=>[t(_,{modelValue:s.data.detail,"onUpdate:modelValue":o[4]||(o[4]=f=>s.data.detail=f),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ve,[t(n,{label:"差异说明"},{default:l(()=>[t(_,{modelValue:s.data.diff_reason,"onUpdate:modelValue":o[5]||(o[5]=f=>s.data.diff_reason=f),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",qe,[t(n,{label:"备注"},{default:l(()=>[t(_,{modelValue:s.data.comm,"onUpdate:modelValue":o[6]||(o[6]=f=>s.data.comm=f),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(n,{label:"申请人"},{default:l(()=>[t(y,{modelValue:s.data.requester,"onUpdate:modelValue":o[7]||(o[7]=f=>s.data.requester=f),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,f=>(r(),v(u,{label:f.id+" - "+f.name,value:f.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"审核小组"},{default:l(()=>[t(y,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[8]||(o[8]=f=>a.data.applicant_id=f),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,f=>(r(),v(u,{label:f.tag,value:f.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])])]),a.data.status==3?(r(),v(n,{key:0,class:"flex-grow-1",label:"审核驳回原因"},{default:l(()=>[t(_,{modelValue:s.data.refuse_reason,"onUpdate:modelValue":o[9]||(o[9]=f=>s.data.refuse_reason=f),readonly:"",rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})):P("",!0)])])]),_:1},8,["modelValue"])],64)}}}),$e={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},xe=e("p",null,"衔接业务单审核",-1),ke={class:"d-flex flex-row-1"},Ue={class:"flex-1"},he={colspan:"2"},Ce={colspan:"2"},je={colspan:"2"},ze={colspan:"2"},Me={key:0},Oe=I({__name:"DetailAEBP",props:{data:Object},setup(s){const a=s,b=L();return(V,o)=>{const q=p("el-text"),x=p("el-input"),n=p("el-form-item"),u=p("el-date-picker"),i=p("el-option"),y=p("el-select"),_=p("el-option-group"),U=p("el-radio"),f=p("el-radio-group"),k=p("el-form");return r(),C(F,null,[e("h3",$e,[xe,e("span",null,[a.data.status==0?(r(),v(q,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):a.data.status==1?(r(),v(q,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):a.data.status==2?(r(),v(q,{key:2,type:"success"},{default:l(()=>[$("审核已通过")]),_:1})):a.data.status==3?(r(),v(q,{key:3,type:"danger"},{default:l(()=>[$("审核已驳回")]),_:1})):P("",!0)])]),t(k,{"label-position":"top"},{default:l(()=>[e("div",ke,[e("table",Ue,[e("tr",null,[e("td",null,[t(n,{label:"经济业务计划单编号"},{default:l(()=>[t(x,{modelValue:a.data.code,"onUpdate:modelValue":o[0]||(o[0]=c=>a.data.code=c),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"开展月份"},{default:l(()=>[t(u,{modelValue:a.data.start_date,"onUpdate:modelValue":o[1]||(o[1]=c=>a.data.start_date=c),readonly:"",type:"month"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"衔接计划编码"},{default:l(()=>[t(y,{modelValue:a.data.annual_work_plan_id,"onUpdate:modelValue":o[2]||(o[2]=c=>a.data.annual_work_plan_id=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.awp_list,c=>(r(),v(i,{label:c.code+" - "+c.name,value:c.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"经济类型"},{default:l(()=>[t(y,{modelValue:a.data.eco_class_id,"onUpdate:modelValue":o[3]||(o[3]=c=>a.data.eco_class_id=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,c=>(r(),v(_,{label:c.classify+" - "+c.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[c.classify],g=>(r(),v(i,{label:g.classify+g.kind+" - "+g.name,value:g.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",he,[t(n,{label:"业务经济内容"},{default:l(()=>[t(x,{modelValue:a.data.detail,"onUpdate:modelValue":o[4]||(o[4]=c=>a.data.detail=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ce,[t(n,{label:"产生支出内容"},{default:l(()=>[t(x,{modelValue:a.data.content,"onUpdate:modelValue":o[5]||(o[5]=c=>a.data.content=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",je,[t(n,{label:"上年度是否开展"},{default:l(()=>[t(f,{modelValue:a.data.carry_out,"onUpdate:modelValue":o[6]||(o[6]=c=>a.data.carry_out=c),disabled:""},{default:l(()=>[t(U,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(U,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ze,[t(n,{label:"备注"},{default:l(()=>[t(x,{modelValue:a.data.comm,"onUpdate:modelValue":o[7]||(o[7]=c=>a.data.comm=c),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(n,{label:"部门"},{default:l(()=>[t(y,{modelValue:a.data.dept_id,"onUpdate:modelValue":o[8]||(o[8]=c=>a.data.dept_id=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,c=>(r(),v(i,{label:c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"申请人"},{default:l(()=>[t(y,{modelValue:a.data.requester,"onUpdate:modelValue":o[9]||(o[9]=c=>a.data.requester=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,c=>(r(),v(i,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"审核小组"},{default:l(()=>[t(y,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[10]||(o[10]=c=>a.data.applicant_id=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,c=>(r(),v(i,{label:c.tag,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(r(),C("tr",Me,[e("td",null,[t(n,{label:"审核驳回原因"},{default:l(()=>[t(x,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":o[11]||(o[11]=c=>a.data.refuse_reason=c),readonly:"",rows:"10",type:"textarea"},null,8,["modelValue"])]),_:1})])])):P("",!0)])])])]),_:1})],64)}}}),Fe={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Se=e("p",null,"衔接年度工作计划审核",-1),Je={class:"d-flex w-100 flex-row"},Ne={class:"flex-1"},De={colspan:"2"},Be={colspan:"2"},Pe={colspan:"2"},Ee={key:0},Ie=I({__name:"DetailAWP",props:{data:Object},setup(s){const a=s,b=L();return(V,o)=>{const q=p("el-text"),x=p("el-input"),n=p("el-form-item"),u=p("el-radio"),i=p("el-radio-group"),y=p("el-option"),_=p("el-select"),U=p("el-form");return r(),C(F,null,[e("h3",Fe,[Se,e("span",null,[a.data.status==0?(r(),v(q,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):a.data.status==1?(r(),v(q,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):a.data.status==2?(r(),v(q,{key:2,type:"success"},{default:l(()=>[$("审核已通过")]),_:1})):a.data.status==3?(r(),v(q,{key:3,type:"danger"},{default:l(()=>[$("审核已驳回")]),_:1})):P("",!0)])]),t(U,{"label-position":"top"},{default:l(()=>[e("div",Je,[e("table",Ne,[e("tr",null,[e("td",null,[t(n,{label:"计划编码"},{default:l(()=>[t(x,{modelValue:a.data.code,"onUpdate:modelValue":o[0]||(o[0]=f=>a.data.code=f),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"计划名称"},{default:l(()=>[t(x,{modelValue:a.data.name,"onUpdate:modelValue":o[1]||(o[1]=f=>a.data.name=f),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",De,[t(n,{label:"计划详情"},{default:l(()=>[t(x,{modelValue:a.data.detail,"onUpdate:modelValue":o[2]||(o[2]=f=>a.data.detail=f),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"隶属工作职责编码"},{default:l(()=>[t(x,{modelValue:a.data.job_resp_id,"onUpdate:modelValue":o[3]||(o[3]=f=>a.data.job_resp_id=f),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"绩效编码"},{default:l(()=>[t(x,{modelValue:a.data.per_goal_id,"onUpdate:modelValue":o[4]||(o[4]=f=>a.data.per_goal_id=f),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Be,[t(n,{label:"上年度是否开展"},{default:l(()=>[t(i,{modelValue:a.data.carry_out,"onUpdate:modelValue":o[5]||(o[5]=f=>a.data.carry_out=f),disabled:""},{default:l(()=>[t(u,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(u,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Pe,[t(n,{label:"备注"},{default:l(()=>[t(x,{modelValue:a.data.comm,"onUpdate:modelValue":o[6]||(o[6]=f=>a.data.comm=f),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(n,{label:"部门"},{default:l(()=>[t(x,{modelValue:a.data.dept_name,"onUpdate:modelValue":o[7]||(o[7]=f=>a.data.dept_name=f),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"申请人"},{default:l(()=>[t(x,{modelValue:a.data.requester_name,"onUpdate:modelValue":o[8]||(o[8]=f=>a.data.requester_name=f),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"审核小组"},{default:l(()=>[t(_,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[9]||(o[9]=f=>a.data.applicant_id=f),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,f=>(r(),v(y,{label:f.tag,value:f.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(r(),C("tr",Ee,[e("td",null,[t(n,{label:"审核驳回原因",prop:"refuse_reason"},{default:l(()=>[t(x,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":o[10]||(o[10]=f=>a.data.refuse_reason=f),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):P("",!0)])])])]),_:1})],64)}}}),Te={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Le=e("p",null,"绩效指标审核",-1),Ae={class:"d-flex flex-row"},Ge={class:"flex-1"},Re={style:{margin:"0",padding:"0 1rem"}},We=["href"],He={key:0},Ke=I({__name:"DetailPerGoal",props:{data:Object},setup(s){const a=s,b=L();return(V,o)=>{const q=p("el-text"),x=p("el-input"),n=p("el-form-item"),u=p("el-option"),i=p("el-select"),y=p("el-form");return r(),C(F,null,[e("h3",Te,[Le,e("span",null,[a.data.status==0?(r(),v(q,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):a.data.status==1?(r(),v(q,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):a.data.status==2?(r(),v(q,{key:2,type:"success"},{default:l(()=>[$("审核已通过")]),_:1})):a.data.status==3?(r(),v(q,{key:3,type:"danger"},{default:l(()=>[$("审核已驳回")]),_:1})):P("",!0)])]),t(y,{"label-position":"top"},{default:l(()=>[e("div",Ae,[e("table",Ge,[e("tr",null,[e("td",null,[t(n,{label:"绩效指标编码"},{default:l(()=>[t(x,{modelValue:a.data.code,"onUpdate:modelValue":o[0]||(o[0]=_=>a.data.code=_),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"一级指标"},{default:l(()=>[t(x,{modelValue:a.data.quota_1,"onUpdate:modelValue":o[1]||(o[1]=_=>a.data.quota_1=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"二级指标"},{default:l(()=>[t(x,{modelValue:a.data.quota_2,"onUpdate:modelValue":o[2]||(o[2]=_=>a.data.quota_2=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"三级指标"},{default:l(()=>[t(x,{modelValue:a.data.quota_3,"onUpdate:modelValue":o[3]||(o[3]=_=>a.data.quota_3=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"指标值"},{default:l(()=>[t(x,{modelValue:a.data.quota_value,"onUpdate:modelValue":o[4]||(o[4]=_=>a.data.quota_value=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"指标来源"},{default:l(()=>[t(x,{modelValue:a.data.source,"onUpdate:modelValue":o[5]||(o[5]=_=>a.data.source=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"备注"},{default:l(()=>[t(x,{modelValue:a.data.comm,"onUpdate:modelValue":o[6]||(o[6]=_=>a.data.comm=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"附件"},{default:l(()=>[e("ol",Re,[(r(!0),C(F,null,J(a.data.file_list,_=>(r(),C("li",null,[e("a",{href:N(de).base_url+"/"+_.file_path,class:"file_href",style:{color:"#000"},target:"_blank"},S(_.file_name),9,We)]))),256))])]),_:1})])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(n,{label:"部门"},{default:l(()=>[t(i,{modelValue:a.data.dept_id,"onUpdate:modelValue":o[7]||(o[7]=_=>a.data.dept_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,_=>(r(),v(u,{label:_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"填报人"},{default:l(()=>[t(i,{modelValue:a.data.requester,"onUpdate:modelValue":o[8]||(o[8]=_=>a.data.requester=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,_=>(r(),v(u,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"审核小组"},{default:l(()=>[t(i,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[9]||(o[9]=_=>a.data.applicant_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,_=>(r(),v(u,{label:_.tag,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(r(),C("tr",He,[e("td",null,[t(n,{label:"审核驳回原因"},{default:l(()=>[t(x,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":o[10]||(o[10]=_=>a.data.refuse_reason=_),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):P("",!0)])])])]),_:1})],64)}}}),Qe={class:"border-bottom-1 d-flex flex-row justify-content-between align-items-center"},Xe=e("p",null,"工作职责审核",-1),Ye={style:{display:"flex","flex-direction":"column"}},Ze={style:{display:"flex","flex-direction":"row"}},et={class:"flex-1"},tt={style:{width:"100%"}},lt={colspan:"2"},at={colspan:"2"},ot={colspan:"2"},rt={key:0},ut=I({__name:"DetailJobResp",props:{data:Object},setup(s){const a=s,b=L();return(V,o)=>{const q=p("el-text"),x=p("el-input"),n=p("el-form-item"),u=p("el-option"),i=p("el-select"),y=p("el-form");return r(),C(F,null,[e("h3",Qe,[Xe,e("span",null,[a.data.status==0?(r(),v(q,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):a.data.status==1?(r(),v(q,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):a.data.status==2?(r(),v(q,{key:2,type:"success"},{default:l(()=>[$("审核已通过")]),_:1})):a.data.status==3?(r(),v(q,{key:3,type:"danger"},{default:l(()=>[$("审核已驳回")]),_:1})):P("",!0)])]),t(y,{"label-position":"top"},{default:l(()=>[e("div",Ye,[e("div",Ze,[e("div",et,[e("table",tt,[e("tr",null,[e("td",null,[t(n,{label:"职责编号"},{default:l(()=>[t(x,{modelValue:a.data.code,"onUpdate:modelValue":o[0]||(o[0]=_=>a.data.code=_),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",lt,[t(n,{label:"职责概述"},{default:l(()=>[t(x,{modelValue:a.data.abstract,"onUpdate:modelValue":o[1]||(o[1]=_=>a.data.abstract=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",at,[t(n,{label:"职责内容描述"},{default:l(()=>[t(x,{modelValue:a.data.detail,"onUpdate:modelValue":o[2]||(o[2]=_=>a.data.detail=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"经办人"},{default:l(()=>[t(i,{modelValue:a.data.operator_id,"onUpdate:modelValue":o[3]||(o[3]=_=>a.data.operator_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,_=>(r(),v(u,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(n,{label:"责任领导",prop:"leader_id"},{default:l(()=>[t(i,{modelValue:a.data.leader_id,"onUpdate:modelValue":o[4]||(o[4]=_=>a.data.leader_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,_=>(r(),v(u,{label:_.id+" - "+_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ot,[t(n,{label:"备注"},{default:l(()=>[t(x,{modelValue:a.data.comm,"onUpdate:modelValue":o[5]||(o[5]=_=>a.data.comm=_),modelModifiers:{trim:!0},readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(n,{label:"部门"},{default:l(()=>[t(i,{modelValue:a.data.dept_id,"onUpdate:modelValue":o[6]||(o[6]=_=>a.data.dept_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,_=>(r(),v(u,{label:_.name,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"填报人"},{default:l(()=>[t(x,{modelValue:a.data.requester,"onUpdate:modelValue":o[7]||(o[7]=_=>a.data.requester=_),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(n,{label:"审核小组"},{default:l(()=>[t(i,{modelValue:a.data.applicant_id,"onUpdate:modelValue":o[8]||(o[8]=_=>a.data.applicant_id=_),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,_=>(r(),v(u,{label:_.id+" - "+_.tag,value:_.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),a.data.status==3?(r(),C("tr",rt,[e("td",null,[t(n,{label:"审核驳回原因"},{default:l(()=>[t(x,{modelValue:a.data.refuse_reason,"onUpdate:modelValue":o[9]||(o[9]=_=>a.data.refuse_reason=_),readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1})])])):P("",!0)])])])])]),_:1})],64)}}}),dt=I({__name:"detail",props:{budget:Object,aebp:Object,awp:Object,job_resp:Object,per_goal:Object},setup(s){const a=s;return(b,V)=>(r(),C("div",null,[t(ut,{data:a.job_resp},null,8,["data"]),t(Ke,{data:a.per_goal},null,8,["data"]),t(Ie,{data:a.awp},null,8,["data"]),t(Oe,{data:a.aebp},null,8,["data"]),t(we,{data:a.budget},null,8,["data"])]))}}),nt={class:"w-100"},st={colspan:"2"},it={colspan:"2"},_t={colspan:"2"},mt={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},pt=I({__name:"JobResponseCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D(),o=T({dept_id:b.getters.userinfo.dept_id,requester:b.getters.userinfo.id,abstract:"",detail:"",operator_id:"",leader_id:"",comm:"",status:0,refuse_reason:""}),q=T({department_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],abstract:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],operator_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],leader_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],status:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}]});o.status;const x=n=>{n&&n.validate(u=>{if(u){b.commit("loading",!0);let i=new FormData;i.set("dept_id",o.dept_id),i.set("detail",o.detail),i.set("operator_id",o.operator_id),i.set("leader_id",o.leader_id),i.set("comm",o.comm),i.set("abstract",o.abstract),i.set("requester",o.requester),i.set("status",JSON.stringify(o.status)),B.post("/job",i).then(y=>{b.commit("loading",!1),y.data.status===200?a.success():M({type:"error",message:y.data.message})}).catch(y=>{b.commit("loading",!1),M({type:"error",message:y})})}})};return(n,u)=>{const i=p("el-option"),y=p("el-select"),_=p("el-form-item"),U=p("el-input"),f=p("el-button"),k=p("el-form");return r(),v(k,{ref_key:"form_ref",ref:V,model:o,rules:q,"label-position":"top","status-icon":""},{default:l(()=>[e("table",nt,[e("tr",null,[e("td",null,[t(_,{label:"申请人",prop:"requester",required:""},{default:l(()=>[t(y,{modelValue:o.requester,"onUpdate:modelValue":u[0]||(u[0]=c=>o.requester=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,c=>(r(),v(i,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(_,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(y,{modelValue:o.dept_id,"onUpdate:modelValue":u[1]||(u[1]=c=>o.dept_id=c),disabled:"",filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,c=>(r(),v(i,{label:c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",st,[t(_,{label:"职责概述",prop:"abstract",required:""},{default:l(()=>[t(U,{modelValue:o.abstract,"onUpdate:modelValue":u[2]||(u[2]=c=>o.abstract=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",it,[t(_,{label:"职责内容描述",prop:"detail",required:""},{default:l(()=>[t(U,{modelValue:o.detail,"onUpdate:modelValue":u[3]||(u[3]=c=>o.detail=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(_,{label:"经办人",prop:"operator_id",required:""},{default:l(()=>[t(y,{modelValue:o.operator_id,"onUpdate:modelValue":u[4]||(u[4]=c=>o.operator_id=c),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,c=>(r(),v(i,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(_,{label:"责任领导",prop:"leader_id",required:""},{default:l(()=>[t(y,{modelValue:o.leader_id,"onUpdate:modelValue":u[5]||(u[5]=c=>o.leader_id=c),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,c=>(r(),v(i,{label:c.id+" - "+c.name,value:c.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",_t,[t(_,{label:"备注"},{default:l(()=>[t(U,{modelValue:o.comm,"onUpdate:modelValue":u[6]||(u[6]=c=>o.comm=c),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(_,null,{default:l(()=>[e("div",mt,[t(f,{type:"primary",onClick:u[7]||(u[7]=c=>x(V.value))},{default:l(()=>[$("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),ft={style:{display:"flex","flex-direction":"column"}},ct={style:{display:"flex","flex-direction":"row"}},gt={style:{width:"100%"}},bt={colspan:"2"},yt={key:0},Vt={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},vt=I({__name:"JobResponseEditForm",props:{form:{type:Object,required:!0,default:{id:"",code:"",department_id:"",abstract:"",detail:"",operator_id:"",leader_id:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=a.form.status;let o=!1,q=!1;const x=y=>{V==0&&y==1?o=!0:V==1&&y!=0&&y!=1&&(q=!0)},n=D(),u=T({department_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],abstract:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],operator_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],leader_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],comm:[{required:!0,message:"该选项不得为空",trigger:"blur"}],status:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}],refuse_reason:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),i=y=>{y&&y.validate(_=>{if(_){b.commit("loading",!0);let U=new FormData;U.set("detail",a.form.detail),U.set("department_id",a.form.department_id),U.set("operator_id",a.form.operator_id),U.set("leader_id",a.form.leader_id),U.set("comm",a.form.comm),U.set("abstract",a.form.abstract),U.set("status",JSON.stringify(a.form.status)),U.set("requester",a.form.requester),U.set("applicant_id",a.form.applicant_id),U.set("refuse_reason",a.form.refuse_reason),o&&U.set("request_time",oe()),q&&U.set("approve_time",oe()),B.put(`/job/${a.form.id}`,U).then(f=>{b.commit("loading",!1),f.data.status===200?a.success():M({type:"error",message:f.data.message})}).catch(f=>{b.commit("loading",!1),M({type:"error",message:f})})}})};return(y,_)=>{const U=p("el-input"),f=p("el-form-item"),k=p("el-option"),c=p("el-select"),g=p("el-button"),d=p("el-form");return r(),v(d,{ref_key:"form_ref",ref:n,model:s.form,rules:u,"label-position":"top","label-width":"160px","status-icon":""},{default:l(()=>[e("div",ft,[e("div",ct,[e("div",null,[e("table",gt,[e("tr",null,[e("td",null,[t(f,{label:"职责编号",prop:"code"},{default:l(()=>[t(U,{modelValue:s.form.code,"onUpdate:modelValue":_[0]||(_[0]=m=>s.form.code=m),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(c,{modelValue:s.form.dept_id,"onUpdate:modelValue":_[1]||(_[1]=m=>s.form.dept_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,m=>(r(),v(k,{label:m.name,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"职责概述",prop:"abstract",required:""},{default:l(()=>[t(U,{modelValue:s.form.abstract,"onUpdate:modelValue":_[2]||(_[2]=m=>s.form.abstract=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"职责内容描述",prop:"detail",required:""},{default:l(()=>[t(U,{modelValue:s.form.detail,"onUpdate:modelValue":_[3]||(_[3]=m=>s.form.detail=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"经办人",prop:"operator_id",required:""},{default:l(()=>[t(c,{modelValue:s.form.operator_id,"onUpdate:modelValue":_[4]||(_[4]=m=>s.form.operator_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,m=>(r(),v(k,{label:m.id+" - "+m.name,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(f,{label:"责任领导",prop:"leader_id",required:""},{default:l(()=>[t(c,{modelValue:s.form.leader_id,"onUpdate:modelValue":_[5]||(_[5]=m=>s.form.leader_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.user_list,m=>(r(),v(k,{label:m.id+" - "+m.name,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",bt,[t(f,{label:"备注"},{default:l(()=>[t(U,{modelValue:s.form.comm,"onUpdate:modelValue":_[6]||(_[6]=m=>s.form.comm=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(f,{label:"填报人"},{default:l(()=>[t(U,{modelValue:s.form.requester,"onUpdate:modelValue":_[7]||(_[7]=m=>s.form.requester=m),readonly:""},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(f,{label:"审批小组",prop:"applicant_id",required:""},{default:l(()=>[t(c,{modelValue:s.form.applicant_id,"onUpdate:modelValue":_[8]||(_[8]=m=>s.form.applicant_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,m=>(r(),v(k,{label:m.id+" - "+m.tag,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[t(f,{label:"审批状态",prop:"status",required:""},{default:l(()=>[t(c,{modelValue:s.form.status,"onUpdate:modelValue":_[9]||(_[9]=m=>s.form.status=m),filterable:"",onChange:x},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.approve_status_list,(m,h)=>(r(),v(k,{label:m,value:h},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),s.form.status==3?(r(),C("tr",yt,[e("td",null,[t(f,{required:s.form.status==3,label:"审批驳回原因",prop:"refuse_reason"},{default:l(()=>[t(U,{modelValue:s.form.refuse_reason,"onUpdate:modelValue":_[10]||(_[10]=m=>s.form.refuse_reason=m),type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])])):P("",!0)])])])]),t(f,null,{default:l(()=>[e("div",Vt,[t(g,{type:"primary",onClick:_[11]||(_[11]=m=>i(n.value))},{default:l(()=>[$("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),X=s=>(te("data-v-9b40f57a"),s=s(),le(),s),qt={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},wt=X(()=>e("p",null,"工作职责",-1)),$t={class:"detail"},xt=X(()=>e("th",{style:{"vertical-align":"top"}},"职责内容",-1)),kt=X(()=>e("th",null,"备注",-1)),Ut=X(()=>e("th",null,"申请人",-1)),ht=X(()=>e("th",null,"审批小组",-1)),Ct=X(()=>e("th",null,"申请时间",-1)),jt=X(()=>e("th",null,"审批时间",-1)),zt={key:0},Mt=X(()=>e("th",null,"驳回原因",-1)),Ot={style:{position:"relative"}},Ft=I({__name:"index",setup(s){const a=L(),b=D([]),V=T({curr_page:1,total:10,page_size:14}),o=D(0),q=D(!1),x=D(!1),n=D([]);n.value.length==0&&B.get("/dept/-1").then(g=>{n.value=g.data.data});const u=g=>{i(g)};b.value.length===0&&i(1);function i(g){a.commit("loading",!0);const d=`/job/-1?reverse=1&current_page=${g}&page_size=${V.page_size}`;B.get(d,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(m=>{a.commit("loading",!1),m.data.status===200?(b.value=m.data.data,V.page_size=m.data.page_info.page_size,V.total=m.data.page_info.total):M({type:"error",message:m.data.message})}).catch(m=>{a.commit("loading",!1),M({type:"error",message:m})})}const y=()=>{x.value=!1,i(V.curr_page)},_=g=>{o.value=g,q.value=!0},U=g=>{ee.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(d=>{f(g)}).catch(d=>{M({type:"info",message:"操作已取消"})})};function f(g){const d="/job/"+b.value[g].id;B.delete(d).then(m=>{m.data.status===200?(M({type:"success",message:"删除成功"}),i(V.curr_page)):M({type:"error",message:`删除失败 ${m.data.message}`})}).catch(m=>{M({type:"error",message:m})})}const k=()=>{q.value=!1,i(V.curr_page)};function c(g){a.commit("loading",!0);let d=new FormData;d.set("status","1"),B.put(`/job/approve/${g}`,d).then(m=>{a.commit("loading",!1),m.data.status==200?(M.success("申请审核成功，请等待审核结果"),i(V.curr_page)):M.error(m.data.message)}).catch(m=>{a.commit("loading",!1),M.error(m)})}return(g,d)=>{const m=p("el-button"),h=p("el-button-group"),j=p("el-table-column"),O=p("el-text"),G=p("el-table"),A=p("el-pagination"),w=p("el-dialog");return r(),C(F,null,[t(Z,null,{header:l(()=>[e("div",qt,[wt,t(h,{size:"small"},{default:l(()=>[t(m,{type:"primary",onClick:d[0]||(d[0]=z=>x.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(G,{data:b.value,height:"100%"},{default:l(()=>[t(j,{fixed:"",type:"expand"},{default:l(z=>[e("table",$t,[e("tr",null,[xt,e("td",null,S(z.row.detail),1)]),e("tr",null,[kt,e("td",null,S(z.row.comm),1)]),e("tr",null,[Ut,e("td",null,S(z.row.requester_name),1)]),e("tr",null,[ht,e("td",null,S(z.row.applicant_tag),1)]),e("tr",null,[Ct,e("td",null,S(z.row.request_time),1)]),e("tr",null,[jt,e("td",null,S(z.row.approve_time),1)]),z.row.status==3?(r(),C("tr",zt,[Mt,e("td",null,S(z.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(j,{label:"职责编号",prop:"code"}),t(j,{label:"部门",prop:"dept_name"}),t(j,{label:"职责概述",prop:"abstract",width:"300"}),t(j,{label:"申请者",width:"130rem"},{default:l(z=>[$(S(z.row.requester)+" - "+S(z.row.requester_name),1)]),_:1}),t(j,{label:"经办人",prop:"operator_name"}),t(j,{label:"责任领导",prop:"leader_name"}),t(j,{align:"center",label:"审批状态"},{default:l(z=>[z.row.status==0?(r(),v(O,{key:0,type:"primary"},{default:l(()=>[$("待申请审批")]),_:1})):z.row.status==1?(r(),v(O,{key:1,type:"warning"},{default:l(()=>[$("待审批")]),_:1})):z.row.status==2?(r(),v(O,{key:2,type:"success"},{default:l(()=>[$("审批通过")]),_:1})):z.row.status==3?(r(),v(O,{key:3,type:"danger"},{default:l(()=>[$("审批驳回")]),_:1})):P("",!0)]),_:1}),t(j,{align:"center",label:"操作"},{default:l(z=>[t(h,{size:"small"},{default:l(()=>[z.row.status==0?(r(),v(m,{key:0,type:"warning",onClick:R=>c(z.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):P("",!0),t(m,{disabled:z.row.status!=0&&z.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:R=>_(z.$index)},{default:l(()=>[$("编辑 ")]),_:2},1032,["disabled","onClick"]),t(m,{disabled:z.row.status!=0,type:"danger",onClick:R=>U(z.$index)},{default:l(()=>[$(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(A,{"current-page":V.curr_page,"onUpdate:currentPage":d[1]||(d[1]=z=>V.curr_page=z),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:u},null,8,["current-page","page-size","total"])]),_:1}),e("div",Ot,[t(w,{modelValue:x.value,"onUpdate:modelValue":d[2]||(d[2]=z=>x.value=z),"destroy-on-close":"",title:"新增",width:"50%"},{default:l(()=>[t(pt,{success:y})]),_:1},8,["modelValue"]),t(w,{modelValue:q.value,"onUpdate:modelValue":d[3]||(d[3]=z=>q.value=z),closed:i(V.curr_page),"destroy-on-close":"",title:"编辑"},{default:l(()=>[t(vt,{form:b.value[o.value],success:k},null,8,["form"])]),_:1},8,["modelValue","closed"])])],64)}}});const St=ae(Ft,[["__scopeId","data-v-9b40f57a"]]),Jt={style:{width:"100%"}},Nt={style:{width:"50%"}},Dt={style:{width:"50%"}},Bt={style:{width:"50%"}},Pt={style:{width:"50%"}},Et={style:{width:"50%"}},It={style:{width:"50%"}},Tt={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Lt=I({__name:"PerGoalCreateForm",props:{dept_list:Object,user_list:Array,success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D([]);V.value.length===0&&B.get("/user/-1").then(i=>{V.value=i.data.data});const o=D(),q=T({dept_id:b.getters.userinfo.dept_id,quota_1:"",quota_2:"",quota_3:"",quota_value:"",source:"",comm:"",file_list:[],status:0,requester:b.getters.userinfo.id}),x=(i,y)=>{i.name in q.file_list?M({type:"error",message:"文件名已存在"}):q.file_list.push(i.raw)},n=T({dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_1:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_2:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_3:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_value:[{required:!0,message:"该选项不得为空",trigger:"blur"}],source:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),u=i=>{i&&i.validate(y=>{if(y){b.commit("loading",!0);let _=new FormData;{_.set("dept_id",q.dept_id),_.set("quota_1",q.quota_1),_.set("quota_2",q.quota_2),_.set("quota_3",q.quota_3),_.set("quota_value",q.quota_value),_.set("source",q.source),_.set("comm",q.comm),_.set("requester",q.requester),_.set("status",JSON.stringify(q.status));for(let U of q.file_list)_.append("file_list",U)}B.post("/goal",_).then(U=>{b.commit("loading",!1),U.data.status===200?a.success():M({type:"error",message:U.data.message})}).catch(U=>{b.commit("loading",!1),M({type:"error",message:U})})}})};return(i,y)=>{const _=p("el-option"),U=p("el-select"),f=p("el-form-item"),k=p("el-input"),c=p("el-button"),g=p("el-upload"),d=p("el-form");return r(),v(d,{ref_key:"form_ref",ref:o,model:q,rules:n,"label-position":"top","label-width":"80px","status-icon":""},{default:l(()=>[e("table",Jt,[e("tr",null,[e("td",Nt,[t(f,{label:"填报人",prop:"requester",required:""},{default:l(()=>[t(U,{modelValue:q.requester,"onUpdate:modelValue":y[0]||(y[0]=m=>q.requester=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(V.value,m=>(r(),v(_,{label:m.id+" - "+m.name,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",Dt,[t(f,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(U,{modelValue:q.dept_id,"onUpdate:modelValue":y[1]||(y[1]=m=>q.dept_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,m=>(r(),v(_,{label:m.name,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Bt,[t(f,{label:"一级指标",prop:"quota_1",required:""},{default:l(()=>[t(k,{modelValue:q.quota_1,"onUpdate:modelValue":y[2]||(y[2]=m=>q.quota_1=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",Pt,[t(f,{label:"二级指标",prop:"quota_2",required:""},{default:l(()=>[t(k,{modelValue:q.quota_2,"onUpdate:modelValue":y[3]||(y[3]=m=>q.quota_2=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Et,[t(f,{label:"三级指标",prop:"quota_3",required:""},{default:l(()=>[t(k,{modelValue:q.quota_3,"onUpdate:modelValue":y[4]||(y[4]=m=>q.quota_3=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",It,[t(f,{label:"指标值",prop:"quota_value",required:""},{default:l(()=>[t(k,{modelValue:q.quota_value,"onUpdate:modelValue":y[5]||(y[5]=m=>q.quota_value=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(f,{label:"指标来源",prop:"source",required:""},{default:l(()=>[t(k,{modelValue:q.source,"onUpdate:modelValue":y[6]||(y[6]=m=>q.source=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(f,{label:"备注"},{default:l(()=>[t(k,{modelValue:q.comm,"onUpdate:modelValue":y[7]||(y[7]=m=>q.comm=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(f,{label:"附件"},{default:l(()=>[t(g,{"file-list":q.file_list,"onUpdate:fileList":y[8]||(y[8]=m=>q.file_list=m),multiple:"",onChange:x},{default:l(()=>[t(c,{type:"primary"},{default:l(()=>[$("上传附件")]),_:1})]),_:1},8,["file-list"])]),_:1}),t(f,null,{default:l(()=>[e("div",Tt,[t(c,{type:"primary",onClick:y[9]||(y[9]=m=>u(o.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),At={style:{display:"flex","flex-direction":"column"}},Gt={style:{display:"flex","flex-direction":"row"}},Rt={style:{width:"100%"}},Wt={style:{width:"50%"}},Ht={style:{width:"50%"}},Kt={style:{width:"50%"}},Qt={style:{width:"50%"}},Xt={style:{width:"50%"}},Yt={style:{width:"50%"}},Zt={key:0},el={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},tl=I({__name:"PerGoalEditForm",props:{form:{type:Object,required:!0,default:{dept_id:"",quota_1:"",quota_2:"",quota_3:"",quota_value:"",source:"",comm:"",file_list:[],status:null,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D([]);V.value.length===0&&B.get("/user/-1").then(U=>{V.value=U.data.data});const o=D(),q=T({dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_1:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_2:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_3:[{required:!0,message:"该选项不得为空",trigger:"blur"}],quota_value:[{required:!0,message:"该选项不得为空",trigger:"blur"}],source:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),x=(U,f)=>{U.name in a.form.file_list?M({type:"error",message:"文件名已存在"}):a.form.file_list.push(U.raw)},n=a.form.status;let u=!1,i=null;const y=U=>{n===0&&U===1?u=!0:n===1&&U!==0&&U!==1&&(i=!0)},_=U=>{U.validate(f=>{if(f){b.commit("loading",!0);let k=new FormData;{k.set("dept_id",a.form.dept_id),k.set("quota_1",a.form.quota_1),k.set("quota_2",a.form.quota_2),k.set("quota_3",a.form.quota_3),k.set("quota_value",a.form.quota_value),k.set("source",a.form.source),k.set("comm",a.form.comm),k.set("status",a.form.status),k.set("requester",a.form.requester),k.set("applicant_id",a.form.applicant_id),k.set("refuse_reason",a.form.refuse_reason),u&&k.set("request_time",oe()),i&&k.set("approve_time",oe());for(let c of a.form.file_list)k.append("file_list",c)}B.put(`/goal/${a.form.id}`,k).then(c=>{b.commit("loading",!1),c.data.status===200?a.success():M({type:"error",message:c.data.message})}).catch(c=>{b.commit("loading",!1),M({type:"error",message:c})})}})};return(U,f)=>{const k=p("el-option"),c=p("el-select"),g=p("el-form-item"),d=p("el-input"),m=p("el-button"),h=p("el-upload"),j=p("el-form");return r(),v(j,{ref_key:"form_ref",ref:o,model:s.form,rules:q,"label-position":"top","label-width":"80px","status-icon":""},{default:l(()=>[e("div",At,[e("div",Gt,[e("div",null,[e("table",Rt,[e("tr",null,[e("td",Wt,[t(g,{label:"填报人",prop:"requester",required:""},{default:l(()=>[t(c,{modelValue:s.form.requester,"onUpdate:modelValue":f[0]||(f[0]=O=>s.form.requester=O),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(V.value,O=>(r(),v(k,{label:O.id+" - "+O.name,value:O.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",Ht,[t(g,{label:"部门",prop:"dept_id",required:""},{default:l(()=>[t(c,{modelValue:s.form.dept_id,"onUpdate:modelValue":f[1]||(f[1]=O=>s.form.dept_id=O),filterable:"",required:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.dept_list,O=>(r(),v(k,{label:O.name,value:O.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Kt,[t(g,{label:"一级指标",required:""},{default:l(()=>[t(d,{modelValue:s.form.quota_1,"onUpdate:modelValue":f[2]||(f[2]=O=>s.form.quota_1=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",Qt,[t(g,{label:"二级指标",required:""},{default:l(()=>[t(d,{modelValue:s.form.quota_2,"onUpdate:modelValue":f[3]||(f[3]=O=>s.form.quota_2=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Xt,[t(g,{label:"三级指标",required:""},{default:l(()=>[t(d,{modelValue:s.form.quota_3,"onUpdate:modelValue":f[4]||(f[4]=O=>s.form.quota_3=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})]),e("td",Yt,[t(g,{label:"指标值",required:""},{default:l(()=>[t(d,{modelValue:s.form.quota_value,"onUpdate:modelValue":f[5]||(f[5]=O=>s.form.quota_value=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(g,{label:"指标来源",required:""},{default:l(()=>[t(d,{modelValue:s.form.source,"onUpdate:modelValue":f[6]||(f[6]=O=>s.form.source=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(g,{label:"备注"},{default:l(()=>[t(d,{modelValue:s.form.comm,"onUpdate:modelValue":f[7]||(f[7]=O=>s.form.comm=O),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1}),t(g,{label:"附件"},{default:l(()=>[t(h,{"file-list":s.form.file_list,"onUpdate:fileList":f[8]||(f[8]=O=>s.form.file_list=O),multiple:"",onChange:x},{default:l(()=>[t(m,{type:"primary"},{default:l(()=>[$("上传附件")]),_:1})]),_:1},8,["file-list"])]),_:1})]),e("div",null,[e("table",null,[e("tr",null,[e("td",null,[t(g,{label:"审批小组",required:""},{default:l(()=>[t(c,{modelValue:s.form.applicant_id,"onUpdate:modelValue":f[9]||(f[9]=O=>s.form.applicant_id=O),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.expert_group,O=>(r(),v(k,{label:O.tag,value:O.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[t(g,{label:"审批状态",required:""},{default:l(()=>[t(c,{modelValue:s.form.status,"onUpdate:modelValue":f[10]||(f[10]=O=>s.form.status=O),filterable:"",onChange:y},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.approve_status_list,(O,G)=>(r(),v(k,{label:O,value:G},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),s.form.status==3?(r(),C("tr",Zt,[e("td",null,[t(g,{label:"审批驳回原因",required:""},{default:l(()=>[t(d,{modelValue:s.form.refuse_reason,"onUpdate:modelValue":f[11]||(f[11]=O=>s.form.refuse_reason=O),type:"textarea"},null,8,["modelValue"])]),_:1})])])):P("",!0)])])]),e("div",null,[t(g,null,{default:l(()=>[e("div",el,[t(m,{type:"primary",onClick:f[12]||(f[12]=O=>_(o.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})])])]),_:1},8,["model","rules"])}}}),W=s=>(te("data-v-0278f870"),s=s(),le(),s),ll={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},al=W(()=>e("p",null,"绩效指标",-1)),ol={class:"detail"},rl=W(()=>e("th",null,"附件",-1)),ul={style:{margin:"0",padding:"0 1rem"}},dl=["href"],nl=W(()=>e("th",null,"指标来源",-1)),sl=W(()=>e("th",null,"备注",-1)),il=W(()=>e("th",null,"申请人",-1)),_l=W(()=>e("th",null,"审批小组",-1)),ml=W(()=>e("th",null,"申请时间",-1)),pl=W(()=>e("th",null,"审批时间",-1)),fl={key:0},cl=W(()=>e("th",null,"驳回原因",-1)),gl=I({__name:"index",setup(s){D({0:"待申请",1:"待审批",2:"审批通过",3:"审批驳回"});const a=L(),b=D([]),V=T({curr_page:1,total:10,page_size:10}),o=D(0),q=D(!1),x=D([]);x.value.length===0&&B.get("/user/-1").then(g=>{x.value=g.data.data});const n=D(!1),u=g=>{i(g)};b.value.length===0&&i(1);function i(g){a.commit("loading",!0);const d=`/goal/-1?reverse=1&current_page=${g}&page_size=${V.page_size}`;B.get(d,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(m=>{a.commit("loading",!1),m.data.status===200?(b.value=m.data.data,V.page_size=m.data.page_info.page_size,V.total=m.data.page_info.total):M({type:"error",message:m.data.message})}).catch(m=>{a.commit("loading",!1),M({type:"error",message:m})})}const y=()=>{n.value=!1,i(V.curr_page)},_=g=>{o.value=g,q.value=!0},U=g=>{ee.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(d=>{f(g)}).catch(d=>{M({type:"info",message:"操作已取消"})})};function f(g){const d="/goal/"+b.value[g].id;B.delete(d).then(m=>{m.data.status===200?(M({type:"success",message:"删除成功"}),i(V.curr_page)):M({type:"error",message:`删除失败 ${m.data.message}`})}).catch(m=>{M({type:"error",message:m})})}const k=()=>{q.value=!1,i(V.curr_page)};function c(g){a.commit("loading",!0);let d=new FormData;d.set("status","1"),B.put(`/goal/approve/${g}`,d).then(m=>{a.commit("loading",!1),m.data.status==200?(M.success("申请审核成功，请等待审核结果"),i(V.curr_page)):M.error(m.data.message)}).catch(m=>{a.commit("loading",!1),M.error(m)})}return(g,d)=>{const m=p("el-button"),h=p("el-button-group"),j=p("el-table-column"),O=p("el-text"),G=p("el-table"),A=p("el-pagination"),w=p("el-dialog");return r(),C(F,null,[t(Z,null,{header:l(()=>[e("div",ll,[al,t(h,{size:"small"},{default:l(()=>[t(m,{type:"primary",onClick:d[0]||(d[0]=z=>n.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(G,{data:b.value,height:"100%"},{default:l(()=>[t(j,{fixed:"",type:"expand"},{default:l(z=>[e("table",ol,[e("tr",null,[rl,e("td",null,[e("ol",ul,[(r(!0),C(F,null,J(z.row.file_list,R=>(r(),C("li",null,[e("a",{href:N(de).base_url+"/"+R.file_path,class:"file_href",style:{color:"#000"},target:"_blank"},S(R.file_name),9,dl)]))),256))])])]),e("tr",null,[nl,e("td",null,S(z.row.source),1)]),e("tr",null,[sl,e("td",null,S(z.row.comm),1)]),e("tr",null,[il,e("td",null,S(z.row.requester_name),1)]),e("tr",null,[_l,e("td",null,S(z.row.applicant_tag),1)]),e("tr",null,[ml,e("td",null,S(z.row.request_time),1)]),e("tr",null,[pl,e("td",null,S(z.row.approve_time),1)]),z.row.status==3?(r(),C("tr",fl,[cl,e("td",null,S(z.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(j,{label:"绩效编码",prop:"code",width:"130rem"}),t(j,{label:"一级指标",prop:"quota_1"}),t(j,{label:"二级指标",prop:"quota_2"}),t(j,{label:"三级指标",prop:"quota_3"}),t(j,{label:"指标值",prop:"quota_value"}),t(j,{label:"申请者",width:"130rem"},{default:l(z=>[$(S(z.row.requester)+" - "+S(z.row.requester_name),1)]),_:1}),t(j,{align:"center",label:"审批状态"},{default:l(z=>[z.row.status==0?(r(),v(O,{key:0,type:"primary"},{default:l(()=>[$("待申请审批")]),_:1})):z.row.status==1?(r(),v(O,{key:1,type:"warning"},{default:l(()=>[$("待审批")]),_:1})):z.row.status==2?(r(),v(O,{key:2,type:"success"},{default:l(()=>[$("审批通过")]),_:1})):z.row.status==3?(r(),v(O,{key:3,type:"danger"},{default:l(()=>[$("审批驳回")]),_:1})):P("",!0)]),_:1}),t(j,{align:"center",label:"操作"},{default:l(z=>[t(h,{size:"small"},{default:l(()=>[z.row.status==0?(r(),v(m,{key:0,type:"warning",onClick:R=>c(z.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):P("",!0),t(m,{disabled:z.row.status!=0&&z.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:R=>_(z.$index)},{default:l(()=>[$("编辑 ")]),_:2},1032,["disabled","onClick"]),t(m,{disabled:z.row.status!=0,type:"danger",onClick:R=>U(z.$index)},{default:l(()=>[$(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(A,{"current-page":V.curr_page,"onUpdate:currentPage":d[1]||(d[1]=z=>V.curr_page=z),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:u},null,8,["current-page","page-size","total"])]),_:1}),t(w,{modelValue:n.value,"onUpdate:modelValue":d[2]||(d[2]=z=>n.value=z),"destroy-on-close":"",title:"新增"},{default:l(()=>[t(Lt,{success:y,width:"90%"})]),_:1},8,["modelValue"]),t(w,{modelValue:q.value,"onUpdate:modelValue":d[3]||(d[3]=z=>q.value=z),closed:i(V.curr_page),"destroy-on-close":"",title:"编辑"},{default:l(()=>[t(tl,{form:b.value[o.value],success:k},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const bl=ae(gl,[["__scopeId","data-v-0278f870"]]),yl={class:"w-100"},Vl={colspan:"2"},vl={colspan:"2"},ql={colspan:"2"},wl={colspan:"2"},$l={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},xl=I({__name:"AnnualWorkPlanCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D(),o=T({name:"",detail:"",job_resp_id:"",per_goal_id:"",carry_out:"",comm:"",dept_id:b.getters.userinfo.dept_id,status:0,requester:b.getters.userinfo.id});o.status;const q=T({name:[{required:!0,message:"该选项不得为空",trigger:"blur"}],detail:[{required:!0,message:"该选项不得为空",trigger:"blur"}],job_resp_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],per_goal_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],carry_out:[{required:!0,message:"该选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"该选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"该选项不得为空",trigger:"blur"}]}),x=n=>{n&&n.validate(u=>{if(u){b.commit("loading",!0);let i=new FormData;i.set("detail",o.detail),i.set("name",o.name),i.set("job_resp_id",o.job_resp_id),i.set("per_goal_id",o.per_goal_id),i.set("carry_out",o.carry_out),i.set("comm",o.comm),i.set("dept_id",o.dept_id),i.set("status",JSON.stringify(o.status)),i.set("requester",o.requester),B.post("/awp",i).then(y=>{b.commit("loading",!1),y.data.status===200?(M({type:"success",message:"新增成功"}),a.success()):M({type:"error",message:y.data.message})}).catch(y=>{b.commit("loading",!1),M({type:"error",message:y})})}})};return(n,u)=>{const i=p("el-input"),y=p("el-form-item"),_=p("el-option"),U=p("el-select"),f=p("el-radio"),k=p("el-radio-group"),c=p("el-button"),g=p("el-form");return r(),v(g,{ref_key:"form_ref",ref:V,model:o,rules:q,"label-position":"top","status-icon":""},{default:l(()=>[e("table",yl,[e("tr",null,[e("td",Vl,[t(y,{label:"计划名称",prop:"name",required:""},{default:l(()=>[t(i,{modelValue:o.name,"onUpdate:modelValue":u[0]||(u[0]=d=>o.name=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",vl,[t(y,{label:"计划详情",prop:"detail",required:""},{default:l(()=>[t(i,{modelValue:o.detail,"onUpdate:modelValue":u[1]||(u[1]=d=>o.detail=d),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{label:"隶属工作职责编码",prop:"job_resp_id",required:""},{default:l(()=>[t(U,{modelValue:o.job_resp_id,"onUpdate:modelValue":u[2]||(u[2]=d=>o.job_resp_id=d),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.job_list,d=>(r(),v(_,{label:d.code,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"绩效编码",prop:"per_goal_id",required:""},{default:l(()=>[t(U,{modelValue:o.per_goal_id,"onUpdate:modelValue":u[3]||(u[3]=d=>o.per_goal_id=d),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.goal_list,d=>(r(),v(_,{label:d.code,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ql,[t(y,{label:"上年度是否开展",prop:"carry_out",required:""},{default:l(()=>[t(k,{modelValue:o.carry_out,"onUpdate:modelValue":u[4]||(u[4]=d=>o.carry_out=d)},{default:l(()=>[t(f,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(f,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",wl,[t(y,{label:"备注"},{default:l(()=>[t(i,{modelValue:o.comm,"onUpdate:modelValue":u[5]||(u[5]=d=>o.comm=d),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(y,null,{default:l(()=>[e("div",$l,[t(c,{type:"primary",onClick:u[6]||(u[6]=d=>x(V.value))},{default:l(()=>[$("确认 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),kl={class:"w-100"},Ul={colspan:"2"},hl={colspan:"2"},Cl={colspan:"2"},jl={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},zl=I({__name:"AnnualWorkPlanEditForm",props:{form:{type:Object,required:!0,default:{name:"",code:"",detail:"",job_resp_id:"",per_goal_id:"",carry_out:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L();a.form.status;const V=D(),o=T({name:[{required:!0,message:"请输入计划名称",trigger:"blur"}]}),q=x=>{x.validate(n=>{if(n){b.commit("loading",!0);let u=new FormData;u.set("name",a.form.name),u.set("detail",a.form.detail),u.set("job_resp_id",a.form.job_resp_id),u.set("per_goal_id",a.form.per_goal_id),u.set("carry_out",a.form.carry_out),u.set("comm",a.form.comm),u.set("status",JSON.stringify(a.form.status)),u.set("requester",a.form.requester),u.set("refuse_reason",a.form.refuse_reason),B.put(`/awp/${a.form.code}`,u).then(i=>{b.commit("loading",!1),i.data.status===200?(M({type:"success",message:"修改成功"}),a.success()):M({type:"error",message:i.data.message})}).catch(i=>{b.commit("loading",!1),M({type:"error",message:i})})}})};return(x,n)=>{const u=p("el-input"),i=p("el-form-item"),y=p("el-radio"),_=p("el-radio-group"),U=p("el-button"),f=p("el-form");return r(),v(f,{ref_key:"form_ref",ref:V,model:s.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("table",kl,[e("tr",null,[e("td",null,[t(i,{label:" 计划编码",prop:"code",required:""},{default:l(()=>[t(u,{modelValue:s.form.code,"onUpdate:modelValue":n[0]||(n[0]=k=>s.form.code=k),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(i,{label:"计划名称"},{default:l(()=>[t(u,{modelValue:s.form.name,"onUpdate:modelValue":n[1]||(n[1]=k=>s.form.name=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Ul,[t(i,{label:"计划详情"},{default:l(()=>[t(u,{modelValue:s.form.detail,"onUpdate:modelValue":n[2]||(n[2]=k=>s.form.detail=k),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(i,{label:"隶属工作职责编码"},{default:l(()=>[t(u,{modelValue:s.form.job_resp_id,"onUpdate:modelValue":n[3]||(n[3]=k=>s.form.job_resp_id=k)},null,8,["modelValue"])]),_:1})]),e("td",null,[t(i,{label:"绩效编码"},{default:l(()=>[t(u,{modelValue:s.form.per_goal_id,"onUpdate:modelValue":n[4]||(n[4]=k=>s.form.per_goal_id=k)},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",hl,[t(i,{label:"上年度是否开展"},{default:l(()=>[t(_,{modelValue:s.form.carry_out,"onUpdate:modelValue":n[5]||(n[5]=k=>s.form.carry_out=k)},{default:l(()=>[t(y,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(y,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Cl,[t(i,{label:"备注"},{default:l(()=>[t(u,{modelValue:s.form.comm,"onUpdate:modelValue":n[6]||(n[6]=k=>s.form.comm=k),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(i,null,{default:l(()=>[e("div",jl,[t(U,{type:"primary",onClick:n[7]||(n[7]=k=>q(V.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),H=s=>(te("data-v-16cf8a6c"),s=s(),le(),s),Ml={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},Ol=H(()=>e("p",null,"年度工作计划",-1)),Fl={class:"detail"},Sl=H(()=>e("th",null,"计划详情",-1)),Jl=H(()=>e("th",null,"备注",-1)),Nl=H(()=>e("th",null,"工作职责概述",-1)),Dl=H(()=>e("th",null,"申请人",-1)),Bl=H(()=>e("th",null,"审批小组",-1)),Pl=H(()=>e("th",null,"申请时间",-1)),El=H(()=>e("th",null,"审批时间",-1)),Il={key:0},Tl=H(()=>e("th",null,"驳回原因",-1)),Ll=I({__name:"index",setup(s){const a=L(),b=D([]),V=T({curr_page:1,total:10,page_size:14}),o=D(0),q=D(!1),x=D(!1),n=c=>{u(c)};b.value.length===0&&u(1);function u(c){a.commit("loading",!0);const g=`/awp/-1?reverse=1&current_page=${c}&page_size=${V.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(d=>{a.commit("loading",!1),d.data.status===200?(b.value=d.data.data,V.page_size=d.data.page_info.page_size,V.total=d.data.page_info.total):M({type:"error",message:d.data.message})}).catch(d=>{a.commit("loading",!1),M({type:"error",message:d})})}const i=()=>{x.value=!1,u(V.curr_page)},y=c=>{o.value=c,q.value=!0},_=c=>{ee.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{U(c)}).catch(g=>{M({type:"info",message:"操作已取消"})})};function U(c){const g="/awp/"+b.value[c].id;B.delete(g).then(d=>{d.data.status===200?(M({type:"success",message:"删除成功"}),u(V.curr_page)):M({type:"error",message:`删除失败 ${d.data.message}`})}).catch(d=>{M({type:"error",message:d})})}const f=()=>{q.value=!1,u(V.curr_page)};function k(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/awp/approve/${c}`,g).then(d=>{a.commit("loading",!1),d.data.status==200?(M.success("申请审核成功，请等待审核结果"),u(V.curr_page)):M.error(d.data.message)}).catch(d=>{a.commit("loading",!1),M.error(d)})}return(c,g)=>{const d=p("el-button"),m=p("el-button-group"),h=p("el-table-column"),j=p("el-text"),O=p("el-table"),G=p("el-pagination"),A=p("el-dialog");return r(),C(F,null,[t(Z,null,{header:l(()=>[e("div",Ml,[Ol,t(m,{size:"small"},{default:l(()=>[t(d,{type:"primary",onClick:g[0]||(g[0]=w=>x.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(O,{data:b.value,height:"100%"},{default:l(()=>[t(h,{fixed:"",type:"expand"},{default:l(w=>[e("table",Fl,[e("tr",null,[Sl,e("td",null,S(w.row.detail),1)]),e("tr",null,[Jl,e("td",null,S(w.row.comm),1)]),e("tr",null,[Nl,e("td",null,S(w.row.job_resp_abst),1)]),e("tr",null,[Dl,e("td",null,S(w.row.requester_name),1)]),e("tr",null,[Bl,e("td",null,S(w.row.applicant_tag),1)]),e("tr",null,[Pl,e("td",null,S(w.row.request_time),1)]),e("tr",null,[El,e("td",null,S(w.row.approve_time),1)]),w.row.status==3?(r(),C("tr",Il,[Tl,e("td",null,S(w.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(h,{label:"计划编码",prop:"code"}),t(h,{label:"计划名称",prop:"name"}),t(h,{label:"上年度是否开展"},{default:l(w=>[w.row.carry_out?(r(),v(j,{key:0,type:"success"},{default:l(()=>[$("已开展")]),_:1})):(r(),v(j,{key:1,type:"danger"},{default:l(()=>[$("未开展")]),_:1}))]),_:1}),t(h,{align:"center",label:"审批状态"},{default:l(w=>[w.row.status==0?(r(),v(j,{key:0,type:"primary"},{default:l(()=>[$("待申请审批")]),_:1})):w.row.status==1?(r(),v(j,{key:1,type:"warning"},{default:l(()=>[$("待审批")]),_:1})):w.row.status==2?(r(),v(j,{key:2,type:"success"},{default:l(()=>[$("审批通过")]),_:1})):w.row.status==3?(r(),v(j,{key:3,type:"danger"},{default:l(()=>[$("审批驳回")]),_:1})):P("",!0)]),_:1}),t(h,{align:"center",label:"操作"},{default:l(w=>[t(m,{size:"small"},{default:l(()=>[w.row.status==0?(r(),v(d,{key:0,type:"warning",onClick:z=>k(w.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):P("",!0),t(d,{disabled:w.row.status!=0&&w.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:z=>y(w.$index)},{default:l(()=>[$("编辑 ")]),_:2},1032,["disabled","onClick"]),t(d,{disabled:w.row.status!=0,type:"danger",onClick:z=>_(w.$index)},{default:l(()=>[$(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(G,{"current-page":V.curr_page,"onUpdate:currentPage":g[1]||(g[1]=w=>V.curr_page=w),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:n},null,8,["current-page","page-size","total"])]),_:1}),t(A,{modelValue:x.value,"onUpdate:modelValue":g[2]||(g[2]=w=>x.value=w),closed:u(V.curr_page),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(xl,{success:i})]),_:1},8,["modelValue","closed"]),t(A,{modelValue:q.value,"onUpdate:modelValue":g[3]||(g[3]=w=>q.value=w),closed:u(V.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(zl,{form:b.value[o.value],success:f},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const Al=ae(Ll,[["__scopeId","data-v-16cf8a6c"]]),Gl={class:"w-100"},Rl={colspan:"2"},Wl={colspan:"2"},Hl={colspan:"2"},Kl={colspan:"2"},Ql={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Xl=I({__name:"AnnualEconomicBusinessPlanCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D(),o=T({detail:"",start_date:"",content:"",eco_class_id:"",annual_work_plan_id:"",carry_out:"",comm:"",dept_id:b.getters.userinfo.dept_id,status:0,requester:b.getters.userinfo.id}),q=T({detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],start_date:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],content:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],annual_work_plan_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],eco_class_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]});o.status;const x=n=>{n&&n.validate(u=>{if(u){let i=new FormData;i.set("detail",o.detail),i.set("start_date",se.format_date(o.start_date)),i.set("content",o.content),i.set("eco_class_id",o.eco_class_id),i.set("annual_work_plan_id",o.annual_work_plan_id),i.set("carry_out",o.carry_out),i.set("comm",o.comm),i.set("dept_id",o.dept_id),i.set("status",JSON.stringify(o.status)),i.set("requester",o.requester),B.post("/aebp",i).then(y=>{y.data.status===200?a.success():M({type:"error",message:y.data.message})}).catch(y=>{M({type:"error",message:y})})}})};return(n,u)=>{const i=p("el-date-picker"),y=p("el-form-item"),_=p("el-option"),U=p("el-select"),f=p("el-option-group"),k=p("el-input"),c=p("el-radio"),g=p("el-radio-group"),d=p("el-button"),m=p("el-form");return r(),v(m,{ref_key:"form_ref",ref:V,model:o,rules:q,"label-position":"top","status-icon":""},{default:l(()=>[e("table",Gl,[e("tr",null,[e("td",null,[t(y,{label:"开展月份",required:""},{default:l(()=>[t(i,{modelValue:o.start_date,"onUpdate:modelValue":u[0]||(u[0]=h=>o.start_date=h),type:"month"},null,8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"衔接计划编码",required:""},{default:l(()=>[t(U,{modelValue:o.annual_work_plan_id,"onUpdate:modelValue":u[1]||(u[1]=h=>o.annual_work_plan_id=h),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.awp_list,h=>(r(),v(_,{label:h.code+" - "+h.name,value:h.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{label:"经济分类",required:""},{default:l(()=>[t(U,{modelValue:o.eco_class_id,"onUpdate:modelValue":u[2]||(u[2]=h=>o.eco_class_id=h),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,h=>(r(),v(f,{label:h.classify+" - "+h.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[h.classify],j=>(r(),v(_,{label:j.classify+j.kind+" - "+j.name,value:j.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Rl,[t(y,{label:"业务经济内容",required:""},{default:l(()=>[t(k,{modelValue:o.detail,"onUpdate:modelValue":u[3]||(u[3]=h=>o.detail=h),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Wl,[t(y,{label:"产生支出内容",required:""},{default:l(()=>[t(k,{modelValue:o.content,"onUpdate:modelValue":u[4]||(u[4]=h=>o.content=h),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Hl,[t(y,{label:"上年度是否开展",required:""},{default:l(()=>[t(g,{modelValue:o.carry_out,"onUpdate:modelValue":u[5]||(u[5]=h=>o.carry_out=h)},{default:l(()=>[t(c,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(c,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",Kl,[t(y,{label:"备注"},{default:l(()=>[t(k,{modelValue:o.comm,"onUpdate:modelValue":u[6]||(u[6]=h=>o.comm=h),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(y,null,{default:l(()=>[e("div",Ql,[t(d,{type:"primary",onClick:u[7]||(u[7]=h=>x(V.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Yl={class:"w-100"},Zl={style:{width:"50%"}},ea={colspan:"2"},ta={colspan:"2"},la={colspan:"2"},aa={colspan:"2"},oa={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},ra=I({__name:"AnnualEconomicBusinessPlanEditForm",props:{form:{type:Object,required:!0,default:{code:"",detail:"",start_date:"",content:"",eco_class_id:"",annual_work_plan_id:"",carry_out:"",comm:"",dept_id:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D(),o=T({detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],start_date:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],content:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],annual_work_plan_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],eco_class_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],dept_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]});a.form.status;const q=x=>{x&&x.validate(n=>{if(n){let u=new FormData;u.set("detail",a.form.detail),u.set("start_date",se.format_date(a.form.start_date)),u.set("content",a.form.content),u.set("eco_class_id",a.form.eco_class_id),u.set("annual_work_plan_id",a.form.annual_work_plan_id),u.set("carry_out",a.form.carry_out),u.set("comm",a.form.comm),u.set("dept_id",a.form.dept_id),u.set("status",JSON.stringify(a.form.status)),u.set("requester",a.form.requester),u.set("applicant_id",a.form.applicant_id),u.set("refuse_reason",a.form.refuse_reason),B.put(`/aebp/${a.form.code}`,u).then(i=>{i.data.status===200?a.success():M({type:"error",message:i.data.message})}).catch(i=>{M({type:"error",message:i})})}})};return(x,n)=>{const u=p("el-input"),i=p("el-form-item"),y=p("el-date-picker"),_=p("el-option"),U=p("el-select"),f=p("el-option-group"),k=p("el-radio"),c=p("el-radio-group"),g=p("el-button"),d=p("el-form");return r(),v(d,{ref_key:"form_ref",ref:V,model:s.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("table",Yl,[e("tr",null,[e("td",Zl,[t(i,{label:"经济业务计划单编号"},{default:l(()=>[t(u,{modelValue:a.form.code,"onUpdate:modelValue":n[0]||(n[0]=m=>a.form.code=m),readonly:""},null,8,["modelValue"])]),_:1})]),e("td",null,[t(i,{label:"开展月份",required:""},{default:l(()=>[t(y,{modelValue:a.form.start_date,"onUpdate:modelValue":n[1]||(n[1]=m=>a.form.start_date=m),type:"month"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",null,[t(i,{label:"衔接计划编码",required:""},{default:l(()=>[t(U,{modelValue:a.form.annual_work_plan_id,"onUpdate:modelValue":n[2]||(n[2]=m=>a.form.annual_work_plan_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.awp_list,m=>(r(),v(_,{label:m.code+" - "+m.name,value:m.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(i,{label:"经济类型",required:""},{default:l(()=>[t(U,{modelValue:a.form.eco_class_id,"onUpdate:modelValue":n[3]||(n[3]=m=>a.form.eco_class_id=m),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,m=>(r(),v(f,{label:m.classify+" - "+m.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[m.classify],h=>(r(),v(_,{label:h.classify+h.kind+" - "+h.name,value:h.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ea,[t(i,{label:"业务经济内容",required:""},{default:l(()=>[t(u,{modelValue:a.form.detail,"onUpdate:modelValue":n[4]||(n[4]=m=>a.form.detail=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ta,[t(i,{label:"产生支出内容",required:""},{default:l(()=>[t(u,{modelValue:a.form.content,"onUpdate:modelValue":n[5]||(n[5]=m=>a.form.content=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",la,[t(i,{label:"上年度是否开展",required:""},{default:l(()=>[t(c,{modelValue:a.form.carry_out,"onUpdate:modelValue":n[6]||(n[6]=m=>a.form.carry_out=m)},{default:l(()=>[t(k,{label:!0},{default:l(()=>[$("已开展")]),_:1}),t(k,{label:!1},{default:l(()=>[$("未开展")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",aa,[t(i,{label:"备注"},{default:l(()=>[t(u,{modelValue:a.form.comm,"onUpdate:modelValue":n[7]||(n[7]=m=>a.form.comm=m),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])]),t(i,null,{default:l(()=>[e("div",oa,[t(g,{type:"primary",onClick:n[8]||(n[8]=m=>q(V.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),K=s=>(te("data-v-cd5a7a73"),s=s(),le(),s),ua={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},da=K(()=>e("p",null,"年度经济业务计划单",-1)),na={class:"detail"},sa=K(()=>e("th",null,"业务经济内容",-1)),ia=K(()=>e("th",null,"支出内容",-1)),_a=K(()=>e("th",null,"备注",-1)),ma=K(()=>e("th",null,"申请人",-1)),pa=K(()=>e("th",null,"审批小组",-1)),fa=K(()=>e("th",null,"申请时间",-1)),ca=K(()=>e("th",null,"审批时间",-1)),ga={key:0},ba=K(()=>e("th",null,"驳回原因",-1)),ya=I({__name:"index",setup(s){const a=L(),b=D([]),V=T({curr_page:1,total:10,page_size:14}),o=D(0),q=D(!1),x=D(!1),n=c=>{u(c)};b.value.length===0&&u(1);function u(c){a.commit("loading",!0);const g=`/aebp/-1?reverse=1&current_page=${c}&page_size=${V.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(d=>{a.commit("loading",!1),d.data.status===200?(b.value=d.data.data,V.page_size=d.data.page_info.page_size,V.total=d.data.page_info.total):M({type:"error",message:d.data.message})}).catch(d=>{a.commit("loading",!1),M({type:"error",message:d})})}const i=()=>{x.value=!1,u(V.curr_page)},y=c=>{o.value=c,q.value=!0},_=c=>{ee.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{U(c)}).catch(g=>{M({type:"info",message:"操作已取消"})})};function U(c){a.commit("loading",!0);const g="/aebp/"+b.value[c].id;B.delete(g).then(d=>{a.commit("loading",!1),d.data.status===200?(M({type:"success",message:"删除成功"}),u(V.curr_page)):M({type:"error",message:`删除失败 ${d.data.message}`})}).catch(d=>{a.commit("loading",!1),M({type:"error",message:d})})}const f=()=>{q.value=!1,u(V.curr_page)};function k(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/aebp/approve/${c}`,g).then(d=>{a.commit("loading",!1),d.data.status==200?(M.success("申请审核成功，请等待审核结果"),u(V.curr_page)):M.error(d.data.message)}).catch(d=>{a.commit("loading",!1),M.error(d)})}return(c,g)=>{const d=p("el-button"),m=p("el-button-group"),h=p("el-table-column"),j=p("el-text"),O=p("el-table"),G=p("el-pagination"),A=p("el-dialog");return r(),C(F,null,[t(Z,null,{header:l(()=>[e("div",ua,[da,t(m,{size:"small"},{default:l(()=>[t(d,{type:"primary",onClick:g[0]||(g[0]=w=>x.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(O,{data:b.value},{default:l(()=>[t(h,{fixed:"",type:"expand"},{default:l(w=>[e("table",na,[e("tr",null,[sa,e("td",null,S(w.row.detail),1)]),e("tr",null,[ia,e("td",null,S(w.row.content),1)]),e("tr",null,[_a,e("td",null,S(w.row.comm),1)]),e("tr",null,[ma,e("td",null,S(w.row.requester_name),1)]),e("tr",null,[pa,e("td",null,S(w.row.applicant_tag),1)]),e("tr",null,[fa,e("td",null,S(w.row.request_time),1)]),e("tr",null,[ca,e("td",null,S(w.row.approve_time),1)]),w.row.status==3?(r(),C("tr",ga,[ba,e("td",null,S(w.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(h,{label:"业务单编码",prop:"code"}),t(h,{label:"开展月份",prop:"start_date"}),t(h,{label:"计划编码",prop:"annual_work_plan_id"}),t(h,{label:"经济类型",prop:"eco_class_name"}),t(h,{label:"上年度是否开展"},{default:l(w=>[w.row.carry_out?(r(),v(j,{key:0,type:"success"},{default:l(()=>[$("已开展")]),_:1})):(r(),v(j,{key:1,type:"danger"},{default:l(()=>[$("未开展")]),_:1}))]),_:1}),t(h,{align:"center",label:"审批状态"},{default:l(w=>[w.row.status==0?(r(),v(j,{key:0,type:"primary"},{default:l(()=>[$("待申请审批")]),_:1})):w.row.status==1?(r(),v(j,{key:1,type:"warning"},{default:l(()=>[$("待审批")]),_:1})):w.row.status==2?(r(),v(j,{key:2,type:"success"},{default:l(()=>[$("审批通过")]),_:1})):w.row.status==3?(r(),v(j,{key:3,type:"danger"},{default:l(()=>[$("审批驳回")]),_:1})):P("",!0)]),_:1}),t(h,{align:"center",label:"操作"},{default:l(w=>[t(m,{size:"small"},{default:l(()=>[w.row.status==0?(r(),v(d,{key:0,type:"warning",onClick:z=>k(w.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):P("",!0),t(d,{disabled:w.row.status!=0&&w.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:z=>y(w.$index)},{default:l(()=>[$("编辑 ")]),_:2},1032,["disabled","onClick"]),t(d,{disabled:w.row.status!=0,type:"danger",onClick:z=>_(w.$index)},{default:l(()=>[$(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(G,{"current-page":V.curr_page,"onUpdate:currentPage":g[1]||(g[1]=w=>V.curr_page=w),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:n},null,8,["current-page","page-size","total"])]),_:1}),t(A,{modelValue:x.value,"onUpdate:modelValue":g[2]||(g[2]=w=>x.value=w),closed:u(V.curr_page),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(Xl,{success:i})]),_:1},8,["modelValue","closed"]),t(A,{modelValue:q.value,"onUpdate:modelValue":g[3]||(g[3]=w=>q.value=w),closed:u(V.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(ra,{form:b.value[o.value],success:f},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const Va=ae(ya,[["__scopeId","data-v-cd5a7a73"]]),va={class:"d-flex flex-row-1"},qa={class:"flex-1"},wa={colspan:"2"},$a={colspan:"2"},xa={colspan:"2"},ka={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Ua=I({__name:"BudgetCreateForm",props:{success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L(),V=D(),o=T({economy_id:"",detail:"",budget_price:0,actual_cost:0,diff_reason:"",aebp_id:"",comm:"",status:0,requester:b.getters.userinfo.id});o.status;const q=T({economy_id:[{required:!0,message:"请输入经济分类名称",trigger:"blur"}],detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],actual_cost:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],diff_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],aebp_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]}),x=n=>{n&&n.validate(u=>{if(u){b.commit("loading",!0);let i=new FormData;i.set("economy_id",o.economy_id),i.set("detail",o.detail),i.set("budget_price",JSON.stringify(o.budget_price)),i.set("aebp_id",o.aebp_id),i.set("actual_cost",JSON.stringify(o.actual_cost)),i.set("diff_reason",o.diff_reason),i.set("comm",o.comm),i.set("status",JSON.stringify(o.status)),i.set("requester",o.requester),B.post("/budget",i).then(y=>{b.commit("loading",!1),y.data.status===200?(M({type:"success",message:"新增成功"}),a.success()):M({type:"error",message:y.data.message})}).catch(y=>{b.commit("loading",!1),M({type:"error",message:y})})}})};return(n,u)=>{const i=p("el-input-number"),y=p("el-form-item"),_=p("el-option"),U=p("el-option-group"),f=p("el-select"),k=p("el-input"),c=p("el-button"),g=p("el-form");return r(),v(g,{ref_key:"form_ref",ref:V,model:o,rules:q,"label-position":"top","status-icon":""},{default:l(()=>[e("div",va,[e("table",qa,[e("tr",null,[e("td",null,[t(y,{label:"预算金额(元)",required:""},{default:l(()=>[t(i,{modelValue:o.budget_price,"onUpdate:modelValue":u[0]||(u[0]=d=>o.budget_price=d),precision:2,step:.01,"controls-position":"right"},null,8,["modelValue","step"])]),_:1})]),e("td",null,[t(y,{label:"上年度本业务实际支出(元)",required:""},{default:l(()=>[t(i,{modelValue:o.actual_cost,"onUpdate:modelValue":u[1]||(u[1]=d=>o.actual_cost=d),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right"},null,8,["modelValue","step"])]),_:1})])]),e("tr",null,[e("td",null,[t(y,{label:"经济分类",required:""},{default:l(()=>[t(f,{modelValue:o.economy_id,"onUpdate:modelValue":u[2]||(u[2]=d=>o.economy_id=d),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,d=>(r(),v(U,{label:d.classify+" - "+d.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[d.classify],m=>(r(),v(_,{label:m.classify+m.kind+" - "+m.name,value:m.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(y,{label:"衔接业务单编码",required:""},{default:l(()=>[t(f,{modelValue:o.aebp_id,"onUpdate:modelValue":u[3]||(u[3]=d=>o.aebp_id=d)},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.aebp_list,d=>(r(),v(_,{label:d.code,value:d.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",wa,[t(y,{label:"详细测算过程",required:""},{default:l(()=>[t(k,{modelValue:o.detail,"onUpdate:modelValue":u[4]||(u[4]=d=>o.detail=d),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",$a,[t(y,{required:o.actual_cost!=o.budget_price&&o.actual_cost!=0,label:"差异说明"},{default:l(()=>[t(k,{modelValue:o.diff_reason,"onUpdate:modelValue":u[5]||(u[5]=d=>o.diff_reason=d),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])]),e("tr",null,[e("td",xa,[t(y,{label:"备注"},{default:l(()=>[t(k,{modelValue:o.comm,"onUpdate:modelValue":u[6]||(u[6]=d=>o.comm=d),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),t(y,null,{default:l(()=>[e("div",ka,[t(c,{type:"primary",onClick:u[7]||(u[7]=d=>x(V.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),ha={class:"d-flex flex-row-1"},Ca={class:"flex-1"},ja={colspan:"2"},za={colspan:"2"},Ma={colspan:"2"},Oa={style:{width:"100%",height:"100%",display:"flex","justify-content":"flex-end"}},Fa=I({__name:"BudgetEditForm",props:{form:{type:Object,required:!0,default:{economy_id:"",detail:"",budget_price:0,aebp_id:"",actual_cost:0,diff_reason:"",comm:"",status:0,requester:"",applicant_id:"",refuse_reason:""}},success:{type:Function,required:!0,default:()=>{}}},setup(s){const a=s,b=L();a.form.status;const V=D(),o=T({economy_id:[{required:!0,message:"请输入经济分类名称",trigger:"blur"}],detail:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],actual_cost:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],diff_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],aebp_id:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],status:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],requester:[{required:!0,message:"当前选项不得为空",trigger:"blur"}],refuse_reason:[{required:!0,message:"当前选项不得为空",trigger:"blur"}]}),q=x=>{x.validate(n=>{if(n){b.commit("loading",!0);let u=new FormData;u.set("economy_id",a.form.economy_id),u.set("detail",a.form.detail),u.set("budget_price",JSON.stringify(a.form.budget_price)),u.set("aebp_id",a.form.aebp_id),u.set("actual_cost",JSON.stringify(a.form.actual_cost)),u.set("diff_reason",a.form.diff_reason),u.set("comm",a.form.comm),u.set("status",JSON.stringify(a.form.status)),u.set("requester",a.form.requester),u.set("refuse_reason",a.form.refuse_reason),B.put(`/budget/${a.form.id}`,u).then(i=>{b.commit("loading",!1),i.data.status===200?a.success():M({type:"error",message:i.data.message})}).catch(i=>{b.commit("loading",!1),M({type:"error",message:i})})}})};return(x,n)=>{const u=p("el-input-number"),i=p("el-form-item"),y=p("el-option"),_=p("el-option-group"),U=p("el-select"),f=p("el-input"),k=p("el-button"),c=p("el-form");return r(),v(c,{ref_key:"form_ref",ref:V,model:s.form,rules:o,"label-position":"top","status-icon":""},{default:l(()=>[e("div",ha,[e("table",Ca,[e("tr",null,[e("td",null,[t(i,{label:"预算金额(元)",required:""},{default:l(()=>[t(u,{modelValue:s.form.budget_price,"onUpdate:modelValue":n[0]||(n[0]=g=>s.form.budget_price=g),precision:2,step:.01,"controls-position":"right"},null,8,["modelValue","step"])]),_:1})]),e("td",null,[t(i,{label:"上年度本业务实际支出(元)",required:""},{default:l(()=>[t(u,{modelValue:s.form.actual_cost,"onUpdate:modelValue":n[1]||(n[1]=g=>s.form.actual_cost=g),modelModifiers:{trim:!0},precision:2,step:.01,"controls-position":"right"},null,8,["modelValue","step"])]),_:1})])]),e("tr",null,[e("td",null,[t(i,{label:"经济分类",required:""},{default:l(()=>[t(U,{modelValue:s.form.economy_id,"onUpdate:modelValue":n[2]||(n[2]=g=>s.form.economy_id=g),filterable:""},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_class_list,g=>(r(),v(_,{label:g.classify+" - "+g.name},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.eco_kind_list[g.classify],d=>(r(),v(y,{label:d.classify+d.kind+" - "+d.name,value:d.id},null,8,["label","value"]))),256))]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),e("td",null,[t(i,{label:"衔接业务单编码",required:""},{default:l(()=>[t(U,{modelValue:s.form.aebp_id,"onUpdate:modelValue":n[3]||(n[3]=g=>s.form.aebp_id=g)},{default:l(()=>[(r(!0),C(F,null,J(N(b).getters.aebp_list,g=>(r(),v(y,{label:g.code,value:g.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",ja,[t(i,{label:"详细测算过程",required:""},{default:l(()=>[t(f,{modelValue:s.form.detail,"onUpdate:modelValue":n[4]||(n[4]=g=>s.form.detail=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])]),e("tr",null,[e("td",za,[t(i,{required:s.form.actual_cost!=s.form.budget_price&&s.form.actual_cost!=0,label:"差异说明"},{default:l(()=>[t(f,{modelValue:s.form.diff_reason,"onUpdate:modelValue":n[5]||(n[5]=g=>s.form.diff_reason=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1},8,["required"])])]),e("tr",null,[e("td",Ma,[t(i,{label:"备注"},{default:l(()=>[t(f,{modelValue:s.form.comm,"onUpdate:modelValue":n[6]||(n[6]=g=>s.form.comm=g),modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue"])]),_:1})])])])]),t(i,null,{default:l(()=>[e("div",Oa,[t(k,{type:"primary",onClick:n[7]||(n[7]=g=>q(V.value))},{default:l(()=>[$("确认")]),_:1})])]),_:1})]),_:1},8,["model","rules"])}}}),Q=s=>(te("data-v-9b37deb8"),s=s(),le(),s),Sa={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},Ja=Q(()=>e("p",null,"公用经费预算",-1)),Na={class:"detail"},Da=Q(()=>e("th",null,"差异说明",-1)),Ba=Q(()=>e("th",null,"备注",-1)),Pa=Q(()=>e("th",null,"详细测算过程",-1)),Ea=Q(()=>e("th",null,"申请人",-1)),Ia=Q(()=>e("th",null,"审批小组",-1)),Ta=Q(()=>e("th",null,"申请时间",-1)),La=Q(()=>e("th",null,"审批时间",-1)),Aa={key:0},Ga=Q(()=>e("th",null,"驳回原因",-1)),Ra=I({__name:"index",setup(s){const a=L(),b=D([]),V=T({curr_page:1,total:10,page_size:14}),o=D(0),q=D(!1),x=D(!1),n=c=>{u(c)};b.value.length===0&&u(1);function u(c){const g=`/budget/-1?reverse=1&current_page=${c}&page_size=${V.page_size}`;B.get(g,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(d=>{d.data.status===200?(b.value=d.data.data,V.page_size=d.data.page_info.page_size,V.total=d.data.page_info.total):M({type:"error",message:d.data.message})}).catch(d=>{M({type:"error",message:d})})}const i=()=>{x.value=!1,u(V.curr_page)},y=c=>{o.value=c,q.value=!0},_=c=>{ee.confirm("是否确认删除？","危险操作",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(g=>{U(c)}).catch(g=>{M({type:"info",message:"操作已取消"})})};function U(c){a.commit("loading",!0);const g="/budget/"+b.value[c].id;B.delete(g).then(d=>{a.commit("loading",!1),d.data.status===200?(M({type:"success",message:"删除成功"}),u(V.curr_page)):M({type:"error",message:`删除失败 ${d.data.message}`})}).catch(d=>{a.commit("loading",!1),M({type:"error",message:d})})}const f=()=>{q.value=!1,u(V.curr_page)};function k(c){a.commit("loading",!0);let g=new FormData;g.set("status","1"),B.put(`/budget/approve/${c}`,g).then(d=>{a.commit("loading",!1),d.data.status==200?(M.success("申请审核成功，请等待审核结果"),u(V.curr_page)):M.error(d.data.message)}).catch(d=>{a.commit("loading",!1),M.error(d)})}return(c,g)=>{const d=p("el-button"),m=p("el-button-group"),h=p("el-table-column"),j=p("el-text"),O=p("el-table"),G=p("el-pagination"),A=p("el-dialog");return r(),C(F,null,[t(Z,null,{header:l(()=>[e("div",Sa,[Ja,t(m,{size:"small"},{default:l(()=>[t(d,{type:"primary",onClick:g[0]||(g[0]=w=>x.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(O,{data:b.value,height:"100%"},{default:l(()=>[t(h,{fixed:"",type:"expand"},{default:l(w=>[e("table",Na,[e("tr",null,[Da,e("td",null,S(w.row.diff_reason),1)]),e("tr",null,[Ba,e("td",null,S(w.row.comm),1)]),e("tr",null,[Pa,e("td",null,S(w.row.detail),1)]),e("tr",null,[Ea,e("td",null,S(w.row.requester_name),1)]),e("tr",null,[Ia,e("td",null,S(w.row.applicant_tag),1)]),e("tr",null,[Ta,e("td",null,S(w.row.request_time),1)]),e("tr",null,[La,e("td",null,S(w.row.approve_time),1)]),w.row.status==3?(r(),C("tr",Aa,[Ga,e("td",null,S(w.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(h,{label:"编号",prop:"id"}),t(h,{label:"经济类型",prop:"eco_name"}),t(h,{label:"预算金额(元)",prop:"budget_price"}),t(h,{label:"衔接业务单编码",prop:"aebp_id"}),t(h,{label:"上年度本业务实际支出(元)",prop:"actual_cost"}),t(h,{label:"填报人",prop:"requester_name"}),t(h,{align:"center",label:"审批状态"},{default:l(w=>[w.row.status==0?(r(),v(j,{key:0,type:"primary"},{default:l(()=>[$("待申请审批")]),_:1})):w.row.status==1?(r(),v(j,{key:1,type:"warning"},{default:l(()=>[$("待审批")]),_:1})):w.row.status==2?(r(),v(j,{key:2,type:"success"},{default:l(()=>[$("审批通过")]),_:1})):w.row.status==3?(r(),v(j,{key:3,type:"danger"},{default:l(()=>[$("审批驳回")]),_:1})):P("",!0)]),_:1}),t(h,{align:"center",label:"操作"},{default:l(w=>[t(m,{size:"small"},{default:l(()=>[w.row.status==0?(r(),v(d,{key:0,type:"warning",onClick:z=>k(w.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):P("",!0),t(d,{disabled:w.row.status!=0&&w.row.status!=3,title:"待审批禁止编辑",type:"primary",onClick:z=>y(w.$index)},{default:l(()=>[$("编辑 ")]),_:2},1032,["disabled","onClick"]),t(d,{disabled:w.row.status!=0,type:"danger",onClick:z=>_(w.$index)},{default:l(()=>[$(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(G,{"current-page":V.curr_page,"onUpdate:currentPage":g[1]||(g[1]=w=>V.curr_page=w),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:n},null,8,["current-page","page-size","total"])]),_:1}),t(A,{modelValue:x.value,"onUpdate:modelValue":g[2]||(g[2]=w=>x.value=w),"destroy-on-close":"",title:"新增",width:"60%"},{default:l(()=>[t(Ua,{success:i})]),_:1},8,["modelValue"]),t(A,{modelValue:q.value,"onUpdate:modelValue":g[3]||(g[3]=w=>q.value=w),closed:u(V.curr_page),"destroy-on-close":"",title:"编辑",width:"60%"},{default:l(()=>[t(Fa,{form:b.value[o.value],success:f},null,8,["form"])]),_:1},8,["modelValue","closed"])],64)}}});const Wa=ae(Ra,[["__scopeId","data-v-9b37deb8"]]),Ha={class:"d-flex flex-row h-100 m-0 p-0"},Ka={class:"d-flex flex-col justify-content-between p-right-10"},Qa={class:"flex-1"},Xa=I({__name:"index",setup(s){const a=L(),b=T([{label:"工作职责",comp:Y(St)},{label:"年度绩效目标",comp:Y(bl)},{label:"年度工作计划",comp:Y(Al)},{label:"年度经济业务计划单",comp:Y(Va)},{label:"公用经费预算",comp:Y(Wa)}]),V=D(b[0].comp),o=x=>{V.value=b[x].comp};me(()=>{q()});function q(){a.dispatch("expert_group"),a.dispatch("dept_list"),a.dispatch("user_list"),a.dispatch("eco_list"),a.dispatch("job_list"),a.dispatch("goal_list"),a.dispatch("aebp_list"),a.dispatch("awp_list")}return D(!1),(x,n)=>(r(),C("div",Ha,[e("div",Ka,[t(ue,{content:u=>u.label,curr_change:o,data:b,"min-width":"9rem",width:"9rem"},null,8,["content","data"])]),e("div",Qa,[(r(),v(ne(V.value)))])]))}}),Ya={style:{display:"flex","justify-content":"space-between","align-content":"center","align-items":"center"}},Za=e("p",null,"公用经费预算",-1),eo={class:"detail"},to=e("th",null,"差异说明",-1),lo=e("th",null,"备注",-1),ao=e("th",null,"详细测算过程",-1),oo=e("th",null,"申请人",-1),ro=e("th",null,"审核小组",-1),uo=e("th",null,"申请时间",-1),no=e("th",null,"审核时间",-1),so={key:0},io=e("th",null,"驳回原因",-1),_o=I({__name:"index",setup(s){const a=L(),b=D([]),V=T({curr_page:1,page_size:10,total:1}),o=D({}),q=D({}),x=D({}),n=D({}),u=D({}),i=D(!1),y=D(!1);async function _(h){let j=await B.get(`/job/${h}`);j.data.status===200&&(q.value=j.data.data[0])}async function U(h){let j=await B.get(`/goal/${h}`);j.data.status===200&&(u.value=j.data.data[0])}async function f(h){let j=await B.get(`/awp/${h}`);j.data.status===200&&(n.value=j.data.data[0],await U(n.value.per_goal_id),await _(n.value.job_resp_id))}async function k(h){let j=await B.get(`/aebp/${h}`);j.data.status===200&&(x.value=j.data.data[0],await f(x.value.annual_work_plan_id))}const c=async h=>{a.commit("loading",!0),o.value=h,await k(h.aebp_id),a.commit("loading",!1),y.value=!0};b.value.length===0&&d(1);const g=h=>{d(h)};function d(h){a.commit("loading",!0),B.get(`/budget/-1?reverse=1&page_size=${V.page_size}&current_page=${h}`,{params:{select_by:JSON.stringify(["requester"]),select:JSON.stringify({requester:[a.getters.userinfo.id]})}}).then(j=>{a.commit("loading",!1),j.data.status===200?(b.value=j.data.data,V.page_size=j.data.page_info.page_size,V.total=j.data.page_info.total):M({type:"error",message:j.data.message})}).catch(j=>{a.commit("loading",!1),M({type:"error",message:j})})}function m(h){a.commit("loading",!0);let j=new FormData;j.set("status","1"),B.put(`/budget/approve/${h}`,j).then(O=>{a.commit("loading",!1),O.data.status==200?(M.success("申请审核成功，请等待审核结果"),d(V.curr_page)):M.error(O.data.message)}).catch(O=>{a.commit("loading",!1),M.error(O)})}return(h,j)=>{const O=p("el-button"),G=p("el-button-group"),A=p("el-table-column"),w=p("el-text"),z=p("el-table"),R=p("el-pagination"),re=p("el-drawer");return r(),C(F,null,[t(Z,{class:"w-100"},{header:l(()=>[e("div",Ya,[Za,t(G,{size:"small"},{default:l(()=>[t(O,{type:"primary",onClick:j[0]||(j[0]=E=>i.value=!0)},{default:l(()=>[$("新增")]),_:1})]),_:1})])]),content:l(()=>[t(z,{data:b.value,height:"100%"},{default:l(()=>[t(A,{fixed:"",type:"expand"},{default:l(E=>[e("table",eo,[e("tr",null,[to,e("td",null,S(E.row.diff_reason),1)]),e("tr",null,[lo,e("td",null,S(E.row.comm),1)]),e("tr",null,[ao,e("td",null,S(E.row.detail),1)]),e("tr",null,[oo,e("td",null,S(E.row.requester_name),1)]),e("tr",null,[ro,e("td",null,S(E.row.applicant_tag),1)]),e("tr",null,[uo,e("td",null,S(E.row.request_time),1)]),e("tr",null,[no,e("td",null,S(E.row.approve_time),1)]),E.row.status==3?(r(),C("tr",so,[io,e("td",null,S(E.row.refuse_reason),1)])):P("",!0)])]),_:1}),t(A,{label:"编号",prop:"id"}),t(A,{label:"经济类型",prop:"eco_name"}),t(A,{label:"预算金额(元)",prop:"budget_price"}),t(A,{label:"衔接业务单编码",prop:"aebp_id"}),t(A,{label:"上年度本业务实际支出(元)",prop:"actual_cost"}),t(A,{label:"填报人",prop:"requester_name"}),t(A,{align:"center",label:"审核状态"},{default:l(E=>[E.row.status==0?(r(),v(w,{key:0,type:"primary"},{default:l(()=>[$("待申请审核")]),_:1})):E.row.status==1?(r(),v(w,{key:1,type:"warning"},{default:l(()=>[$("待审核")]),_:1})):E.row.status==2?(r(),v(w,{key:2,type:"success"},{default:l(()=>[$("审核通过")]),_:1})):E.row.status==3?(r(),v(w,{key:3,type:"danger"},{default:l(()=>[$("审核驳回")]),_:1})):P("",!0)]),_:1}),t(A,{align:"center",label:"操作"},{default:l(E=>[t(O,{size:"small",type:"primary",onClick:ie=>c(E.row)},{default:l(()=>[$("详情")]),_:2},1032,["onClick"]),E.row.status==0?(r(),v(O,{key:0,size:"small",type:"warning",onClick:ie=>m(E.row.id)},{default:l(()=>[$(" 提请审核 ")]),_:2},1032,["onClick"])):E.row.status==3?(r(),v(O,{key:1,size:"small",type:"danger"},{default:l(()=>[$("编辑")]),_:1})):P("",!0)]),_:1})]),_:1},8,["data"])]),footer:l(()=>[t(R,{"current-page":V.curr_page,"onUpdate:currentPage":j[1]||(j[1]=E=>V.curr_page=E),"page-size":V.page_size,total:V.total,layout:"total, prev, pager, next",onCurrentChange:g},null,8,["current-page","page-size","total"])]),_:1}),t(re,{modelValue:i.value,"onUpdate:modelValue":j[2]||(j[2]=E=>i.value=E),size:"90%",title:"新增预算报表"},{default:l(()=>[t(Xa)]),_:1},8,["modelValue"]),t(re,{modelValue:y.value,"onUpdate:modelValue":j[3]||(j[3]=E=>y.value=E),"destroy-on-close":"",direction:"rtl",size:"60%",title:"预算详情（只读）"},{default:l(()=>[t(dt,{aebp:x.value,awp:n.value,budget:o.value,job_resp:q.value,per_goal:u.value},null,8,["aebp","awp","budget","job_resp","per_goal"])]),_:1},8,["modelValue"])],64)}}}),mo={style:{width:"100%",height:"100%",display:"flex"}},bo=I({__name:"index",setup(s){const a=L(),b=T([{title:"预算审核情况",comp:Y(_o)},{title:"我的信息",comp:Y(_e)}]),V=D(b[0].comp),o=q=>{V.value=b[q].comp};return(q,x)=>{const n=fe("loading");return pe((r(),C("div",mo,[t(ue,{content:u=>u.title,curr_change:o,data:b,"min-width":"10rem",width:"14rem"},null,8,["content","data"]),(r(),v(ne(V.value)))])),[[n,N(a).getters.loading]])}}});export{bo as default};
